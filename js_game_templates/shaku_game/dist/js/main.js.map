{
  "version": 3,
  "sources": ["../../../../../Shaku/lib/manager.js", "../../../../../Shaku/lib/utils/math_helper.js", "../../../../../Shaku/lib/utils/color.js", "../../../../../Shaku/lib/gfx/blend_modes.js", "../../../../../Shaku/lib/utils/vector2.js", "../../../../../Shaku/lib/utils/circle.js", "../../../../../Shaku/lib/utils/line.js", "../../../../../Shaku/lib/utils/rectangle.js", "../../../../../Shaku/lib/assets/asset.js", "../../../../../Shaku/lib/gfx/texture_filter_modes.js", "../../../../../Shaku/lib/gfx/texture_wrap_modes.js", "../../../../../Shaku/lib/logger.js", "../../../../../Shaku/lib/assets/texture_asset.js", "../../../../../Shaku/lib/utils/vector3.js", "../../../../../Shaku/lib/utils/animator.js", "../../../../../Shaku/lib/utils/game_time.js", "../../../../../Shaku/lib/utils/seeded_random.js", "../../../../../Shaku/lib/utils/perlin.js", "../../../../../Shaku/lib/utils/storage_adapter.js", "../../../../../Shaku/lib/utils/storage.js", "../../../../../Shaku/lib/utils/path_finder.js", "../../../../../Shaku/lib/utils/transform_modes.js", "../../../../../Shaku/lib/utils/transformation.js", "../../../../../Shaku/lib/utils/index.js", "../../../../../Shaku/lib/gfx/vertex.js", "../../../../../Shaku/lib/gfx/matrix.js", "../../../../../Shaku/lib/gfx/effects/effect.js", "../../../../../Shaku/lib/gfx/effects/basic.js", "../../../../../Shaku/lib/gfx/effects/msdf_font.js", "../../../../../Shaku/lib/gfx/effects/index.js", "../../../../../Shaku/lib/gfx/mesh.js", "../../../../../Shaku/lib/gfx/mesh_generator.js", "../../../../../Shaku/lib/gfx/camera.js", "../../../../../Shaku/lib/gfx/sprite.js", "../../../../../Shaku/lib/gfx/sprites_group.js", "../../../../../Shaku/lib/assets/font_texture_asset.js", "../../../../../Shaku/lib/assets/json_asset.js", "../../../../../Shaku/lib/assets/msdf_font_texture_asset.js", "../../../../../Shaku/lib/gfx/text_alignments.js", "../../../../../Shaku/lib/gfx/sprite_batch.js", "../../../../../Shaku/lib/gfx/gfx.js", "../../../../../Shaku/lib/gfx/index.js", "../../../../../Shaku/lib/assets/sound_asset.js", "../../../../../Shaku/lib/sfx/sound_instance.js", "../../../../../Shaku/lib/sfx/sound_mixer.js", "../../../../../Shaku/lib/sfx/sfx.js", "../../../../../Shaku/lib/sfx/index.js", "../../../../../Shaku/lib/input/key_codes.js", "../../../../../Shaku/lib/input/input.js", "../../../../../Shaku/lib/input/index.js", "../../../../../Shaku/lib/assets/binary_asset.js", "../../../../../Shaku/lib/assets/assets.js", "../../../../../Shaku/lib/assets/index.js", "../../../../../Shaku/lib/collision/shapes/shape.js", "../../../../../Shaku/lib/collision/result.js", "../../../../../Shaku/lib/collision/resolver.js", "../../../../../Shaku/lib/collision/shapes/point.js", "../../../../../Shaku/lib/collision/shapes/circle.js", "../../../../../Shaku/lib/collision/collision_world.js", "../../../../../Shaku/lib/collision/shapes/rectangle.js", "../../../../../Shaku/lib/collision/resolvers_imp.js", "../../../../../Shaku/lib/collision/shapes/lines.js", "../../../../../Shaku/lib/collision/shapes/tilemap.js", "../../../../../Shaku/lib/collision/collision.js", "../../../../../Shaku/lib/collision/index.js", "../../../../../Shaku/lib/shaku.js", "../../src/main.ts", "../../node_modules/dat.gui/src/dat/color/toString.js", "../../node_modules/dat.gui/src/dat/utils/common.js", "../../node_modules/dat.gui/src/dat/color/interpret.js", "../../node_modules/dat.gui/src/dat/color/math.js", "../../node_modules/dat.gui/src/dat/color/Color.js", "../../node_modules/dat.gui/src/dat/controllers/Controller.js", "../../node_modules/dat.gui/src/dat/dom/dom.js", "../../node_modules/dat.gui/src/dat/controllers/BooleanController.js", "../../node_modules/dat.gui/src/dat/controllers/OptionController.js", "../../node_modules/dat.gui/src/dat/controllers/StringController.js", "../../node_modules/dat.gui/src/dat/controllers/NumberController.js", "../../node_modules/dat.gui/src/dat/controllers/NumberControllerBox.js", "../../node_modules/dat.gui/src/dat/controllers/NumberControllerSlider.js", "../../node_modules/dat.gui/src/dat/controllers/FunctionController.js", "../../node_modules/dat.gui/src/dat/controllers/ColorController.js", "../../node_modules/dat.gui/src/dat/utils/css.js", "../../node_modules/dat.gui/src/dat/gui/saveDialogue.html.js", "../../node_modules/dat.gui/src/dat/controllers/ControllerFactory.js", "../../node_modules/dat.gui/src/dat/utils/requestAnimationFrame.js", "../../node_modules/dat.gui/src/dat/dom/CenteredDiv.js", "../../node_modules/dat.gui/src/dat/gui/GUI.js", "../../node_modules/dat.gui/src/dat/index.js"],
  "sourcesContent": ["/**\r\n * Define the managers interface.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\manager.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\n\r\n/**\r\n * Interface for any manager.\r\n * Manager = manages a domain in Shaku, such as gfx (graphics), sfx (sounds), input, etc.\r\n */\r\nclass IManager\r\n{\r\n    /**\r\n     * Initialize the manager.\r\n     * @returns {Promise} Promise to resolve when initialization is done.\r\n     */\r\n    setup()\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n\r\n    /**\r\n     * Called every update at the begining of the frame.\r\n     */\r\n    startFrame()\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n\r\n    /**\r\n     * Called every update at the end of the frame.\r\n     */\r\n    endFrame()\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n\r\n    /**\r\n     * Destroy the manager.\r\n     */\r\n    destroy()\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n}\r\n\r\n// export the manager interface.\r\nmodule.exports = IManager", "/**\r\n * Implement a math utilities class.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\math_helper.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\n// for radians / degrees conversion\r\nconst _toRadsFactor = (Math.PI / 180);\r\nconst _toDegreesFactor = (180 / Math.PI);\r\n\r\n\r\n/**\r\n * Implement some math utilities functions.\r\n */\r\nclass MathHelper\r\n{\r\n    /**\r\n     * Perform linear interpolation between start and end values.\r\n     * @param {Number} start Starting value.\r\n     * @param {Number} end Ending value.\r\n     * @param {Number} amount How much to interpolate from start to end.\r\n     * @returns {Number} interpolated value between start and end.\r\n     */\r\n    static lerp(start, end, amount)\r\n    {\r\n        // to prevent shaking on same values\r\n        if (start === end) { return end; }\r\n\r\n        // do lerping\r\n        return ((1-amount) * start) + (amount * end);\r\n    }\r\n\r\n    /**\r\n     * Calculate 2d dot product.\r\n     * @param {Number} x1 First vector x.\r\n     * @param {Number} y1 First vector y.\r\n     * @param {Number} x2 Second vector x.\r\n     * @param {Number} y2 Second vector y.\r\n     * @returns {Number} dot product result.\r\n     */\r\n    static dot(x1, y1, x2, y2) \r\n    {\r\n        return x1 * x2 + y1 * y2;\r\n    }\r\n\r\n    /**\r\n     * Convert degrees to radians.\r\n     * @param {Number} degrees Degrees value to convert to radians.\r\n     * @returns {Number} Value as radians.\r\n     */\r\n    static toRadians(degrees) \r\n    {\r\n        return degrees * _toRadsFactor;\r\n    }\r\n\r\n    /**\r\n     * Convert radians to degrees.\r\n     * @param {Number} radians Radians value to convert to degrees.\r\n     * @returns {Number} Value as degrees.\r\n     */\r\n    static toDegrees(radians) \r\n    {\r\n        return radians * _toDegreesFactor;\r\n    }\r\n\r\n    /**\r\n    * Find shortest distance between two radians, with sign (ie distance can be negative).\r\n    * @param {Number} a1 First radian.\r\n    * @param {Number} a2 Second radian.\r\n    * @returns {Number} Shortest distance between radians.\r\n    */\r\n    static radiansDistanceSigned(a1, a2)\r\n    {\r\n        var max = Math.PI * 2;\r\n        var da = (a2 - a1) % max;\r\n        return 2 * da % max - da;\r\n    }\r\n\r\n    /**\r\n    * Find shortest distance between two radians.\r\n    * @param {Number} a1 First radian.\r\n    * @param {Number} a2 Second radian.\r\n    * @returns {Number} Shortest distance between radians.\r\n    */\r\n    static radiansDistance(a1, a2)\r\n    {\r\n        return Math.abs(this.radiansDistanceSigned(a1, a2));\r\n    }\r\n\r\n\r\n    /**\r\n    * Find shortest distance between two angles in degrees, with sign (ie distance can be negative).\r\n    * @param {Number} a1 First angle.\r\n    * @param {Number} a2 Second angle.\r\n    * @returns {Number} Shortest distance between angles.\r\n    */\r\n    static degreesDistanceSigned(a1, a2)\r\n    {\r\n        let a1r = a1 * _toRadsFactor;\r\n        let a2r = a2 * _toRadsFactor;\r\n        let ret = this.radiansDistanceSigned(a1r, a2r);\r\n        return ret * _toDegreesFactor;\r\n    }\r\n\r\n    /**\r\n    * Find shortest distance between two angles in degrees.\r\n    * @param {Number} a1 First angle.\r\n    * @param {Number} a2 Second angle.\r\n    * @returns {Number} Shortest distance between angles.\r\n    */\r\n    static degreesDistance(a1, a2)\r\n    {\r\n        let a1r = a1 * _toRadsFactor;\r\n        let a2r = a2 * _toRadsFactor;\r\n        let ret = this.radiansDistance(a1r, a2r);\r\n        return ret * _toDegreesFactor;\r\n    }\r\n\r\n    /**\r\n     * Perform linear interpolation between radian values.\r\n     * Unlike the regular lerp method, this method will take wrapping into consideration, and will always lerp via the shortest distance.\r\n     * @param {Number} a1 Starting value.\r\n     * @param {Number} a2 Ending value.\r\n     * @param {Number} alpha How much to interpolate from start to end.\r\n     * @returns {Number} interpolated radians between start and end.\r\n     */\r\n    static lerpRadians(a1, a2, alpha)\r\n    {\r\n        // to prevent shaking on same values\r\n        if (a1 === a2) { return a2; }\r\n\r\n        // do lerping\r\n        return a1 + this.radiansDistanceSigned(a1, a2) * alpha;\r\n    }\r\n\r\n    /**\r\n     * Perform linear interpolation between degrees.\r\n     * Unlike the regular lerp method, this method will take wrapping into consideration, and will always lerp via the shortest distance.\r\n     * @param {Number} a1 Starting value.\r\n     * @param {Number} a2 Ending value.\r\n     * @param {Number} alpha How much to interpolate from start to end.\r\n     * @returns {Number} interpolated degrees between start and end.\r\n     */\r\n    static lerpDegrees(a1, a2, alpha)\r\n    {\r\n        // to prevent shaking on same values\r\n        if (a1 === a2) { return a2; }\r\n\r\n        // convert to radians\r\n        a1 = this.toRadians(a1);\r\n        a2 = this.toRadians(a2);\r\n\r\n        // lerp\r\n        var ret = this.lerpRadians(a1, a2, alpha);\r\n\r\n        // convert back to degrees and return\r\n        return this.toDegrees(ret);\r\n    }\r\n\r\n    /**\r\n    * Round numbers from 10'th digit.\r\n    * This is useful for calculations that should return round or almost round numbers, but have a long tail of 0's and 1 due to floating points accuracy.\r\n    * @param {Number} num Number to round.\r\n    * @returns {Number} Rounded number.\r\n    */\r\n    static round10(num)\r\n    {\r\n        return Math.round(num * 100000000.0) / 100000000.0;\r\n    }\r\n\r\n    /**\r\n     * Wrap degrees value to be between 0 to 360.\r\n     * @param {Number} degrees Degrees to wrap.\r\n     * @returns {Number} degrees wrapped to be 0-360 values.\r\n     */\r\n    static wrapDegrees(degrees)\r\n    {\r\n        degrees = degrees % 360;\r\n        if (degrees < 0) { degrees += 360; }\r\n        return degrees;\r\n    }\r\n}\r\n\r\n/**\r\n * PI * 2 value.\r\n */\r\nMathHelper.PI2 = Math.PI * 2;\r\n\r\n\r\n// export the math helper\r\nmodule.exports = MathHelper;", "/**\r\n * Define a color object.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\color.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\nconst MathHelper = require(\"./math_helper\");\r\n\r\n\r\n/**\r\n * Implement a color.\r\n * All color components are expected to be in 0.0 - 1.0 range (and not 0-255).\r\n */\r\nclass Color\r\n{\r\n    /**\r\n     * Create the color.\r\n     * @param {Number} r Color red component (value range: 0-1).\r\n     * @param {Number} g Color green component (value range: 0-1).\r\n     * @param {Number} b Color blue component (value range: 0-1).\r\n     * @param {Number=} a Color alpha component (value range: 0-1).\r\n     */\r\n    constructor(r, g, b, a)\r\n    {\r\n        this.set(r, g, b, a);\r\n    }\r\n\r\n    /**\r\n     * Set the color components.\r\n     * @param {Number} r Color red component (value range: 0-1).\r\n     * @param {Number} g Color green component (value range: 0-1).\r\n     * @param {Number} b Color blue component (value range: 0-1).\r\n     * @param {Number} a Color alpha component (value range: 0-1).\r\n     * @returns {Color} this.\r\n     */\r\n    set(r, g, b, a)\r\n    {\r\n        this._r = r;\r\n        this._g = g;\r\n        this._b = b;\r\n        this._a = (a === undefined) ? 1 : a;\r\n        this._asHex = null;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Set the color components from byte values (0-255).\r\n     * @param {Number} r Color red component (value range: 0-255).\r\n     * @param {Number} g Color green component (value range: 0-255).\r\n     * @param {Number} b Color blue component (value range: 0-255).\r\n     * @param {Number} a Color alpha component (value range: 0-255).\r\n     * @returns {Color} this.\r\n     */\r\n    setByte(r, g, b, a)\r\n    {\r\n        this._r = r / 255.0;\r\n        this._g = g / 255.0;\r\n        this._b = b / 255.0;\r\n        this._a = (a === undefined) ? 1 : (a / 255.0);\r\n        this._asHex = null;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Copy all component values from another color.\r\n     * @param {Color} other Color to copy values from.\r\n     * @returns {Color} this.\r\n     */\r\n    copy(other)\r\n    {\r\n        this.set(other.r, other.g, other.b, other.a);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Get r component.\r\n     * @returns {Number} Red component.\r\n     */\r\n    get r()\r\n    {\r\n        return this._r;\r\n    }\r\n\r\n    /**\r\n     * Get g component.\r\n     * @returns {Number} Green component.\r\n     */\r\n    get g()\r\n    {\r\n        return this._g;\r\n    }\r\n\r\n    /**\r\n     * Get b component.\r\n     * @returns {Number} Blue component.\r\n     */\r\n    get b()\r\n    {\r\n        return this._b;\r\n    }\r\n    \r\n    /**\r\n     * Get a component.\r\n     * @returns {Number} Alpha component.\r\n     */\r\n    get a()\r\n    {\r\n        return this._a;\r\n    }\r\n\r\n    /**\r\n     * Set r component.\r\n     * @returns {Number} Red component after change.\r\n     */\r\n    set r(val)\r\n    {\r\n        this._r = val;\r\n        this._asHex = null;\r\n        return this._r;\r\n    }\r\n\r\n    /**\r\n     * Set g component.\r\n     * @returns {Number} Green component after change.\r\n     */\r\n    set g(val)\r\n    {\r\n        this._g = val;\r\n        this._asHex = null;\r\n        return this._g;\r\n    }\r\n\r\n    /**\r\n     * Set b component.\r\n     * @returns {Number} Blue component after change.\r\n     */\r\n    set b(val)\r\n    {\r\n        this._b = val;\r\n        this._asHex = null;\r\n        return this._b;\r\n    }\r\n    \r\n    /**\r\n     * Set a component.\r\n     * @returns {Number} Alpha component after change.\r\n     */\r\n    set a(val)\r\n    {\r\n        this._a = val;\r\n        this._asHex = null;\r\n        return this._a;\r\n    }\r\n\r\n    /**\r\n     * Convert a single component to hex value.\r\n     * @param {Number} c Value to convert to hex.\r\n     * @returns {String} Component as hex value.\r\n     */\r\n    static componentToHex(c) \r\n    {\r\n        var hex = Math.round(c).toString(16);\r\n        return hex.length == 1 ? \"0\" + hex : hex;\r\n    }\r\n     \r\n    /**\r\n     * Convert this color to hex string (starting with '#').\r\n     * @returns {String} Color as hex.\r\n     */\r\n    get asHex() \r\n    {\r\n        if (!this._asHex) {\r\n            this._asHex = \"#\" + Color.componentToHex(this.r * 255) + Color.componentToHex(this.g * 255) + Color.componentToHex(this.b * 255) + Color.componentToHex(this.a * 255);\r\n        }\r\n        return this._asHex;\r\n    }\r\n\r\n    /**\r\n     * Create color from hex value.\r\n     * @param {String} val Number value (hex), as #rrggbbaa.\r\n     * @returns {Color} New color value.\r\n     */\r\n    static fromHex(val)\r\n    {\r\n        if (typeof val !== 'string' && val[0] != '#') {\r\n            throw new PintarJS.Error(\"Invalid color format!\");\r\n        }\r\n        var parsed = hexToColor(val);\r\n        if (!parsed) { throw new Error(\"Invalid hex value to parse!\"); }\r\n        return new Color(parsed.r, parsed.g, parsed.b, 1);\r\n    }\r\n\r\n    /**\r\n     * Create color from decimal value.\r\n     * @param {Number} val Number value (int).\r\n     * @param {Number} includeAlpha If true, will include alpha value.\r\n     * @returns {Color} New color value.\r\n     */\r\n    static fromDecimal(val, includeAlpha)\r\n    {\r\n        let ret = new Color(1, 1, 1, 1);\r\n        if (includeAlpha) { ret.a = (val & 0xff) / 255.0; val = val >> 8; }\r\n        ret.b = (val & 0xff) / 255.0; val = val >> 8;\r\n        ret.g = (val & 0xff) / 255.0; val = val >> 8;\r\n        ret.r = (val & 0xff) / 255.0;\r\n    }\r\n\r\n    /**\r\n     * Create color from a dictionary.\r\n     * @param {*} data Dictionary with {r,g,b,a}.\r\n     * @returns {Color} Newly created color.\r\n     */\r\n    static fromDict(data)\r\n    {\r\n        return new Color(\r\n            (data.r !== undefined) ? data.r : 1, \r\n            (data.g !== undefined) ? data.g : 1, \r\n            (data.b !== undefined) ? data.b : 1, \r\n            (data.a !== undefined) ? data.a : 1\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Convert to dictionary.\r\n     * @param {Boolean} minimized If true, will not include keys that their values are 1. You can use fromDict on minimized dicts.\r\n     * @returns {*} Dictionary with {r,g,b,a}\r\n     */\r\n    toDict(minimized)\r\n    {\r\n        if (minimized) {\r\n            const ret = {};\r\n            if (this.r !== 1) { ret.r = this.r; }\r\n            if (this.g !== 1) { ret.g = this.g; }\r\n            if (this.b !== 1) { ret.b = this.b; }\r\n            if (this.a !== 1) { ret.a = this.a; }\r\n            return ret;\r\n        }\r\n        return {r: this.r, g: this.g, b: this.b, a: this.a};\r\n    }\r\n\r\n    /**\r\n     * Convert this color to decimal number.\r\n     * @returns {Number} Color as decimal RGBA.\r\n     */\r\n    get asDecimalRGBA()\r\n    {\r\n      return ((Math.round(this.r * 255) << (8 * 3)) | (Math.round(this.g * 255) << (8 * 2)) | (Math.round(this.b * 255) << (8 * 1)) | (Math.round(this.a * 255)))>>>0;\r\n    }\r\n\r\n    /**\r\n     * Convert this color to decimal number.\r\n     * @returns {Number} Color as decimal ARGB.\r\n     */\r\n    get asDecimalABGR()\r\n    {\r\n      return ((Math.round(this.a * 255) << (8 * 3)) | (Math.round(this.b * 255) << (8 * 2)) | (Math.round(this.g * 255) << (8 * 1)) | (Math.round(this.r * 255)))>>>0;\r\n    }\r\n\r\n    /**\r\n     * Convert this color to a float array.\r\n     */\r\n    get floatArray()\r\n    {\r\n        return [this.r, this.g, this.b, this.a];\r\n    }\r\n\r\n    /**\r\n     * Return a clone of this color.\r\n     * @returns {Number} Cloned color.\r\n     */\r\n    clone()\r\n    {\r\n        return new Color(this.r, this.g, this.b, this.a);\r\n    }\r\n\r\n    /**\r\n     * Convert to string.\r\n     */\r\n    string() \r\n    {\r\n        return this.r + ',' + this.g + ',' + this.b + ',' + this.a;\r\n    }\r\n\r\n    /**\r\n     * Get if this color is pure black (ignoring alpha).\r\n     */\r\n    get isBlack()\r\n    {\r\n        return this.r == 0 && this.g == 0 && this.b == 0;\r\n    }\r\n\r\n    /**\r\n     * Return a random color.\r\n     * @param {Boolean} includeAlpha If true, will also randomize alpha.\r\n     * @returns {Color} Randomized color.\r\n     */\r\n    static random(includeAlpha)\r\n    {\r\n        return new Color(Math.random(), Math.random(), Math.random(), includeAlpha ? Math.random() : 1);\r\n    }\r\n\r\n    /**\r\n     * Build and return new color from bytes array.\r\n     * @param {Array<Number>} bytes Bytes array to build color from.\r\n     * @returns {Color} Newly created color.\r\n     */\r\n    static fromBytesArray(bytes)\r\n    {\r\n        return new Color(bytes[0] / 255, bytes[1] / 255, bytes[2] / 255, bytes[3] !== undefined ? (bytes[3] / 255) : 1);\r\n    }\r\n\r\n    /**\r\n     * Get if this color is transparent black.\r\n     */\r\n    get isTransparentBlack()\r\n    {\r\n        return this._r == this._g && this._g == this._b && this._b == this._a && this._a == 0;\r\n    }\r\n\r\n    /**\r\n     * Get array with all built-in web color names.\r\n     * @returns {Array<String>} Array with color names.\r\n     */\r\n    static get webColorNames()\r\n    {\r\n        return colorKeys;\r\n    }\r\n\r\n    /**\r\n     * Check if equal to another color.\r\n     * @param {Color} other Other color to compare to.\r\n     */\r\n    equals(other)\r\n    {\r\n        return (this === other) ||\r\n                (other && (other.constructor === this.constructor) && this._r == other._r && this._g == other._g && this._b == other._b && this._a == other._a);\r\n    }\r\n\r\n    /**\r\n     * Lerp between two colors.\r\n     * @param {Color} p1 First color.\r\n     * @param {Color} p2 Second color.\r\n     * @param {Number} a Lerp factor (0.0 - 1.0).\r\n     * @returns {Color} result color.\r\n     */\r\n    static lerp(p1, p2, a)\r\n    {\r\n        let lerpScalar = MathHelper.lerp;\r\n        return new Color(  lerpScalar(p1.r, p2.r, a), \r\n                        lerpScalar(p1.g, p2.g, a), \r\n                        lerpScalar(p1.b, p2.b, a), \r\n                        lerpScalar(p1.a, p2.a, a)\r\n                    );\r\n    }\r\n}\r\n\r\n// table to convert common color names to hex\r\nconst colorNameToHex = {\"aliceblue\":\"#f0f8ff\",\"antiquewhite\":\"#faebd7\",\"aqua\":\"#00ffff\",\"aquamarine\":\"#7fffd4\",\"azure\":\"#f0ffff\",\r\n    \"beige\":\"#f5f5dc\",\"bisque\":\"#ffe4c4\",\"black\":\"#000000\",\"blanchedalmond\":\"#ffebcd\",\"blue\":\"#0000ff\",\"blueviolet\":\"#8a2be2\",\"brown\":\"#a52a2a\",\"burlywood\":\"#deb887\",\r\n    \"cadetblue\":\"#5f9ea0\",\"chartreuse\":\"#7fff00\",\"chocolate\":\"#d2691e\",\"coral\":\"#ff7f50\",\"cornflowerblue\":\"#6495ed\",\"cornsilk\":\"#fff8dc\",\"crimson\":\"#dc143c\",\"cyan\":\"#00ffff\",\r\n    \"darkblue\":\"#00008b\",\"darkcyan\":\"#008b8b\",\"darkgoldenrod\":\"#b8860b\",\"darkgray\":\"#a9a9a9\",\"darkgreen\":\"#006400\",\"darkkhaki\":\"#bdb76b\",\"darkmagenta\":\"#8b008b\",\"darkolivegreen\":\"#556b2f\",\r\n    \"darkorange\":\"#ff8c00\",\"darkorchid\":\"#9932cc\",\"darkred\":\"#8b0000\",\"darksalmon\":\"#e9967a\",\"darkseagreen\":\"#8fbc8f\",\"darkslateblue\":\"#483d8b\",\"darkslategray\":\"#2f4f4f\",\"darkturquoise\":\"#00ced1\",\r\n    \"darkviolet\":\"#9400d3\",\"deeppink\":\"#ff1493\",\"deepskyblue\":\"#00bfff\",\"dimgray\":\"#696969\",\"dodgerblue\":\"#1e90ff\",\r\n    \"firebrick\":\"#b22222\",\"floralwhite\":\"#fffaf0\",\"forestgreen\":\"#228b22\",\"fuchsia\":\"#ff00ff\",\r\n    \"gainsboro\":\"#dcdcdc\",\"ghostwhite\":\"#f8f8ff\",\"gold\":\"#ffd700\",\"goldenrod\":\"#daa520\",\"gray\":\"#808080\",\"green\":\"#008000\",\"greenyellow\":\"#adff2f\",\r\n    \"honeydew\":\"#f0fff0\",\"hotpink\":\"#ff69b4\",\r\n    \"indianred \":\"#cd5c5c\",\"indigo\":\"#4b0082\",\"ivory\":\"#fffff0\",\"khaki\":\"#f0e68c\",\r\n    \"lavender\":\"#e6e6fa\",\"lavenderblush\":\"#fff0f5\",\"lawngreen\":\"#7cfc00\",\"lemonchiffon\":\"#fffacd\",\"lightblue\":\"#add8e6\",\"lightcoral\":\"#f08080\",\"lightcyan\":\"#e0ffff\",\"lightgoldenrodyellow\":\"#fafad2\",\r\n    \"lightgrey\":\"#d3d3d3\",\"lightgreen\":\"#90ee90\",\"lightpink\":\"#ffb6c1\",\"lightsalmon\":\"#ffa07a\",\"lightseagreen\":\"#20b2aa\",\"lightskyblue\":\"#87cefa\",\"lightslategray\":\"#778899\",\"lightsteelblue\":\"#b0c4de\",\r\n    \"lightyellow\":\"#ffffe0\",\"lime\":\"#00ff00\",\"limegreen\":\"#32cd32\",\"linen\":\"#faf0e6\",\r\n    \"magenta\":\"#ff00ff\",\"maroon\":\"#800000\",\"mediumaquamarine\":\"#66cdaa\",\"mediumblue\":\"#0000cd\",\"mediumorchid\":\"#ba55d3\",\"mediumpurple\":\"#9370d8\",\"mediumseagreen\":\"#3cb371\",\"mediumslateblue\":\"#7b68ee\",\r\n    \"mediumspringgreen\":\"#00fa9a\",\"mediumturquoise\":\"#48d1cc\",\"mediumvioletred\":\"#c71585\",\"midnightblue\":\"#191970\",\"mintcream\":\"#f5fffa\",\"mistyrose\":\"#ffe4e1\",\"moccasin\":\"#ffe4b5\",\r\n    \"navajowhite\":\"#ffdead\",\"navy\":\"#000080\",\r\n    \"oldlace\":\"#fdf5e6\",\"olive\":\"#808000\",\"olivedrab\":\"#6b8e23\",\"orange\":\"#ffa500\",\"orangered\":\"#ff4500\",\"orchid\":\"#da70d6\",\r\n    \"palegoldenrod\":\"#eee8aa\",\"palegreen\":\"#98fb98\",\"paleturquoise\":\"#afeeee\",\"palevioletred\":\"#d87093\",\"papayawhip\":\"#ffefd5\",\"peachpuff\":\"#ffdab9\",\"peru\":\"#cd853f\",\"pink\":\"#ffc0cb\",\"plum\":\"#dda0dd\",\"powderblue\":\"#b0e0e6\",\"purple\":\"#800080\",\r\n    \"rebeccapurple\":\"#663399\",\"red\":\"#ff0000\",\"rosybrown\":\"#bc8f8f\",\"royalblue\":\"#4169e1\",\r\n    \"saddlebrown\":\"#8b4513\",\"salmon\":\"#fa8072\",\"sandybrown\":\"#f4a460\",\"seagreen\":\"#2e8b57\",\"seashell\":\"#fff5ee\",\"sienna\":\"#a0522d\",\"silver\":\"#c0c0c0\",\"skyblue\":\"#87ceeb\",\"slateblue\":\"#6a5acd\",\"slategray\":\"#708090\",\"snow\":\"#fffafa\",\"springgreen\":\"#00ff7f\",\"steelblue\":\"#4682b4\",\r\n    \"tan\":\"#d2b48c\",\"teal\":\"#008080\",\"thistle\":\"#d8bfd8\",\"tomato\":\"#ff6347\",\"turquoise\":\"#40e0d0\",\r\n    \"violet\":\"#ee82ee\",\r\n    \"wheat\":\"#f5deb3\",\"white\":\"#ffffff\",\"whitesmoke\":\"#f5f5f5\",\r\n    \"yellow\":\"#ffff00\",\"yellowgreen\":\"#9acd32\"};\r\n\r\n// create getter function for all named color\r\nfor (var key in colorNameToHex) {\r\n    if (colorNameToHex.hasOwnProperty(key)) {\r\n        var colorValue = hexToColor(colorNameToHex[key]);\r\n        (function(_colValue) {\r\n\r\n            Object.defineProperty (Color, key, {\r\n                get: function () { \r\n                    return _colValue.clone();\r\n                }\r\n            });\r\n\r\n        })(colorValue);\r\n    }\r\n}\r\n\r\n// built-in color keys\r\nconst colorKeys = Object.keys(colorNameToHex);\r\nObject.freeze(colorKeys);\r\n\r\n// add transparent getter\r\nObject.defineProperty (Color, 'transparent', {\r\n    get: function () { \r\n        return new Color(0, 0, 0, 0);\r\n    }\r\n});\r\n\r\n// add transparent white getter\r\nObject.defineProperty (Color, 'transwhite', {\r\n    get: function () { \r\n        return new Color(1, 1, 1, 0);\r\n    }\r\n});\r\n\r\n\r\n/**\r\n * Convert Hex value to Color instance.\r\n * @param {String} hex Hex value to parse.\r\n */\r\nfunction hexToColor(hex) \r\n{\r\n    // expand shorthand form (e.g. \"03F\") to full form (e.g. \"0033FF\")\r\n    var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\r\n    hex = hex.replace(shorthandRegex, function(m, r, g, b) {\r\n        return r + r + g + g + b + b;\r\n    });\r\n    \r\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n    var components = result ? {\r\n        r: parseInt(result[1], 16) / 255.0,\r\n        g: parseInt(result[2], 16) / 255.0,\r\n        b: parseInt(result[3], 16) / 255.0\r\n    } : null;\r\n\r\n    // create Color instance\r\n    if (!components) { throw new Error(\"Invalid hex value to parse!\"); }\r\n    return new Color(components.r, components.g, components.b, 1);\r\n}\r\n\r\n\r\n// export Color object\r\nmodule.exports = Color;", "/**\r\n * Define supported blend modes.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\blend_modes.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\n/** @typedef {String} BlendMode */\r\n\r\n/**\r\n * Blend modes we can draw with, determine how we blend new draws with existing buffer.\r\n * @readonly\r\n * @enum {BlendMode}\r\n */\r\nconst BlendModes = {\r\n    AlphaBlend: \"alpha\",\r\n    Opaque: \"opaque\",\r\n    Additive: \"additive\",\r\n    Multiply: \"multiply\",\r\n    Subtract: \"subtract\",\r\n    Screen: \"screen\",\r\n    Overlay: \"overlay\",\r\n    Invert: \"invert\",\r\n    Darken: \"darken\",\r\n    DestIn: \"dest-in\",\r\n    DestOut: \"dest-out\"\r\n};\r\n\r\nObject.defineProperty(BlendModes, '_values', {\r\n    value: new Set(Object.values(BlendModes)),\r\n    writable: false,\r\n});\r\nObject.freeze(BlendModes);\r\n\r\nmodule.exports = {BlendModes: BlendModes};", "/**\r\n * Implement a simple 2d vector.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\vector2.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\nconst MathHelper = require(\"./math_helper\");\r\n\r\n/**\r\n * A simple Vector object for 2d positions.\r\n */\r\nclass Vector2\r\n{\r\n    /**\r\n     * Create the Vector object.\r\n     * @param {number} x Vector X.\r\n     * @param {number} y Vector Y.\r\n     */\r\n    constructor(x = 0, y = 0)\r\n    {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n    \r\n    /**\r\n     * Clone the vector.\r\n     * @returns {Vector2} cloned vector.\r\n     */\r\n    clone()\r\n    {\r\n        return new Vector2(this.x, this.y);\r\n    }\r\n    \r\n    /**\r\n     * Set vector value.\r\n     * @param {Number} x X component.\r\n     * @param {Number} y Y component.\r\n     * @returns {Vector2} this.\r\n     */\r\n    set(x, y)\r\n    {\r\n        this.x = x;\r\n        this.y = y;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Copy values from other vector into self.\r\n     * @returns {Vector2} this.\r\n     */\r\n    copy(other) \r\n    {\r\n        this.x = other.x;\r\n        this.y = other.y;\r\n        return this;\r\n    }\r\n    \r\n    /**\r\n     * Return a new vector of this + other.\r\n     * @param {Number|Vector2} Other Vector or number to add.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    add(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            return new Vector2(this.x + other, this.y + (arguments[1] === undefined ? other : arguments[1]));\r\n        }\r\n        return new Vector2(this.x + other.x, this.y + other.y);\r\n    }\r\n    \r\n    /**\r\n     * Return a new vector of this - other.\r\n     * @param {Number|Vector2} Other Vector or number to sub.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    sub(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            return new Vector2(this.x - other, this.y - (arguments[1] === undefined ? other : arguments[1]));\r\n        }\r\n        return new Vector2(this.x - other.x, this.y - other.y);\r\n    }\r\n    \r\n    /**\r\n     * Return a new vector of this / other.\r\n     * @param {Number|Vector2} Other Vector or number to divide.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    div(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            return new Vector2(this.x / other, this.y / (arguments[1] === undefined ? other : arguments[1]));\r\n        }\r\n        return new Vector2(this.x / other.x, this.y / other.y);\r\n    }\r\n    \r\n    /**\r\n     * Return a new vector of this * other.\r\n     * @param {Number|Vector2} Other Vector or number to multiply.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    mul(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            return new Vector2(this.x * other, this.y * (arguments[1] === undefined ? other : arguments[1]));\r\n        }\r\n        return new Vector2(this.x * other.x, this.y * other.y);\r\n    }\r\n    \r\n    /**\r\n     * Return a round copy of this vector.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    round() \r\n    {\r\n        return new Vector2(Math.round(this.x), Math.round(this.y));\r\n    }\r\n    \r\n    /**\r\n     * Return a floored copy of this vector.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    floor() \r\n    {\r\n        return new Vector2(Math.floor(this.x), Math.floor(this.y));\r\n    }\r\n        \r\n    /**\r\n     * Return a ceiled copy of this vector.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    ceil() \r\n    {\r\n        return new Vector2(Math.ceil(this.x), Math.ceil(this.y));\r\n    }\r\n    \r\n    /**\r\n     * Return a normalized copy of this vector.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    normalized()\r\n    {\r\n        if (this.x == 0 && this.y == 0) { return Vector2.zero; }\r\n        let mag = this.length;\r\n        return new Vector2(this.x / mag, this.y / mag);\r\n    }\r\n\r\n    /**\r\n     * Get a copy of this vector rotated by radians.\r\n     * @param {Number} radians Radians to rotate by. \r\n     * @returns {Vector2} New vector with the length of this vector and direction rotated by given radians.\r\n     */\r\n    rotatedRadians(radians)\r\n    {\r\n        return Vector2.fromRadians(this.getRadians() + radians).mulSelf(this.length);\r\n    }\r\n\r\n    /**\r\n     * Get a copy of this vector rotated by degrees.\r\n     * @param {Number} degrees Degrees to rotate by. \r\n     * @returns {Vector2} New vector with the length of this vector and direction rotated by given degrees.\r\n     */\r\n    rotatedDegrees(degrees)\r\n    {\r\n        return Vector2.fromDegree(this.getDegrees() + degrees).mulSelf(this.length);\r\n    }\r\n    \r\n    /**\r\n     * Add other vector values to self.\r\n     * @param {Number|Vector2} Other Vector or number to add.\r\n     * @returns {Vector2} this.\r\n     */\r\n    addSelf(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            this.x += other;\r\n            this.y += (arguments[1] === undefined ? other : arguments[1]);\r\n        }\r\n        else {\r\n            this.x += other.x;\r\n            this.y += other.y;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Sub other vector values from self.\r\n     * @param {Number|Vector2} Other Vector or number to substract.\r\n     * @returns {Vector2} this.\r\n     */\r\n    subSelf(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            this.x -= other;\r\n            this.y -= (arguments[1] === undefined ? other : arguments[1]);\r\n        }\r\n        else {\r\n            this.x -= other.x;\r\n            this.y -= other.y;\r\n        }\r\n        return this;\r\n    }\r\n    \r\n    /**\r\n     * Divide this vector by other vector values.\r\n     * @param {Number|Vector2} Other Vector or number to divide by.\r\n     * @returns {Vector2} this.\r\n     */\r\n    divSelf(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            this.x /= other;\r\n            this.y /= (arguments[1] === undefined ? other : arguments[1]);\r\n        }\r\n        else {\r\n            this.x /= other.x;\r\n            this.y /= other.y;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Multiply this vector by other vector values.\r\n     * @param {Number|Vector2} Other Vector or number to multiply by.\r\n     * @returns {Vector2} this.\r\n     */\r\n    mulSelf(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            this.x *= other;\r\n            this.y *= (arguments[1] === undefined ? other : arguments[1]);\r\n        }\r\n        else {\r\n            this.x *= other.x;\r\n            this.y *= other.y;\r\n        }\r\n        return this;\r\n    }\r\n    \r\n    /**\r\n     * Round self.\r\n     * @returns {Vector2} this.\r\n     */\r\n    roundSelf() \r\n    {\r\n        this.x = Math.round(this.x);\r\n        this.y = Math.round(this.y);\r\n        return this;\r\n    }\r\n    \r\n    /**\r\n     * Floor self.\r\n     * @returns {Vector2} this.\r\n     */\r\n    floorSelf() \r\n    {\r\n        this.x = Math.floor(this.x);\r\n        this.y = Math.floor(this.y);\r\n        return this;\r\n    }\r\n     \r\n    /**\r\n     * Ceil self.\r\n     * @returns {Vector2} this.\r\n     */\r\n    ceilSelf() \r\n    {\r\n        this.x = Math.ceil(this.x);\r\n        this.y = Math.ceil(this.y);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Return a normalized copy of this vector.\r\n     * @returns {Vector2} this.\r\n     */\r\n    normalizeSelf()\r\n    {\r\n        if (this.x == 0 && this.y == 0) { return this; }\r\n        let mag = this.length;\r\n        this.x /= mag;\r\n        this.y /= mag;\r\n        return this;\r\n    }\r\n    \r\n    /**\r\n     * Return if vector equals another vector.\r\n     * @param {Vector2} other Other vector to compare to.\r\n     * @returns {Boolean} if vectors are equal.\r\n     */\r\n    equals(other)\r\n    {\r\n        return ((this === other) || ((other.constructor === this.constructor) && this.x === other.x && this.y === other.y));\r\n    }\r\n    \r\n    /**\r\n     * Return if vector approximately equals another vector.\r\n     * @param {Vector2} other Other vector to compare to.\r\n     * @param {Number} threshold Distance threshold to consider as equal. Defaults to 1.\r\n     * @returns {Boolean} if vectors are equal.\r\n     */\r\n    approximate(other, threshold)\r\n    {\r\n        threshold = threshold || 1;\r\n        return ((this === other) || \r\n                (\r\n                 (Math.abs(this.x - other.x) <= threshold) && \r\n                 (Math.abs(this.y - other.y) <= threshold))\r\n                );\r\n    }\r\n\r\n    /**\r\n     * Return vector length (aka magnitude).\r\n     * @returns {Number} Vector length.\r\n     */\r\n    get length()\r\n    {\r\n        return Math.sqrt((this.x * this.x) + (this.y * this.y));\r\n    }\r\n\r\n    /**\r\n     * Return a copy of this vector multiplied by a factor.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    scaled(fac) \r\n    {\r\n        return new Vector2(this.x * fac, this.y * fac);\r\n    }\r\n\r\n    /**\r\n     * Get vector (0,0).\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    static get zero()\r\n    {\r\n        return new Vector2();\r\n    }\r\n\r\n    /**\r\n     * Get vector with 1,1 values.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    static get one()\r\n    {\r\n        return new Vector2(1, 1);\r\n    }\r\n\r\n    /**\r\n     * Get vector with 0.5,0.5 values.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    static get half()\r\n    {\r\n        return new Vector2(0.5, 0.5);\r\n    }\r\n\r\n    /**\r\n     * Get vector with -1,0 values.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    static get left()\r\n    {\r\n        return new Vector2(-1, 0);\r\n    }\r\n\r\n    /**\r\n     * Get vector with 1,0 values.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    static get right()\r\n    {\r\n        return new Vector2(1, 0);\r\n    }\r\n\r\n    /**\r\n     * Get vector with 0,-1 values.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    static get up()\r\n    {\r\n        return new Vector2(0, -1);\r\n    }\r\n\r\n    /**\r\n     * Get vector with 0,1 values.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    static get down()\r\n    {\r\n        return new Vector2(0, 1);\r\n    }\r\n\r\n    /**\r\n     * Get a random vector with length of 1.\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    static get random()\r\n    {\r\n        return Vector2.fromDegree(Math.random() * 360);\r\n    }\r\n\r\n    /**\r\n     * Get degrees between this vector and another vector.\r\n     * @param {Vector2} other Other vector.\r\n     * @returns {Number} Angle between vectors in degrees.\r\n     */\r\n    degreesTo(other) \r\n    {\r\n        return Vector2.degreesBetween(this, other);\r\n    };\r\n\r\n    /**\r\n     * Get radians between this vector and another vector.\r\n     * @param {Vector2} other Other vector.\r\n     * @returns {Number} Angle between vectors in radians.\r\n     */\r\n    radiansTo(other) \r\n    {\r\n        return Vector2.radiansBetween(this, other);\r\n    };\r\n    \r\n    /**\r\n     * Get degrees between this vector and another vector.\r\n     * Return values between 0 to 360.\r\n     * @param {Vector2} other Other vector.\r\n     * @returns {Number} Angle between vectors in degrees.\r\n     */\r\n    degreesToFull(other) \r\n    {\r\n        return Vector2.degreesBetweenFull(this, other);\r\n    };\r\n\r\n    /**\r\n     * Get radians between this vector and another vector.\r\n     * Return values between 0 to PI2.\r\n     * @param {Vector2} other Other vector.\r\n     * @returns {Number} Angle between vectors in radians.\r\n     */\r\n    radiansToFull(other) \r\n    {\r\n        return Vector2.radiansBetweenFull(this, other);\r\n    };\r\n    \r\n    /**\r\n     * Calculate distance between this vector and another vectors.\r\n     * @param {Vector2} other Other vector.\r\n     * @returns {Number} Distance between vectors.\r\n     */\r\n    distanceTo(other)\r\n    {\r\n        return Vector2.distance(this, other);\r\n    }\r\n    \r\n    /**\r\n     * Get vector from degrees.\r\n     * @param {Number} degrees Angle to create vector from (0 = vector pointing right).\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    static fromDegree(degrees)\r\n    {\r\n        let rads = degrees * (Math.PI / 180);\r\n        return new Vector2(Math.cos(rads), Math.sin(rads));\r\n    }\r\n\r\n    /**\r\n     * Get vector from radians.\r\n     * @param {Number} radians Angle to create vector from (0 = vector pointing right).\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    static fromRadians(radians)\r\n    {\r\n        return new Vector2(Math.cos(radians), Math.sin(radians));\r\n    }\r\n    \r\n    /**\r\n     * Lerp between two vectors.\r\n     * @param {Vector2} p1 First vector.\r\n     * @param {Vector2} p2 Second vector.\r\n     * @param {Number} a Lerp factor (0.0 - 1.0).\r\n     * @returns {Vector2} result vector.\r\n     */\r\n    static lerp(p1, p2, a)\r\n    {\r\n        let lerpScalar = MathHelper.lerp;\r\n        return new Vector2(lerpScalar(p1.x, p2.x, a), lerpScalar(p1.y, p2.y, a));\r\n    }\r\n\r\n    /**\r\n     * Get degrees between two vectors.\r\n     * Return values between -180 to 180.\r\n     * @param {Vector2} p1 First vector.\r\n     * @param {Vector2} p2 Second vector.\r\n     * @returns {Number} Angle between vectors in degrees.\r\n     */\r\n    static degreesBetween(P1, P2) \r\n    {\r\n        let deltaY = P2.y - P1.y,\r\n        deltaX = P2.x - P1.x;\r\n        return Math.atan2(deltaY, deltaX) * (180 / Math.PI);\r\n    };\r\n\r\n    /**\r\n     * Get radians between two vectors.\r\n     * Return values between -PI to PI.\r\n     * @param {Vector2} p1 First vector.\r\n     * @param {Vector2} p2 Second vector.\r\n     * @returns {Number} Angle between vectors in radians.\r\n     */\r\n    static radiansBetween(P1, P2) \r\n    {\r\n        return MathHelper.toRadians(Vector2.degreesBetween(P1, P2));\r\n    };\r\n    \r\n    /**\r\n     * Get degrees between two vectors.\r\n     * Return values between 0 to 360.\r\n     * @param {Vector2} p1 First vector.\r\n     * @param {Vector2} p2 Second vector.\r\n     * @returns {Number} Angle between vectors in degrees.\r\n     */\r\n    static degreesBetweenFull(P1, P2) \r\n    {\r\n        let temp = P2.sub(P1);\r\n        return temp.getDegrees();\r\n    };\r\n\r\n    /**\r\n     * Get vector's angle in degrees.\r\n     * @returns {Number} Vector angle in degrees.\r\n     */\r\n    getDegrees()\r\n    {\r\n        var angle = Math.atan2(this.y, this.x);\r\n        var degrees = 180 * angle / Math.PI;\r\n        return (360+Math.round(degrees)) % 360;\r\n    }\r\n\r\n    /**\r\n     * Get vector's angle in radians.\r\n     * @returns {Number} Vector angle in degrees.\r\n     */\r\n    getRadians()\r\n    {\r\n        var angle = Math.atan2(this.y, this.x);\r\n        return angle;\r\n    }\r\n    \r\n    /**\r\n     * Get radians between two vectors.\r\n     * Return values between 0 to PI2.\r\n     * @param {Vector2} p1 First vector.\r\n     * @param {Vector2} p2 Second vector.\r\n     * @returns {Number} Angle between vectors in radians.\r\n     */\r\n    static radiansBetweenFull(P1, P2) \r\n    {\r\n        return MathHelper.toRadians(Vector2.degreesBetweenFull(P1, P2));\r\n    };\r\n\r\n    /**\r\n     * Calculate distance between two vectors.\r\n     * @param {Vector2} p1 First vector.\r\n     * @param {Vector2} p2 Second vector.\r\n     * @returns {Number} Distance between vectors.\r\n     */\r\n    static distance(p1, p2)\r\n    {\r\n        let a = p1.x - p2.x;\r\n        let b = p1.y - p2.y;\r\n        return Math.sqrt(a*a + b*b);\r\n    }\r\n\r\n    /**\r\n     * Return cross product between two vectors.\r\n     * @param {Vector2} p1 First vector.\r\n     * @param {Vector2} p2 Second vector.\r\n     * @returns {Number} Cross between vectors.\r\n     */\r\n    static cross(p1, p2)\r\n    {\r\n        return p1.x * p2.y - p1.y * p2.x;\r\n    }\r\n     \r\n    /**\r\n     * Return dot product between two vectors.\r\n     * @param {Vector2} p1 First vector.\r\n     * @param {Vector2} p2 Second vector.\r\n     * @returns {Number} Dot between vectors.\r\n     */\r\n    static dot(p1, p2)\r\n    {\r\n        return p1.x * p2.x + p1.y * p2.y;\r\n    }\r\n\r\n    /**\r\n     * Convert to string.\r\n     */\r\n    string()\r\n    {\r\n        return this.x + ',' + this.y;\r\n    }\r\n\r\n    /**\r\n     * Parse and return a vector object from string in the form of \"x,y\".\r\n     * @param {String} str String to parse.\r\n     * @returns {Vector2} Parsed vector.\r\n     */\r\n    static parse(str)\r\n    {\r\n        let parts = str.split(',');\r\n        return new Vector2(parseFloat(parts[0].trim()), parseFloat(parts[1].trim()));\r\n    }\r\n\r\n    /**\r\n     * Convert to array of numbers.\r\n     * @returns {Array<Number>} Vector components as array.\r\n     */\r\n    toArray()\r\n    {\r\n        return [this.x, this.y];\r\n    }\r\n\r\n    /**\r\n     * Create vector from array of numbers.\r\n     * @param {Array<Number>} arr Array of numbers to create vector from.\r\n     * @returns {Vector2} Vector instance.\r\n     */\r\n    static fromArray(arr)\r\n    {\r\n        return new Vector2(arr[0], arr[1]);\r\n    }\r\n\r\n    /**\r\n     * Create vector from a dictionary.\r\n     * @param {*} data Dictionary with {x,y}.\r\n     * @returns {Vector2} Newly created vector.\r\n     */\r\n    static fromDict(data)\r\n    {\r\n        return new Vector2(data.x || 0, data.y || 0);\r\n    }\r\n\r\n    /**\r\n     * Convert to dictionary.\r\n     * @param {Boolean} minimized If true, will not include keys that their values are 0. You can use fromDict on minimized dicts.\r\n     * @returns {*} Dictionary with {x,y}\r\n     */\r\n    toDict(minimized)\r\n    {\r\n        if (minimized) {\r\n            const ret = {};\r\n            if (this.x) { ret.x = this.x; }\r\n            if (this.y) { ret.y = this.y; }\r\n            return ret;\r\n        }\r\n        return {x: this.x, y: this.y};\r\n    }\r\n}\r\n\r\n// export vector object\r\nmodule.exports = Vector2;", "/**\r\n * Implement a simple 2d circle.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\circle.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\nconst MathHelper = require('./math_helper');\r\nconst Vector2 = require('./vector2');\r\n\r\n\r\n/**\r\n * Implement a simple 2d Circle.\r\n */\r\nclass Circle\r\n{\r\n    /**\r\n     * Create the Circle.\r\n     * @param {Vector2} center Circle center position.\r\n     * @param {Number} radius Circle radius.\r\n     */\r\n    constructor(center, radius)\r\n    {\r\n        this.center = center.clone();\r\n        this.radius = radius;\r\n    }\r\n\r\n    /**\r\n     * Return a clone of this circle.\r\n     * @returns {Circle} Cloned circle.\r\n     */\r\n    clone()\r\n    {\r\n        return new Circle(this.center, this.radius);\r\n    }\r\n\r\n    /**\r\n     * Check if this circle contains a Vector2.\r\n     * @param {Vector2} p Point to check.\r\n     * @returns {Boolean} if point is contained within the circle.\r\n     */\r\n    containsVector(p) \r\n    {\r\n        return this.center.distanceTo(p) <= this.radius;\r\n    }\r\n\r\n    /**\r\n     * Check if equal to another circle.\r\n     * @param {Circle} other Other circle to compare to.\r\n     * @returns {Boolean} True if circles are equal, false otherwise.\r\n     */\r\n    equals(other)\r\n    {\r\n        return (other === this) || \r\n                (other && (other.constructor === this.constructor) && this.center.equals(other.center) && this.radius == other.radius);\r\n    }\r\n\r\n    /**\r\n     * Create circle from a dictionary.\r\n     * @param {*} data Dictionary with {center, radius}.\r\n     * @returns {Circle} Newly created circle.\r\n     */\r\n    static fromDict(data)\r\n    {\r\n        return new Circle(Vector2.fromDict(data.center || {}), data.radius || 0);\r\n    }\r\n\r\n    /**\r\n     * Convert to dictionary.\r\n     * @param {Boolean} minimized If true, will not include keys that their values are 0. You can use fromDict on minimized dicts.\r\n     * @returns {*} Dictionary with {center, radius}.\r\n     */\r\n    toDict(minimized)\r\n    {\r\n        if (minimized) {\r\n            const ret = {};\r\n            if (this.radius) { ret.radius = this.radius; }\r\n            if (this.center.x || this.center.y) { ret.center = this.center.toDict(true); }\r\n            return ret;\r\n        }\r\n        return {center: this.center.toDict(), radius: this.radius};\r\n    }\r\n     \r\n    /**\r\n     * Lerp between two circle.\r\n     * @param {Circle} p1 First circle.\r\n     * @param {Circle} p2 Second circle.\r\n     * @param {Number} a Lerp factor (0.0 - 1.0).\r\n     * @returns {Circle} result circle.\r\n     */\r\n    static lerp(p1, p2, a)\r\n    {\r\n        let lerpScalar = MathHelper.lerp;\r\n        return new Circle(Vector2.lerp(p1.center, p2.center, a), lerpScalar(p1.radius, p2.radius, a));\r\n    }\r\n}\r\n\r\n\r\n// export the circle class\r\nmodule.exports = Circle;", "/**\r\n * Implement a simple 2d line.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\line.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\nconst Vector2 = require('./vector2');\r\n\r\n\r\n/**\r\n * Implement a simple 2d Line.\r\n */\r\nclass Line\r\n{\r\n    /**\r\n     * Create the Line.\r\n     * @param {Vector2} from Line start position.\r\n     * @param {Vector2} to Line end position.\r\n     */\r\n    constructor(from, to)\r\n    {\r\n        this.from = from.clone();\r\n        this.to = to.clone();\r\n    }\r\n\r\n    /**\r\n     * Return a clone of this line.\r\n     * @returns {Line} Cloned line.\r\n     */\r\n    clone()\r\n    {\r\n        return new Line(this.from, this.to);\r\n    }\r\n\r\n    /**\r\n     * Create Line from a dictionary.\r\n     * @param {*} data Dictionary with {from, to}.\r\n     * @returns {Line} Newly created line.\r\n     */\r\n    static fromDict(data)\r\n    {\r\n        return new Line(Vector2.fromDict(data.from || {}), Vector2.fromDict(data.to || {}));\r\n    }\r\n\r\n    /**\r\n     * Convert to dictionary.\r\n     * @param {Boolean} minimized If true, will not include keys that their values are 0. You can use fromDict on minimized dicts.\r\n     * @returns {*} Dictionary with {from, to}.\r\n     */\r\n    toDict(minimized)\r\n    {\r\n        if (minimized) {\r\n            const ret = {};\r\n            if (this.from.x || this.from.y) { ret.from = this.from.toDict(true); }\r\n            if (this.to.x || this.to.y) { ret.to = this.to.toDict(true); }\r\n            return ret;\r\n        }\r\n        return {from: this.from.toDict(), to: this.to.toDict()};\r\n    }\r\n\r\n    /**\r\n     * Check if this circle contains a Vector2.\r\n     * @param {Vector2} p Point to check.\r\n     * @param {Number} threshold Distance between point and line to consider as intersecting. Default is 0.5, meaning it will treat point and line as round integers (sort-of).\r\n     * @returns {Boolean} if point is contained within the circle.\r\n     */\r\n    containsVector(p, threshold)\r\n    {\r\n        let A = this.from;\r\n        let B = this.to;\r\n        let distance = Vector2.distance;\r\n        if (threshold === undefined) { threshold = 0.5; }\r\n        return Math.abs((distance(A, p) + distance(B, p)) - distance(A, B)) <= threshold;\r\n    }\r\n\r\n    /**\r\n     * Check if this line collides with another line.\r\n     * @param {Line} other Other line to test collision with.\r\n     * @returns {Boolean} True if lines collide, false otherwise.\r\n     */\r\n    collideLine(other)\r\n    {\r\n        let p0 = this.from;\r\n        let p1 = this.to;\r\n        let p2 = other.from;\r\n        let p3 = other.to;\r\n\r\n        if (p0.equals(p2) || p0.equals(p3) || p1.equals(p2) || p1.equals(p3)) {\r\n            return true;\r\n        }\r\n\r\n        let s1_x, s1_y, s2_x, s2_y;\r\n        s1_x = p1.x - p0.x;\r\n        s1_y = p1.y - p0.y;\r\n        s2_x = p3.x - p2.x;\r\n        s2_y = p3.y - p2.y;\r\n    \r\n        let s, t;\r\n        s = (-s1_y * (p0.x - p2.x) + s1_x * (p0.y - p2.y)) / (-s2_x * s1_y + s1_x * s2_y);\r\n        t = (s2_x * (p0.y - p2.y) - s2_y * (p0.x - p2.x)) / (-s2_x * s1_y + s1_x * s2_y);\r\n    \r\n        return (s >= 0 && s <= 1 && t >= 0 && t <= 1);\r\n    }\r\n\r\n    /**\r\n     * Get the shortest distance between this line segment and a vector.\r\n     * @param {Vector2} v Vector to get distance to.\r\n     * @returns {Number} Shortest distance between line and vector.\r\n     */\r\n    distanceToVector(v)\r\n    {\r\n        let x1 = this.from.x;\r\n        let x2 = this.to.x;\r\n        let y1 = this.from.y;\r\n        let y2 = this.to.y;\r\n\r\n        var A = v.x - x1;\r\n        var B = v.y - y1;\r\n        var C = x2 - x1;\r\n        var D = y2 - y1;\r\n      \r\n        var dot = A * C + B * D;\r\n        var len_sq = C * C + D * D;\r\n        var param = -1;\r\n        if (len_sq != 0) //in case of 0 length line\r\n            param = dot / len_sq;\r\n      \r\n        var xx, yy;\r\n      \r\n        if (param < 0) {\r\n          xx = x1;\r\n          yy = y1;\r\n        }\r\n        else if (param > 1) {\r\n          xx = x2;\r\n          yy = y2;\r\n        }\r\n        else {\r\n          xx = x1 + param * C;\r\n          yy = y1 + param * D;\r\n        }\r\n      \r\n        var dx = v.x - xx;\r\n        var dy = v.y - yy;\r\n        return Math.sqrt(dx * dx + dy * dy);\r\n    }\r\n\r\n    /**\r\n     * Check if equal to another circle.\r\n     * @param {Circle} other Other circle to compare to.\r\n     * @returns {Boolean} True if circles are equal, false otherwise.\r\n     */\r\n    equals(other)\r\n    {\r\n        return (this === other) || \r\n                (other && (other.constructor === this.constructor) && this.from.equals(other.from) && this.to.equals(other.to));\r\n    }\r\n\r\n    /**\r\n     * Lerp between two lines.\r\n     * @param {Line} l1 First lines.\r\n     * @param {Line} l2 Second lines.\r\n     * @param {Number} a Lerp factor (0.0 - 1.0).\r\n     * @returns {Line} result lines.\r\n     */\r\n    static lerp(l1, l2, a)\r\n    {\r\n        return new Line(Vector2.lerp(l1.from, l2.from, a), Vector2.lerp(l1.to, l2.to, a));\r\n    }\r\n}\r\n\r\n\r\n// export the line class\r\nmodule.exports = Line;", "/**\r\n * Implement a simple 2d rectangle.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\rectangle.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\n\r\nconst Circle = require('./circle');\r\nconst Line = require('./line');\r\nconst MathHelper = require('./math_helper');\r\nconst Vector2 = require('./vector2');\r\n\r\n\r\n/**\r\n * Implement a simple 2d Rectangle.\r\n */\r\nclass Rectangle\r\n{\r\n    /**\r\n     * Create the Rect.\r\n     * @param {Number} x Rect position X (top left corner).\r\n     * @param {Number} y Rect position Y (top left corner).\r\n     * @param {Number} width Rect width.\r\n     * @param {Number} height Rect height.\r\n     */\r\n    constructor(x, y, width, height)\r\n    {\r\n        this.x = x || 0;\r\n        this.y = y || 0;\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n\r\n    /**\r\n     * Set rectangle values.\r\n     * @param {Number} x Rectangle x position.\r\n     * @param {Number} y Rectangle y position.\r\n     * @param {Number} width Rectangle width.\r\n     * @param {Number} height Rectangle height.\r\n     * @returns {Rectangle} this.\r\n     */\r\n    set(x, y, width, height)\r\n    {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.width = width;\r\n        this.height = height;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Copy another rectangle.\r\n     * @param {other} other Rectangle to copy.\r\n     * @returns {Rectangle} this.\r\n     */\r\n    copy(other)\r\n    {\r\n        this.x = other.x;\r\n        this.y = other.y;\r\n        this.width = other.width;\r\n        this.height = other.height;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Get position as Vector2.\r\n     * @returns {Vector2} Position vector.\r\n     */\r\n    getPosition()\r\n    {\r\n        return new Vector2(this.x, this.y);\r\n    }\r\n    \r\n    /**\r\n     * Get size as Vector2.\r\n     * @returns {Vector2} Size vector.\r\n     */\r\n    getSize()\r\n    {\r\n        return new Vector2(this.width, this.height);\r\n    }\r\n\t\r\n\t/**\r\n     * Get center position.\r\n     * @returns {Vector2} Position vector.\r\n     */\r\n    getCenter()\r\n    {\r\n        return new Vector2(Math.round(this.x + this.width / 2), Math.round(this.y + this.height / 2));\r\n    }\r\n\r\n    /**\r\n     * Get left value.\r\n     * @returns {Number} rectangle left.\r\n     */\r\n    get left()\r\n    {\r\n        return this.x;\r\n    }\r\n\r\n    /**\r\n     * Get right value.\r\n     * @returns {Number} rectangle right.\r\n     */\r\n    get right()\r\n    {\r\n        return this.x + this.width;\r\n    }\r\n\r\n    /**\r\n     * Get top value.\r\n     * @returns {Number} rectangle top.\r\n     */\r\n    get top()\r\n    {\r\n        return this.y;\r\n    }\r\n\r\n    /**\r\n     * Get bottom value.\r\n     * @returns {Number} rectangle bottom.\r\n     */\r\n    get bottom()\r\n    {\r\n        return this.y + this.height;\r\n    }\r\n\r\n    /**\r\n     * Return a clone of this rectangle.\r\n     * @returns {Rectangle} Cloned rectangle.\r\n     */\r\n    clone()\r\n    {\r\n        return new Rectangle(this.x, this.y, this.width, this.height);\r\n    }\r\n\r\n    /**\r\n     * Get top-left corner.\r\n     * @returns {Vector2} Corner position vector.\r\n     */\r\n    getTopLeft()\r\n    {\r\n        return new Vector2(this.x, this.y);\r\n    }\r\n\r\n    /**\r\n     * Get top-right corner.\r\n     * @returns {Vector2} Corner position vector.\r\n     */\r\n    getTopRight()\r\n    {\r\n        return new Vector2(this.x + this.width, this.y);\r\n    }\r\n        \r\n    /**\r\n     * Get bottom-left corner.\r\n     * @returns {Vector2} Corner position vector.\r\n     */\r\n    getBottomLeft()\r\n    {\r\n        return new Vector2(this.x, this.y + this.height);\r\n    }\r\n\r\n    /**\r\n     * Get bottom-right corner.\r\n     * @returns {Vector2} Corner position vector.\r\n     */\r\n    getBottomRight()\r\n    {\r\n        return new Vector2(this.x + this.width, this.y + this.height);\r\n    }\r\n\r\n    /**\r\n     * Convert to string.\r\n     */\r\n    string() \r\n    {\r\n        return this.x + ',' + this.y + ',' + this.width + ',' + this.height;\r\n    }\r\n\r\n    /**\r\n     * Check if this rectangle contains a Vector2.\r\n     * @param {Vector2} p Point to check.\r\n     * @returns {Boolean} if point is contained within the rectangle.\r\n     */\r\n    containsVector(p) \r\n    {\r\n        return p.x >= this.x && p.x <= this.x + this.width && p.y >= this.y && p.y <= this.y + this.height;\r\n    }\r\n\r\n    /**\r\n     * Check if this rectangle collides with another rectangle.\r\n     * @param {Rectangle} other Rectangle to check collision with.\r\n     * @return {Boolean} if rectangles collide.\r\n     */\r\n    collideRect(other)\r\n    {\r\n        let r1 = this;\r\n        let r2 = other;\r\n        return !(r2.left >= r1.right ||\r\n                r2.right <= r1.left ||\r\n                r2.top >= r1.bottom ||\r\n                r2.bottom <= r1.top);\r\n    }\r\n  \r\n    /**\r\n     * Check if this rectangle collides with a line.\r\n     * @param {Line} line Line to check collision with.\r\n     * @return {Boolean} if rectangle collides with line.\r\n     */\r\n    collideLine(line)\r\n    {\r\n        // first check if rectangle contains any of the line points\r\n        if (this.containsVector(line.from) || this.containsVector(line.to)) {\r\n            return true;\r\n        }\r\n\r\n        // now check intersection with the rectangle lines\r\n        let topLeft = this.getTopLeft();\r\n        let topRight = this.getTopRight();\r\n        let bottomLeft = this.getBottomLeft();\r\n        let bottomRight = this.getBottomRight();\r\n        if (line.collideLine(new Line(topLeft, topRight))) {\r\n            return true;\r\n        }\r\n        if (line.collideLine(new Line(topLeft, bottomLeft))) {\r\n            return true;\r\n        }\r\n        if (line.collideLine(new Line(topRight, bottomRight))) {\r\n            return true;\r\n        }\r\n        if (line.collideLine(new Line(bottomLeft, bottomRight))) {\r\n            return true;\r\n        }\r\n\r\n        // no collision\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Checks if this rectangle collides with a circle.\r\n     * @param {Circle} circle Circle to check collision with.\r\n     * @return {Boolean} if rectangle collides with circle.\r\n     */\r\n    collideCircle(circle) \r\n    {\r\n        // get center and radius\r\n        let center = circle.center;\r\n        let radius = circle.radius;\r\n\r\n        // first check if circle center is inside the rectangle - easy case\r\n        let rect = this;\r\n        if (rect.containsVector(center)) {\r\n            return true;\r\n        }\r\n\r\n        // get rectangle center\r\n        let rectCenter = rect.getCenter();\r\n\r\n        // get corners\r\n        let topLeft = rect.getTopLeft();\r\n        let topRight = rect.getTopRight();\r\n        let bottomRight = rect.getBottomRight();\r\n        let bottomLeft = rect.getBottomLeft();\r\n\r\n        // create a list of lines to check (in the rectangle) based on circle position to rect center\r\n        let lines = [];\r\n        if (rectCenter.x > center.x) {\r\n            lines.push([topLeft, bottomLeft]);\r\n        } else {\r\n            lines.push([topRight, bottomRight]);\r\n        }\r\n        if (rectCenter.y > center.y) {\r\n            lines.push([topLeft, topRight]);\r\n        } else {\r\n            lines.push([bottomLeft, bottomRight]);\r\n        }\r\n\r\n        // now check intersection between circle and each of the rectangle lines\r\n        for (let i = 0; i < lines.length; ++i) {\r\n            let disToLine = pointLineDistance(center, lines[i][0], lines[i][1]);\r\n            if (disToLine <= radius) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        // no collision..\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Get the smallest circle containing this rectangle.\r\n     * @returns {Circle} Bounding circle.\r\n     */\r\n    getBoundingCircle()\r\n    {\r\n        let center = this.getCenter();\r\n        let radius = center.distanceTo(this.getTopLeft());\r\n        return new Circle(center, radius);\r\n    }\r\n    \r\n    /**\r\n     * Build and return a rectangle from points.\r\n     * @param {Array<Vector2>} points Points to build rectangle from.\r\n     * @returns {Rectangle} new rectangle from points.\r\n     */\r\n    static fromPoints(points)\r\n    {\r\n        let min_x = points[0].x;\r\n        let min_y = points[0].y;\r\n        let max_x = min_x;\r\n        let max_y = min_y;\r\n\r\n        for (let i = 1; i < points.length; ++i) {\r\n            min_x = Math.min(min_x, points[i].x);\r\n            min_y = Math.min(min_y, points[i].y);\r\n            max_x = Math.max(max_x, points[i].x);\r\n            max_y = Math.max(max_y, points[i].y);\r\n        }\r\n\r\n        return new Rectangle(min_x, min_y, max_x - min_x, max_y - min_y);\r\n    }\r\n\r\n    /**\r\n     * Return a resized rectangle with the same center point.\r\n     * @param {Number|Vector2} amount Amount to resize.\r\n     * @returns {Rectangle} resized rectangle.\r\n     */\r\n    resize(amount)\r\n    {\r\n        if (typeof amount === 'number') {\r\n            amount = new Vector2(amount, amount);\r\n        }\r\n        return new Rectangle(this.x - amount.x / 2, this.y - amount.y / 2, this.width + amount.x, this.height + amount.y);\r\n    }\r\n\r\n    /**\r\n     * Check if equal to another rectangle.\r\n     * @param {Rectangle} other Other rectangle to compare to.\r\n     */\r\n    equals(other)\r\n    {\r\n        return (this === other) || \r\n                (other && (other.constructor === this.constructor) && this.x == other.x && this.y == other.y && this.width == other.width && this.height == other.height);\r\n    }\r\n\r\n    /**\r\n     * Lerp between two rectangles.\r\n     * @param {Rectangle} p1 First rectangles.\r\n     * @param {Rectangle} p2 Second rectangles.\r\n     * @param {Number} a Lerp factor (0.0 - 1.0).\r\n     * @returns {Rectangle} result rectangle.\r\n     */\r\n    static lerp(p1, p2, a)\r\n    {\r\n        let lerpScalar = MathHelper.lerp;\r\n        return new Rectangle(  lerpScalar(p1.x, p2.x, a), \r\n                            lerpScalar(p1.y, p2.y, a), \r\n                            lerpScalar(p1.width, p2.width, a), \r\n                            lerpScalar(p1.height, p2.height, a)\r\n                        );\r\n    }\r\n\r\n    /**\r\n     * Create rectangle from a dictionary.\r\n     * @param {*} data Dictionary with {x,y,width,height}.\r\n     * @returns {Rectangle} Newly created rectangle.\r\n     */\r\n    static fromDict(data)\r\n    {\r\n        return new Rectangle(data.x || 0, data.y || 0, data.width || 0, data.height || 0);\r\n    }\r\n\r\n    /**\r\n     * Convert to dictionary.\r\n     * @param {Boolean} minimized If true, will not include keys that their values are 0. You can use fromDict on minimized dicts.\r\n     * @returns {*} Dictionary with {x,y,width,height}\r\n     */\r\n    toDict(minimized)\r\n    {\r\n        if (minimized) {\r\n            const ret = {};\r\n            if (this.x) { ret.x = this.x; }\r\n            if (this.y) { ret.y = this.y; }\r\n            if (this.width) { ret.width = this.width; }\r\n            if (this.height) { ret.height = this.height; }\r\n            return ret;\r\n        }\r\n        return {x: this.x, y: this.y, width: this.width, height: this.height};\r\n    }\r\n}\r\n\r\n/**\r\n * Get distance between a point and a line.\r\n * @private\r\n */\r\nfunction pointLineDistance(p1, l1, l2) {\r\n\r\n    let x = p1.x;\r\n    let y = p1.y;\r\n    let x1 = l1.x;\r\n    let y1 = l1.y;\r\n    let x2 = l2.x;\r\n    let y2 = l2.y;\r\n\r\n    var A = x - x1;\r\n    var B = y - y1;\r\n    var C = x2 - x1;\r\n    var D = y2 - y1;\r\n  \r\n    var dot = A * C + B * D;\r\n    var len_sq = C * C + D * D;\r\n    var param = -1;\r\n    if (len_sq != 0) //in case of 0 length line\r\n        param = dot / len_sq;\r\n  \r\n    var xx, yy;\r\n  \r\n    if (param < 0) {\r\n      xx = x1;\r\n      yy = y1;\r\n    }\r\n    else if (param > 1) {\r\n      xx = x2;\r\n      yy = y2;\r\n    }\r\n    else {\r\n      xx = x1 + param * C;\r\n      yy = y1 + param * D;\r\n    }\r\n  \r\n    var dx = x - xx;\r\n    var dy = y - yy;\r\n    return Math.sqrt(dx * dx + dy * dy);\r\n  }\r\n\r\n\r\n// export the rectangle class\r\nmodule.exports = Rectangle;", "/**\r\n * Assets base class.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\assets\\asset.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\n\r\n/**\r\n * A loadable asset base class.\r\n * All asset types inherit from this.\r\n */\r\nclass Asset\r\n{\r\n    /**\r\n     * Create the new asset.\r\n     * @param {String} url Asset URL / identifier.\r\n     */\r\n    constructor(url)\r\n    {\r\n        this._url = url;\r\n        this._waitingCallbacks = [];\r\n    }\r\n\r\n    /**\r\n     * Register a method to be called when asset is ready.\r\n     * If asset is already in ready state, will invoke immediately.\r\n     * @param {Function} callback Callback to invoke when asset is ready.\r\n     */\r\n    onReady(callback)\r\n    {\r\n        if (this.valid || this._waitingCallbacks === null) {\r\n            callback(this);\r\n            return;\r\n        }\r\n        this._waitingCallbacks.push(callback);\r\n    }\r\n\r\n    /**\r\n     * Return a promise to resolve when ready.\r\n     * @returns {Promise} Promise to resolve when ready.\r\n     */\r\n    waitForReady()\r\n    {\r\n        return new Promise((resolve, reject) => {\r\n            this.onReady(resolve);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Notify all waiting callbacks that this asset is ready.\r\n     * @private\r\n     */\r\n    _notifyReady()\r\n    {\r\n        if (this._waitingCallbacks) {\r\n            for (let i = 0; i < this._waitingCallbacks.length; ++i) {\r\n                this._waitingCallbacks[i](this);\r\n            }\r\n            this._waitingCallbacks = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get asset's URL.\r\n     * @returns {String} Asset URL.\r\n     */\r\n    get url()\r\n    {\r\n        return this._url;\r\n    }\r\n\r\n    /**\r\n     * Get if this asset is loaded and valid.\r\n     * @returns {Boolean} True if asset is loaded and valid, false otherwise.\r\n     */\r\n    get valid()\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n\r\n    /**\r\n     * Load the asset from it's URL.\r\n     * @param {*} params Optional additional params.\r\n     * @returns {Promise} Promise to resolve when fully loaded.\r\n     */\r\n    load(params)\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n\r\n    /**\r\n     * Create the asset from data source.\r\n     * @param {*} source Data to create asset from.\r\n     * @param {*} params Optional additional params.\r\n     * @returns {Promise} Promise to resolve when asset is ready.\r\n     */\r\n    create(source, params)\r\n    {\r\n        throw new Error(\"Not Supported for this asset type.\");\r\n    }\r\n\r\n    /**\r\n     * Destroy the asset, freeing any allocated resources in the process.\r\n     */\r\n    destroy()\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n}\r\n\r\n\r\n// export the asset base class.\r\nmodule.exports = Asset;", "/**\r\n * Define possible texture filter modes.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\texture_filter_modes.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict'; \r\n\r\n/** @typedef {String} TextureFilterMode */\r\n\r\n/**\r\n * Texture filter modes, determine how to scale textures.\r\n * @readonly\r\n * @enum {TextureFilterMode}\r\n */\r\nconst TextureFilterModes = {\r\n    Nearest: \"NEAREST\",\r\n    Linear: \"LINEAR\",\r\n    NearestMipmapNearest: \"NEAREST_MIPMAP_NEAREST\",\r\n    LinearMipmapNearest: \"LINEAR_MIPMAP_NEAREST\",\r\n    NearestMipmapLinear: \"NEAREST_MIPMAP_LINEAR\",\r\n    LinearMipmapLinear: \"LINEAR_MIPMAP_LINEAR\",\r\n};\r\n\r\nObject.defineProperty(TextureFilterModes, '_values', {\r\n    value: new Set(Object.values(TextureFilterModes)),\r\n    writable: false,\r\n});\r\n\r\nObject.freeze(TextureFilterModes);\r\nmodule.exports = {TextureFilterModes: TextureFilterModes};\r\n", "/**\r\n * Define possible texture wrap modes.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\texture_wrap_modes.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\n/** @typedef {String} TextureWrapMode */\r\n\r\n/**\r\n * Texture wrap modes, determine what to do when texture coordinates are outside texture boundaries.\r\n * @readonly\r\n * @enum {TextureWrapMode}\r\n */\r\nconst TextureWrapModes = {\r\n    Clamp: \"CLAMP_TO_EDGE\",\r\n    Repeat: \"REPEAT\",\r\n    RepeatMirrored: \"MIRRORED_REPEAT\",\r\n};\r\n\r\nObject.defineProperty(TextureWrapModes, '_values', {\r\n    value: new Set(Object.values(TextureWrapModes)),\r\n    writable: false,\r\n});\r\n\r\nObject.freeze(TextureWrapModes);\r\nmodule.exports = {TextureWrapModes: TextureWrapModes};", "/**\r\n * Implement basic logger.\r\n * By default, uses console for logging, but it can be replaced with setDrivers().\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\logger.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\n// default logger drivers.\r\nvar _drivers = console;\r\n\r\n// application name\r\nvar _application = \"Shaku\";\r\n\r\n/**\r\n * A logger manager.\r\n * By default writes logs to console.\r\n */\r\nclass Logger\r\n{\r\n    constructor(name)\r\n    {\r\n        this._nameHeader = '[' + _application + '][' + name + ']';\r\n        this._throwErrors = false;\r\n    }\r\n\r\n    /**\r\n     * Write a trace level log message.\r\n     * @param {String} msg Message to write.\r\n     */\r\n    trace(msg)\r\n    {\r\n        _drivers.trace(this._nameHeader, msg);\r\n    }\r\n\r\n    /**\r\n     * Write a debug level log message.\r\n     * @param {String} msg Message to write.\r\n     */\r\n    debug(msg)\r\n    {\r\n        _drivers.debug(this._nameHeader, msg);\r\n    }\r\n\r\n    /**\r\n     * Write an info level log message.\r\n     * @param {String} msg Message to write.\r\n     */\r\n    info(msg)\r\n    {\r\n        _drivers.info(this._nameHeader, msg);\r\n    }\r\n\r\n    /**\r\n     * Write a warning level log message.\r\n     * @param {String} msg Message to write.\r\n     */\r\n    warn(msg)\r\n    {\r\n        _drivers.warn(this._nameHeader, msg);\r\n        if (this._throwErrors) {\r\n            throw new Error(msg);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Write an error level log message.\r\n     * @param {String} msg Message to write.\r\n     */\r\n    error(msg)\r\n    {\r\n        _drivers.error(this._nameHeader, msg);\r\n        if (this._throwErrors) {\r\n            throw new Error(msg);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set logger to throw an error every time a log message with severity higher than warning is written.\r\n     * @param {Boolean} enable Set to true to throw error on warnings.\r\n     */\r\n    throwErrorOnWarnings(enable)\r\n    {\r\n        this._throwErrors = Boolean(enable);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Null logger drivers to silent logs.\r\n * @private\r\n */\r\nclass NullDrivers\r\n{\r\n    /**\r\n     * @private\r\n     */\r\n    constructor()\r\n    {\r\n    }\r\n    trace(msg)\r\n    {\r\n    }\r\n    debug(msg)\r\n    {\r\n    }\r\n    info(msg)\r\n    {\r\n    }\r\n    warn(msg)\r\n    {\r\n    }\r\n    error(msg)\r\n    {\r\n    }\r\n}\r\n\r\n// export the seeded random class.\r\nmodule.exports = {\r\n\r\n    /**\r\n     * Get a logger object.\r\n     * @param {String} name Logger name.\r\n     */\r\n    getLogger: function(name) {\r\n        return new Logger(name);\r\n    },\r\n\r\n    /**\r\n     * Silent the logger.\r\n     */\r\n    silent: function() {\r\n        _drivers = new NullDrivers();\r\n    },\r\n\r\n    /**\r\n     * Set log drivers that implement trace, debug, info, warn and error that all loggers will use.\r\n     */\r\n    setDrivers: function(drivers)\r\n    {\r\n        _drivers = drivers;\r\n    },\r\n\r\n    /**\r\n     * Set logger application name.\r\n     * @param {String} name Set application name to replace the 'Shaku' in the headers.\r\n     */\r\n    setApplicationName: function(name)\r\n    {\r\n        _application = name;\r\n        return this;\r\n    }\r\n};", "/**\r\n * Implement texture asset type.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\assets\\texture_asset.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst Asset = require(\"./asset\");\r\nconst {TextureFilterMode, TextureFilterModes} = require('../gfx/texture_filter_modes');\r\nconst {TextureWrapMode, TextureWrapModes} = require('../gfx/texture_wrap_modes');\r\nconst Color = require('../utils/color');\r\nconst Vector2 = require(\"../utils/vector2\");\r\nconst _logger = require('../logger.js').getLogger('assets');\r\n\r\n// the webgl context to use\r\nvar gl = null;\r\n\r\n\r\n/**\r\n * A loadable texture asset.\r\n * This asset type loads an image from URL or source, and turn it into a texture.\r\n */\r\nclass TextureAsset extends Asset\r\n{\r\n    /** @inheritdoc */\r\n    constructor(url)\r\n    {\r\n        super(url);\r\n        this._image = null;\r\n        this._width = 0;\r\n        this._height = 0;\r\n        this._texture = null;\r\n        this._filter = null;\r\n        this._wrapMode = null;\r\n        this._ctxForPixelData = null;\r\n    }\r\n\r\n    /**\r\n     * Set the WebGL context.\r\n     * @private\r\n     */\r\n    static _setWebGl(_gl)\r\n    {\r\n        gl = _gl;\r\n    }\r\n\r\n    /**\r\n     * Get texture magnifying filter, or null to use default.\r\n     * @see Shaku.gfx.TextureFilterModes\r\n     */\r\n    get filter()\r\n    {\r\n        return this._filter;\r\n    }\r\n\r\n    /**\r\n     * Set texture magnifying filter.\r\n     * @see Shaku.gfx.TextureFilterModes \r\n     * @param {TextureFilterMode} value Filter mode to use or null to use default.\r\n     */\r\n    set filter(value)\r\n    {\r\n        this._filter = value;\r\n    }\r\n\r\n    /**\r\n     * Get texture wrapping mode, or null to use default.\r\n     * @see Shaku.gfx.TextureWrapModes\r\n     */\r\n    get wrapMode()\r\n    {\r\n        return this._wrapMode;\r\n    }\r\n\r\n    /**\r\n     * Set texture wrapping mode.\r\n     * @see Shaku.gfx.TextureWrapModes\r\n     * @param {TextureWrapMode} value Wrapping mode to use or null to use default.\r\n     */\r\n    set wrapMode(value)\r\n    {\r\n        this._wrapMode = value;\r\n    }\r\n    \r\n    /**\r\n     * Load the texture from it's image URL.\r\n     * @param {*} params Optional additional params. Possible values are:\r\n     *                      - generateMipMaps (default=false): should we generate mipmaps for this texture?\r\n     *                      - crossOrigin (default=undefined): if set, will set the crossOrigin property with this value.\r\n     * @returns {Promise} Promise to resolve when fully loaded.\r\n     */\r\n    load(params)\r\n    {\r\n        // default params\r\n        params = params || {};\r\n\r\n        return new Promise((resolve, reject) => {\r\n\r\n            if (!gl) {\r\n                return reject(\"Can't load textures before initializing gfx manager!\");\r\n            }\r\n\r\n            // create image to load\r\n            const image = new Image();\r\n            if (params.crossOrigin !== undefined) {\r\n                image.crossOrigin = params.crossOrigin;\r\n            }\r\n            image.onload = async () =>\r\n            {\r\n                try {\r\n                    await this.create(image, params);\r\n                    this._notifyReady();\r\n                    resolve();\r\n                }\r\n                catch (e) {\r\n                    reject(e);\r\n                }\r\n            };\r\n            image.onerror = () => {\r\n                reject(\"Failed to load texture image!\");\r\n            }\r\n\r\n            // initiate image load\r\n            image.src = this.url;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Create this texture as an empty render target.\r\n     * @param {Number} width Texture width.\r\n     * @param {Number} height Texture height.\r\n     * @param {Number} channels Texture channels count. Defaults to 4 (RGBA).\r\n     */\r\n    createRenderTarget(width, height, channels)\r\n    {\r\n        // create to render to\r\n        const targetTextureWidth = width;\r\n        const targetTextureHeight = height;\r\n        const targetTexture = gl.createTexture();\r\n        gl.bindTexture(gl.TEXTURE_2D, targetTexture);\r\n        \r\n        // calculate format\r\n        var _format = gl.RGBA;\r\n        if (channels !== undefined) {\r\n            switch (channels) {\r\n                case 1:\r\n                    _format = gl.LUMINANCE;\r\n                    break;\r\n                case 3:\r\n                    _format = gl.RGB;\r\n                    break;\r\n                case 4:\r\n                    _format = gl.RGBA;\r\n                    break;\r\n                default:\r\n                    throw new Error(\"Unknown render target format!\");\r\n            }\r\n        }\r\n\r\n        {\r\n            // create texture\r\n            const level = 0;\r\n            const internalFormat = _format;\r\n            const border = 0;\r\n            const format = _format;\r\n            const type = gl.UNSIGNED_BYTE;\r\n            const data = null;\r\n            gl.texImage2D(gl.TEXTURE_2D, level, internalFormat,\r\n                            targetTextureWidth, targetTextureHeight, border,\r\n                            format, type, data);\r\n            \r\n            // set default wrap and filter modes\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        }\r\n\r\n        // store texture\r\n        this._width = width;\r\n        this._height = height;\r\n        this._texture = targetTexture;\r\n        this._notifyReady();\r\n    }\r\n\r\n    /**\r\n     * Create texture from loaded image instance.\r\n     * @see TextureAsset.load for params.\r\n     * @param {Image} image Image to create texture from. Image must be loaded!\r\n     * @param {*} params Optional additional params. See load() for details.\r\n     */\r\n    fromImage(image, params)\r\n    {\r\n        if (image.width === 0) { \r\n            throw new Error(\"Image to build texture from must be loaded and have valid size!\");\r\n        }\r\n\r\n        if (this.valid) {\r\n            throw new Error(\"Texture asset is already initialized!\");\r\n        }\r\n        \r\n        // default params\r\n        params = params || {};\r\n\r\n        // store image\r\n        this._image = image;\r\n        this._width = image.width;\r\n        this._height = image.height;\r\n\r\n        // create texture\r\n        const texture = gl.createTexture();\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n\r\n        // set texture\r\n        const level = 0;\r\n        const internalFormat = gl.RGBA;\r\n        const srcFormat = gl.RGBA;\r\n        const srcType = gl.UNSIGNED_BYTE;\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n        gl.texImage2D(gl.TEXTURE_2D, level, internalFormat, srcFormat, srcType, image);\r\n\r\n        // WebGL1 has different requirements for power of 2 images\r\n        // vs non power of 2 images so check if the image is a\r\n        // power of 2 in both dimensions.\r\n        if (params.generateMipMaps) {\r\n            if (isPowerOf2(image.width) && isPowerOf2(image.height)) {\r\n                _logger.warn(\"Tried to generate MipMaps for a texture with size that is *not* a power of two. This might not work as expected.\");\r\n            } \r\n            gl.generateMipmap(gl.TEXTURE_2D);\r\n        }\r\n\r\n        // default wrap and filters\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n\r\n        // success!\r\n        this._texture = texture;\r\n        this._notifyReady();\r\n    }\r\n\r\n    /**\r\n     * Create the texture from an image.\r\n     * @see TextureAsset.load for params.\r\n     * @param {Image|String} source Image or Image source URL to create texture from.\r\n     * @param {*} params Optional additional params. See load() for details.\r\n     * @returns {Promise} Promise to resolve when asset is ready.\r\n     */\r\n    create(source, params)\r\n    {\r\n        return new Promise(async (resolve, reject) => {\r\n\r\n            if (typeof source === \"string\") {\r\n                let img = new Image();\r\n                img.onload = () => {\r\n                    this.fromImage(source, params);\r\n                    this._notifyReady();\r\n                    resolve();\r\n                }\r\n                if (params.crossOrigin !== undefined) {\r\n                    img.crossOrigin = params.crossOrigin;\r\n                }\r\n                img.src = source;\r\n            }\r\n            else {\r\n                this.fromImage(source, params);\r\n                resolve();\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Get raw image.\r\n     * @returns {Image} Image instance.\r\n     */\r\n    get image()\r\n    {\r\n        return this._image;\r\n    }\r\n\r\n    /**\r\n     * Get texture width.\r\n     * @returns {Number} Texture width.\r\n     */\r\n    get width()\r\n    {\r\n        return this._width;\r\n    }\r\n\r\n    /**\r\n     * Get texture height.\r\n     * @returns {Number} Texture height.\r\n     */\r\n    get height()\r\n    {\r\n        return this._height;\r\n    }\r\n\r\n    /**\r\n     * Get texture size as a vector.\r\n     * @returns {Vector2} Texture size.\r\n     */\r\n    get size()\r\n    {\r\n        return new Vector2(this.width, this.height);\r\n    }\r\n\r\n    /**\r\n     * Get texture instance for WebGL.\r\n     */\r\n    get texture()\r\n    {\r\n        return this._texture;\r\n    }\r\n\r\n    /**\r\n     * Get pixel color from image.\r\n     * @param {Number} x Pixel X value.\r\n     * @param {Number} y Pixel Y value.\r\n     * @returns {Color} Pixel color.\r\n     */\r\n    getPixel(x, y) \r\n    {\r\n        if (!this._image) { \r\n            throw new Error(\"'getPixel()' only works on textures loaded from image!\");\r\n        }\r\n\r\n        // build internal canvas and context to get pixel data\r\n        if (!this._ctxForPixelData) {\r\n            let canvas = document.createElement('canvas');\r\n            canvas.width = 1;\r\n            canvas.height = 1;\r\n            this._ctxForPixelData = canvas.getContext('2d');\r\n        }\r\n\r\n        // get pixel data\r\n        let ctx = this._ctxForPixelData;\r\n        ctx.drawImage(this._image, x, y, 1, 1, 0, 0, 1, 1);\r\n        let pixelData = ctx.getImageData(0, 0, 1, 1).data;   \r\n        return Color.fromBytesArray(pixelData);\r\n    }\r\n\r\n    /** @inheritdoc */\r\n    get valid()\r\n    {\r\n        return Boolean(this._texture);\r\n    }\r\n\r\n    /** @inheritdoc */\r\n    destroy()\r\n    {\r\n        gl.deleteTexture(this._texture);\r\n        this._image = null;\r\n        this._width = this._height = 0;\r\n        this._ctxForPixelData = null;\r\n        this._texture = null;\r\n    }\r\n}\r\n\r\n// check if value is a power of 2\r\nfunction isPowerOf2(value) {\r\n    return (value & (value - 1)) == 0;\r\n}\r\n\r\n\r\n// export the asset type.\r\nmodule.exports = TextureAsset;", "/**\r\n * Implement a 3d vector.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\vector3.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\nconst MathHelper = require(\"./math_helper\");\r\n\r\n/**\r\n * A Vector object for 3d positions.\r\n */\r\nclass Vector3\r\n{\r\n    /**\r\n     * Create the Vector object.\r\n     * @param {number} x Vector X.\r\n     * @param {number} y Vector Y.\r\n     * @param {number} z Vector Z.\r\n     */\r\n    constructor(x = 0, y = 0, z = 0)\r\n    {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n    }\r\n    \r\n    /**\r\n     * Clone the vector.\r\n     * @returns {Vector3} cloned vector.\r\n     */\r\n    clone()\r\n    {\r\n        return new Vector3(this.x, this.y, this.z);\r\n    }\r\n    \r\n    /**\r\n     * Set vector value.\r\n     * @param {Number} x X component.\r\n     * @param {Number} y Y component.\r\n     * @param {Number} z Z component.\r\n     * @returns {Vector3} this.\r\n     */\r\n    set(x, y)\r\n    {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Copy values from other vector into self.\r\n     * @returns {Vector3} this.\r\n     */\r\n    copy(other) \r\n    {\r\n        this.x = other.x;\r\n        this.y = other.y;\r\n        this.z = other.z;\r\n        return this;\r\n    }\r\n    \r\n    /**\r\n     * Return a new vector of this + other.\r\n     * @param {Number|Vector3} Other Vector or number to add.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    add(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            return new Vector3(\r\n                this.x + other, \r\n                this.y + (arguments[1] === undefined ? other : arguments[1]),\r\n                this.z + (arguments[2] === undefined ? other : arguments[2])\r\n            );\r\n        }\r\n        return new Vector3(this.x + other.x, this.y + other.y, this.z + other.z);\r\n    }\r\n    \r\n    /**\r\n     * Return a new vector of this - other.\r\n     * @param {Number|Vector3} Other Vector or number to sub.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    sub(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            return new Vector3(\r\n                this.x - other, \r\n                this.y - (arguments[1] === undefined ? other : arguments[1]),\r\n                this.z - (arguments[2] === undefined ? other : arguments[2])\r\n            );\r\n        }\r\n        return new Vector3(this.x - other.x, this.y - other.y, this.z - other.z);\r\n    }\r\n    \r\n    /**\r\n     * Return a new vector of this / other.\r\n     * @param {Number|Vector3} Other Vector or number to divide.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    div(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            return new Vector3(\r\n                this.x / other, \r\n                this.y / (arguments[1] === undefined ? other : arguments[1]),\r\n                this.z / (arguments[2] === undefined ? other : arguments[2])\r\n            );\r\n        }\r\n        return new Vector3(this.x / other.x, this.y / other.y, this.z / other.z);\r\n    }\r\n    \r\n    /**\r\n     * Return a new vector of this * other.\r\n     * @param {Number|Vector3} Other Vector or number to multiply.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    mul(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            return new Vector3(\r\n                this.x * other, \r\n                this.y * (arguments[1] === undefined ? other : arguments[1]),\r\n                this.z * (arguments[2] === undefined ? other : arguments[2])\r\n            );\r\n        }\r\n        return new Vector3(this.x * other.x, this.y * other.y, this.z * other.z);\r\n    }\r\n    \r\n    /**\r\n     * Return a round copy of this vector.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    round() \r\n    {\r\n        return new Vector3(Math.round(this.x), Math.round(this.y), Math.round(this.z));\r\n    }\r\n    \r\n    /**\r\n     * Return a floored copy of this vector.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    floor() \r\n    {\r\n        return new Vector3(Math.floor(this.x), Math.floor(this.y), Math.floor(this.z));\r\n    }\r\n        \r\n    /**\r\n     * Return a ceiled copy of this vector.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    ceil() \r\n    {\r\n        return new Vector3(Math.ceil(this.x), Math.ceil(this.y), Math.ceil(this.z));\r\n    }\r\n    \r\n    /**\r\n     * Return a normalized copy of this vector.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    normalized()\r\n    {\r\n        if (this.x == 0 && this.y == 0 && this.z == 0) { return Vector3.zero; }\r\n        let mag = this.length;\r\n        return new Vector3(this.x / mag, this.y / mag, this.z / mag);\r\n    }\r\n\r\n    /**\r\n     * Add other vector values to self.\r\n     * @param {Number|Vector3} Other Vector or number to add.\r\n     * @returns {Vector3} this.\r\n     */\r\n    addSelf(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            this.x += other;\r\n            this.y += (arguments[1] === undefined ? other : arguments[1]);\r\n            this.z += (arguments[2] === undefined ? other : arguments[2]);\r\n        }\r\n        else {\r\n            this.x += other.x;\r\n            this.y += other.y;\r\n            this.z += other.z;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Sub other vector values from self.\r\n     * @param {Number|Vector3} Other Vector or number to substract.\r\n     * @returns {Vector3} this.\r\n     */\r\n    subSelf(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            this.x -= other;\r\n            this.y -= (arguments[1] === undefined ? other : arguments[1]);\r\n            this.z -= (arguments[2] === undefined ? other : arguments[2]);\r\n        }\r\n        else {\r\n            this.x -= other.x;\r\n            this.y -= other.y;\r\n            this.z -= other.z;\r\n        }\r\n        return this;\r\n    }\r\n    \r\n    /**\r\n     * Divide this vector by other vector values.\r\n     * @param {Number|Vector3} Other Vector or number to divide by.\r\n     * @returns {Vector3} this.\r\n     */\r\n    divSelf(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            this.x /= other;\r\n            this.y /= (arguments[1] === undefined ? other : arguments[1]);\r\n            this.z /= (arguments[2] === undefined ? other : arguments[2]);\r\n        }\r\n        else {\r\n            this.x /= other.x;\r\n            this.y /= other.y;\r\n            this.z /= other.z;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Multiply this vector by other vector values.\r\n     * @param {Number|Vector3} Other Vector or number to multiply by.\r\n     * @returns {Vector3} this.\r\n     */\r\n    mulSelf(other) \r\n    {\r\n        if (typeof other === 'number') {\r\n            this.x *= other;\r\n            this.y *= (arguments[1] === undefined ? other : arguments[1]);\r\n            this.z *= (arguments[2] === undefined ? other : arguments[2]);\r\n        }\r\n        else {\r\n            this.x *= other.x;\r\n            this.y *= other.y;\r\n            this.z *= other.z;\r\n        }\r\n        return this;\r\n    }\r\n    \r\n    /**\r\n     * Round self.\r\n     * @returns {Vector3} this.\r\n     */\r\n    roundSelf() \r\n    {\r\n        this.x = Math.round(this.x);\r\n        this.y = Math.round(this.y);\r\n        this.z = Math.round(this.z);\r\n        return this;\r\n    }\r\n    \r\n    /**\r\n     * Floor self.\r\n     * @returns {Vector3} this.\r\n     */\r\n    floorSelf() \r\n    {\r\n        this.x = Math.floor(this.x);\r\n        this.y = Math.floor(this.y);\r\n        this.z = Math.floor(this.z);\r\n        return this;\r\n    }\r\n     \r\n    /**\r\n     * Ceil self.\r\n     * @returns {Vector3} this.\r\n     */\r\n    ceilSelf() \r\n    {\r\n        this.x = Math.ceil(this.x);\r\n        this.y = Math.ceil(this.y);\r\n        this.z = Math.ceil(this.z);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Return a normalized copy of this vector.\r\n     * @returns {Vector3} this.\r\n     */\r\n    normalizeSelf()\r\n    {\r\n        if (this.x == 0 && this.y == 0 && this.z == 0) { return this; }\r\n        let mag = this.length;\r\n        this.x /= mag;\r\n        this.y /= mag;\r\n        this.z /= mag;\r\n        return this;\r\n    }\r\n    \r\n    /**\r\n     * Return if vector equals another vector.\r\n     * @param {Vector3} other Other vector to compare to.\r\n     * @returns {Boolean} if vectors are equal.\r\n     */\r\n    equals(other)\r\n    {\r\n        return ((this === other) || \r\n                ((other.constructor === this.constructor) && \r\n                this.x === other.x && this.y === other.y && this.z === other.z)\r\n            );\r\n    }\r\n    \r\n    /**\r\n     * Return if vector approximately equals another vector.\r\n     * @param {Vector3} other Other vector to compare to.\r\n     * @param {Number} threshold Distance threshold to consider as equal. Defaults to 1.\r\n     * @returns {Boolean} if vectors are equal.\r\n     */\r\n    approximate(other, threshold)\r\n    {\r\n        threshold = threshold || 1;\r\n        return (\r\n            (this === other) || \r\n                ((Math.abs(this.x - other.x) <= threshold) && \r\n                (Math.abs(this.y - other.y) <= threshold) && \r\n                (Math.abs(this.z - other.z) <= threshold))\r\n            );\r\n    }\r\n\r\n    /**\r\n     * Return vector length (aka magnitude).\r\n     * @returns {Number} Vector length.\r\n     */\r\n    get length()\r\n    {\r\n        return Math.sqrt((this.x * this.x) + (this.y * this.y) + (this.z * this.z));\r\n    }\r\n\r\n    /**\r\n     * Return a copy of this vector multiplied by a factor.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    scaled(fac) \r\n    {\r\n        return new Vector3(this.x * fac, this.y * fac, this.z * fac);\r\n    }\r\n\r\n    /**\r\n     * Get vector (0,0).\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    static get zero()\r\n    {\r\n        return new Vector3();\r\n    }\r\n\r\n    /**\r\n     * Get vector with 1,1 values.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    static get one()\r\n    {\r\n        return new Vector3(1, 1, 1);\r\n    }\r\n\r\n    /**\r\n     * Get vector with 0.5,0.5 values.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    static get half()\r\n    {\r\n        return new Vector3(0.5, 0.5, 0.5);\r\n    }\r\n\r\n    /**\r\n     * Get vector with -1,0 values.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    static get left()\r\n    {\r\n        return new Vector3(-1, 0, 0);\r\n    }\r\n\r\n    /**\r\n     * Get vector with 1,0 values.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    static get right()\r\n    {\r\n        return new Vector3(1, 0, 0);\r\n    }\r\n\r\n    /**\r\n     * Get vector with 0,-1 values.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    static get up()\r\n    {\r\n        return new Vector3(0, -1, 0);\r\n    }\r\n\r\n    /**\r\n     * Get vector with 0,1 values.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    static get down()\r\n    {\r\n        return new Vector3(0, 1, 0);\r\n    }\r\n\r\n    /**\r\n     * Get vector with 0,0,-1 values.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    static get front()\r\n    {\r\n        return new Vector3(0, 0, -1);\r\n    }\r\n\r\n    /**\r\n     * Get vector with 0,0,1 values.\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    static get back()\r\n    {\r\n        return new Vector3(0, 0, 1);\r\n    }\r\n    \r\n    /**\r\n     * Calculate distance between this vector and another vectors.\r\n     * @param {Vector3} other Other vector.\r\n     * @returns {Number} Distance between vectors.\r\n     */\r\n    distanceTo(other)\r\n    {\r\n        return Vector3.distance(this, other);\r\n    }\r\n    \r\n    /**\r\n     * Lerp between two vectors.\r\n     * @param {Vector3} p1 First vector.\r\n     * @param {Vector3} p2 Second vector.\r\n     * @param {Number} a Lerp factor (0.0 - 1.0).\r\n     * @returns {Vector3} result vector.\r\n     */\r\n    static lerp(p1, p2, a)\r\n    {\r\n        let lerpScalar = MathHelper.lerp;\r\n        return new Vector3(lerpScalar(p1.x, p2.x, a), lerpScalar(p1.y, p2.y, a), lerpScalar(p1.z, p2.z, a));\r\n    }\r\n\r\n    /**\r\n     * Calculate distance between two vectors.\r\n     * @param {Vector3} p1 First vector.\r\n     * @param {Vector3} p2 Second vector.\r\n     * @returns {Number} Distance between vectors.\r\n     */\r\n    static distance(p1, p2)\r\n    {\r\n        let a = p1.x - p2.x;\r\n        let b = p1.y - p2.y;\r\n        let c = p1.z - p2.z;\r\n        return Math.sqrt(a*a + b*b + c*c);\r\n    }\r\n\r\n    /**\r\n     * Return cross product between two vectors.\r\n     * @param {Vector3} p1 First vector.\r\n     * @param {Vector3} p2 Second vector.\r\n     * @returns {Vector3} Crossed vector.\r\n     */\r\n    static crossVector(p1, p2)\r\n    {\r\n        const ax = p1.x, ay = p1.y, az = p1.z;\r\n\t\tconst bx = p2.x, by = p2.y, bz = p2.z;\r\n\r\n\t\tlet x = ay * bz - az * by;\r\n\t\tlet y = az * bx - ax * bz;\r\n\t\tlet z = ax * by - ay * bx;\r\n\r\n\t\treturn new Vector3(x, y, z);\r\n    }\r\n\r\n    /**\r\n     * Convert to string.\r\n     */\r\n    string()\r\n    {\r\n        return this.x + ',' + this.y + ',' + this.z;\r\n    }\r\n\r\n    /**\r\n     * Parse and return a vector object from string in the form of \"x,y\".\r\n     * @param {String} str String to parse.\r\n     * @returns {Vector3} Parsed vector.\r\n     */\r\n    static parse(str)\r\n    {\r\n        let parts = str.split(',');\r\n        return new Vector3(parseFloat(parts[0].trim()), parseFloat(parts[1].trim()), parseFloat(parts[2].trim()));\r\n    }\r\n\r\n    /**\r\n     * Convert to array of numbers.\r\n     * @returns {Array<Number>} Vector components as array.\r\n     */\r\n    toArray()\r\n    {\r\n        return [this.x, this.y, this.z];\r\n    }\r\n\r\n    /**\r\n     * Create vector from array of numbers.\r\n     * @param {Array<Number>} arr Array of numbers to create vector from.\r\n     * @returns {Vector3} Vector instance.\r\n     */\r\n    static fromArray(arr)\r\n    {\r\n        return new Vector3(arr[0], arr[1], arr[2]);\r\n    }\r\n\r\n    /**\r\n     * Create vector from a dictionary.\r\n     * @param {*} data Dictionary with {x,y,z}.\r\n     * @returns {Vector3} Newly created vector.\r\n     */\r\n    static fromDict(data)\r\n    {\r\n        return new Vector3(data.x || 0, data.y || 0, data.z || 0);\r\n    }\r\n\r\n    /**\r\n     * Convert to dictionary.\r\n     * @param {Boolean} minimized If true, will not include keys that their values are 0. You can use fromDict on minimized dicts.\r\n     * @returns {*} Dictionary with {x,y,z}\r\n     */\r\n    toDict(minimized)\r\n    {\r\n        if (minimized) {\r\n            const ret = {};\r\n            if (this.x) { ret.x = this.x; }\r\n            if (this.y) { ret.y = this.y; }\r\n            if (this.z) { ret.z = this.z; }\r\n            return ret;\r\n        }\r\n        return {x: this.x, y: this.y, z: this.z};\r\n    }\r\n}\r\n\r\n// export vector object\r\nmodule.exports = Vector3;", "/**\r\n * Implement an animator helper class.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\animator.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst _autoAnimators = [];\r\n\r\n\r\n/**\r\n * Implement an animator object that change values over time using Linear Interpolation.\r\n * Usage example:\r\n * (new Animator(sprite)).from({'position.x': 0}).to({'position.x': 100}).duration(1).play();\r\n */\r\nclass Animator\r\n{\r\n    /**\r\n     * Create the animator.\r\n     * @param {*} target Any object you want to animate.\r\n     */\r\n    constructor(target)\r\n    {\r\n        this._target = target;\r\n        this._fromValues = {};\r\n        this._toValues = {};\r\n        this._progress = 0;\r\n        this._onFinish = null;\r\n        this._smoothDamp = false;\r\n        this._repeats = false;\r\n        this._repeatsWithReverseAnimation = false;\r\n        this._isInAutoUpdate = false;\r\n        this._originalFrom = null;\r\n        this._originalTo = null;\r\n        this._originalRepeats = null;\r\n\r\n        /**\r\n         * Speed factor to multiply with delta every time this animator updates.\r\n         */\r\n        this.speedFactor = 1;\r\n    }\r\n\r\n    /**\r\n     * Update this animator with a given delta time.\r\n     * @param {Number} delta Delta time to progress this animator by.\r\n     */\r\n    update(delta)\r\n    {\r\n        // if already done, skip\r\n        if (this._progress >= 1) {\r\n            return;\r\n        }\r\n\r\n        // apply speed factor and update progress\r\n        delta *= this.speedFactor;\r\n        this._progress += delta;\r\n\r\n        // did finish?\r\n        if (this._progress >= 1) { \r\n\r\n            // make sure don't overflow\r\n            this._progress = 1; \r\n\r\n            // trigger finish method\r\n            if (this._onFinish) {\r\n                this._onFinish();\r\n            }\r\n        }\r\n\r\n        // update values\r\n        for (let key in this._toValues) {\r\n\r\n            // get key as parts and to-value\r\n            let keyParts = this._toValues[key].keyParts;\r\n            let toValue = this._toValues[key].value;\r\n\r\n            // get from value\r\n            let fromValue = this._fromValues[key];\r\n\r\n            // if from not set, get default\r\n            if (fromValue === undefined) {\r\n                this._fromValues[key] = fromValue = this._getValueFromTarget(keyParts);\r\n                if (fromValue === undefined) {\r\n                    throw new Error(`Animator issue: missing origin value for key '${key}' and property not found in target object.`);\r\n                }\r\n            }\r\n\r\n            // if to-value is a method, call it\r\n            if (typeof toValue === 'function') {\r\n                toValue = toValue();\r\n            }\r\n            \r\n            // if from-value is a method, call it\r\n            if (typeof fromValue === 'function') {\r\n                fromValue = toValue();\r\n            }\r\n\r\n            // get lerp factor\r\n            let a = (this._smoothDamp && this._progress < 1) ? (this._progress * (1 + 1 - this._progress)) : this._progress;\r\n\r\n            // calculate new value\r\n            let newValue = null;\r\n            if (typeof fromValue === 'number') {\r\n                newValue = lerp(fromValue, toValue, a);\r\n            }\r\n            else if (fromValue.constructor.lerp) {\r\n                newValue = fromValue.constructor.lerp(fromValue, toValue, a);\r\n            }\r\n            else {\r\n                throw new Error(`Animator issue: from-value for key '${key}' is not a number, and its class type don't implement a 'lerp()' method!`);\r\n            }\r\n\r\n            // set new value\r\n            this._setValueToTarget(keyParts, newValue);\r\n        }\r\n\r\n        // if repeating, reset progress\r\n        if (this._repeats && this._progress >= 1) {\r\n            if (typeof this._repeats === 'number') { this._repeats--; }\r\n            this._progress = 0;\r\n            if (this._repeatsWithReverseAnimation ) {\r\n                this.flipFromAndTo();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get value from target object.\r\n     * @private\r\n     * @param {Array<String>} keyParts Key parts broken by dots.\r\n     */\r\n    _getValueFromTarget(keyParts)\r\n    {\r\n        // easy case - get value when key parts is just one component\r\n        if (keyParts.length === 1) {\r\n            return this._target[keyParts[0]];\r\n        }\r\n\r\n        // get value for path with parts\r\n        function index(obj,i) {return obj[i]}\r\n        return keyParts.reduce(index, this._target);\r\n    }\r\n\r\n    /**\r\n     * Set value in target object.\r\n     * @private\r\n     * @param {Array<String>} keyParts Key parts broken by dots.\r\n     */\r\n     _setValueToTarget(keyParts, value)\r\n     {\r\n        // easy case - set value when key parts is just one component\r\n        if (keyParts.length === 1) {\r\n            this._target[keyParts[0]] = value;\r\n            return;\r\n        }\r\n\r\n        // set value for path with parts\r\n        function index(obj,i) {return obj[i]}\r\n        let parent = keyParts.slice(0, keyParts.length - 1).reduce(index, this._target);\r\n        parent[keyParts[keyParts.length - 1]] = value;\r\n     }\r\n\r\n    /**\r\n     * Make sure a given value is legal for the animator.\r\n     * @private\r\n     */\r\n    _validateValueType(value)\r\n    {\r\n        return (typeof value === 'number') || (typeof value === 'function') || (value && value.constructor && value.constructor.lerp);\r\n    }\r\n\r\n    /**\r\n     * Set a method to run when animation ends.\r\n     * @param {Function} callback Callback to invoke when done.\r\n     * @returns {Animator} this.\r\n     */\r\n    then(callback)\r\n    {\r\n        this._onFinish = callback;\r\n        return this;\r\n    }\r\n    \r\n    /**\r\n     * Set smooth damp.\r\n     * If true, lerping will go slower as the animation reach its ending.\r\n     * @param {Boolean} enable set smooth damp mode.\r\n     * @returns {Animator} this.\r\n     */\r\n    smoothDamp(enable)\r\n    {\r\n        this._smoothDamp = enable;\r\n        return this;\r\n    }\r\n        \r\n    /**\r\n     * Set if the animator should repeat itself.\r\n     * @param {Boolean|Number} enable false to disable repeating, true for endless repeats, or a number for limited number of repeats.\r\n     * @param {Boolean} reverseAnimation if true, it will reverse animation to repeat it instead of just \"jumping\" back to starting state.\r\n     * @returns {Animator} this.\r\n     */\r\n    repeats(enable, reverseAnimation)\r\n    {\r\n        this._originalRepeats = this._repeats = enable;\r\n        this._repeatsWithReverseAnimation = Boolean(reverseAnimation);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Set 'from' values.\r\n     * You don't have to provide 'from' values, when a value is not set the animator will just take whatever was set in target when first update is called.\r\n     * @param {*} values Values to set as 'from' values. \r\n     * Key = property name in target (can contain dots for nested), value = value to start animation from.\r\n     * @returns {Animator} this.\r\n     */\r\n    from(values)\r\n    {\r\n        for (let key in values) {\r\n            if (!this._validateValueType(values[key])) {\r\n                throw new Error(\"Illegal value type to use with Animator! All values must be either numbers, methods, or a class instance that has a static lerp() method.\");\r\n            }\r\n            this._fromValues[key] = values[key];\r\n        }\r\n        this._originalFrom = null;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Set 'to' values, ie the result when animation ends.\r\n     * @param {*} values Values to set as 'to' values. \r\n     * Key = property name in target (can contain dots for nested), value = value to start animation from.\r\n     * @returns {Animator} this.\r\n     */\r\n    to(values)\r\n    {\r\n        for (let key in values) {\r\n            if (!this._validateValueType(values[key])) {\r\n                throw new Error(\"Illegal value type to use with Animator! All values must be either numbers, methods, or a class instance that has a static lerp() method.\");\r\n            }\r\n            this._toValues[key] = {keyParts: key.split('.'), value: values[key]};\r\n        }\r\n        this._originalTo = null;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Flip between the 'from' and the 'to' states.\r\n     */\r\n    flipFromAndTo()\r\n    {\r\n        let newFrom = {};\r\n        let newTo = {};\r\n\r\n        if (!this._originalFrom) { this._originalFrom = this._fromValues; }\r\n        if (!this._originalTo) { this._originalTo = this._toValues; }\r\n\r\n        for (let key in this._toValues) {\r\n            newFrom[key] = this._toValues[key].value;\r\n            newTo[key] = {keyParts: key.split('.'), value: this._fromValues[key]};\r\n        }\r\n\r\n        this._fromValues = newFrom;\r\n        this._toValues = newTo;\r\n    }\r\n\r\n    /**\r\n     * Make this Animator update automatically with the gameTime delta time.\r\n     * Note: this will change the speedFactor property.\r\n     * @param {Number} seconds Animator duration time in seconds.\r\n     * @returns {Animator} this.\r\n     */\r\n    duration(seconds)\r\n    {\r\n        this.speedFactor = 1 / seconds;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Reset animator progress.\r\n     * @returns {Animator} this.\r\n     */\r\n    reset()\r\n    {\r\n        if (this._originalFrom) { this._fromValues = this._originalFrom; }\r\n        if (this._originalTo) { this._toValues = this._originalTo; }\r\n        if (this._originalRepeats !== null) { this._repeats = this._originalRepeats; }\r\n        this._progress = 0;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Make this Animator update automatically with the gameTime delta time, until its done.\r\n     * @returns {Animator} this.\r\n     */\r\n    play()\r\n    {\r\n        if (this._isInAutoUpdate) {\r\n            return;\r\n        }\r\n\r\n        _autoAnimators.push(this);\r\n        this._isInAutoUpdate = true;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Get if this animator finished.\r\n     * @returns {Boolean} True if animator finished.\r\n     */\r\n    get ended()\r\n    {\r\n        return this._progress >= 1;\r\n    }\r\n\r\n    /**\r\n     * Update all auto animators.\r\n     * @private\r\n     * @param {Number} delta Delta time in seconds.\r\n     */\r\n    static updateAutos(delta)\r\n    {\r\n        for (let i = _autoAnimators.length - 1; i >= 0; --i) {\r\n\r\n            _autoAnimators[i].update(delta);\r\n\r\n            if (_autoAnimators[i].ended) {\r\n                _autoAnimators[i]._isInAutoUpdate = false;\r\n                _autoAnimators.splice(i, 1);\r\n            }\r\n\r\n        }\r\n    }\r\n}\r\n\r\n\r\n// a simple lerp method\r\nfunction lerp(start, end, amt) {\r\n    return (1-amt)*start + amt*end;\r\n}\r\n\r\n\r\n// export the animator class.\r\nmodule.exports = Animator;", "/**\r\n * A utility to hold gametime.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\game_time.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\n \r\n/**\r\n * Class to hold current game time (elapse and deltatime).\r\n */\r\nclass GameTime\r\n{\r\n    /**\r\n     * create the gametime object with current time.\r\n     */\r\n    constructor()\r\n    {\r\n        /**\r\n         * Current timestamp\r\n         */\r\n        this.timestamp = _currElapsed;\r\n\r\n        /**\r\n         * Delta time struct.\r\n         * Contains: milliseconds, seconds.\r\n         */\r\n        this.deltaTime = {\r\n            milliseconds: _currDelta,\r\n            seconds: _currDelta / 1000.0,\r\n        };\r\n\r\n        /**\r\n         * Elapsed time struct.\r\n         * Contains: milliseconds, seconds.\r\n         */\r\n        this.elapsedTime = {\r\n            milliseconds: _currElapsed,\r\n            seconds: _currElapsed / 1000.0\r\n        };\r\n\r\n        /**\r\n         * Delta time, in seconds, since last frame.\r\n         */\r\n        this.delta = this.deltaTime ? this.deltaTime.seconds : null;\r\n\r\n        /**\r\n         * Total time, in seconds, since Shaku was initialized.\r\n         */\r\n        this.elapsed = this.elapsedTime.seconds;\r\n\r\n        // freeze object\r\n        Object.freeze(this);\r\n    }\r\n\r\n    /**\r\n     * Update game time.\r\n     */\r\n    static update()\r\n    {\r\n        // get current time\r\n        let curr = getAccurateTimestampMs();\r\n\r\n        // calculate delta time\r\n        let delta = 0;\r\n        if (_prevTime) {\r\n            delta = curr - _prevTime;\r\n        }\r\n\r\n        // update previous time\r\n        _prevTime = curr;\r\n\r\n        // update delta and elapsed\r\n        _currDelta = delta;\r\n        _currElapsed += delta;\r\n    }\r\n\r\n    /**\r\n     * Get raw timestamp in milliseconds.\r\n     * @returns {Number} raw timestamp in milliseconds.\r\n     */\r\n    static rawTimestamp()\r\n    {\r\n        return getAccurateTimestampMs();\r\n    }\r\n\r\n    /**\r\n     * Reset elapsed and delta time.\r\n     */\r\n    static reset()\r\n    {\r\n        _prevTime = null;\r\n        _currDelta = 0;\r\n        _currElapsed = 0;\r\n    }\r\n\r\n    /**\r\n     * Reset current frame's delta time.\r\n     */ \r\n    static resetDelta()\r\n    {\r\n        _prevTime = null;\r\n        _currDelta = 0;\r\n    }\r\n}\r\n\r\n// do we have the performance.now method?\r\nconst gotPerformance = (typeof performance !== 'undefined') && performance.now;\r\n\r\n// get most accurate timestamp in milliseconds.\r\nfunction getAccurateTimestampMs() {\r\n    if (gotPerformance) {\r\n        return performance.now();\r\n    }\r\n    return Date.now();\r\n}\r\n\r\n// previous time (to calculate delta).\r\nvar _prevTime = null;\r\n\r\n// current delta and elapsed\r\nvar _currDelta = 0;\r\nvar _currElapsed = 0;\r\n\r\n// export the GameTime class.\r\nmodule.exports = GameTime;", "/**\r\n * Implement a seeded random generator.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\seeded_random.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\n/**\r\n * Class to generate random numbers with seed.\r\n */\r\nclass SeededRandom\r\n{\r\n    /**\r\n     * Create the seeded random object.\r\n     * @param {Number} seed Seed to start from. If not provided, will use 0.\r\n     */\r\n    constructor(seed)\r\n    {\r\n        if (seed === undefined) { seed = 0; }\r\n        this.seed = seed;\r\n    }\r\n\r\n    /**\r\n     * Get next random value.\r\n     * @param {Number} min Optional min value. If max is not provided, this will be used as max.\r\n     * @param {Number} max Optional max value.\r\n     * @returns {Number} A randomly generated value.\r\n     */\r\n    random(min, max)\r\n    {\r\n        // generate next value\r\n        this.seed = (this.seed * 9301 + 49297) % 233280;\r\n        let rnd = this.seed / 233280;\r\n\r\n        // got min and max?\r\n        if (min && max) {\r\n            return min + rnd * (max - min);\r\n        }\r\n        // got only min (used as max)?\r\n        else if (min) {\r\n            return rnd * min;\r\n        }\r\n        // no min nor max provided\r\n        return rnd;\r\n    }\r\n    \r\n    /**\r\n     * Pick a random value from array.\r\n     * @param {Array} options Options to pick random value from.\r\n     * @returns {*} Random value from options array.\r\n     */\r\n    pick(options)\r\n    {\r\n        return options[Math.floor(this.random(options.length))];\r\n    }\r\n}\r\n\r\n// export the seeded random class.\r\nmodule.exports = SeededRandom;", "/**\r\n * Implements 2d perlin noise generator.\r\n * Based on code from noisejs by Stefan Gustavson.\r\n * https://github.com/josephg/noisejs/blob/master/perlin.js\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\perlin.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\n// import some utilities\r\nconst MathHelper = require(\"./math_helper\");\r\nconst lerp = MathHelper.lerp;\r\n\r\n// do fade\r\nfunction fade(t) {\r\n    return t*t*t*(t*(t*6-15)+10);\r\n}\r\n\r\n// store gradient value\r\nfunction Grad(x, y, z) {\r\n    this.x = x; this.y = y; this.z = z;\r\n}\r\nGrad.prototype.dot2 = function(x, y) {\r\n    return this.x*x + this.y*y;\r\n};\r\n\r\n// const premutations\r\nconst p = [151,160,137,91,90,15,\r\n131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,\r\n190, 6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,\r\n88,237,149,56,87,174,20,125,136,171,168, 68,175,74,165,71,134,139,48,27,166,\r\n77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,\r\n102,143,54, 65,25,63,161, 1,216,80,73,209,76,132,187,208, 89,18,169,200,196,\r\n135,130,116,188,159,86,164,100,109,198,173,186, 3,64,52,217,226,250,124,123,\r\n5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,\r\n223,183,170,213,119,248,152, 2,44,154,163, 70,221,153,101,155,167, 43,172,9,\r\n129,22,39,253, 19,98,108,110,79,113,224,232,178,185, 112,104,218,246,97,228,\r\n251,34,242,193,238,210,144,12,191,179,162,241, 81,51,145,235,249,14,239,107,\r\n49,192,214, 31,181,199,106,157,184, 84,204,176,115,121,50,45,127, 4,150,254,\r\n138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];\r\n\r\n\r\n/**\r\n * Generate 2d perlin noise.\r\n * Based on code from noisejs by Stefan Gustavson.\r\n * https://github.com/josephg/noisejs/blob/master/perlin.js\r\n */\r\nclass Perlin\r\n{\r\n    /**\r\n     * Create the perlin noise generator.\r\n     * @param {Number} seed Seed for perlin noise, or undefined for random.\r\n     */\r\n    constructor(seed)\r\n    {\r\n        if (seed === undefined) { seed = Math.random(); }\r\n        this.seed(seed);\r\n    }\r\n\r\n    /**\r\n     * Set the perlin noise seed.\r\n     * @param {Number} seed New seed value. May be either a decimal between 0 to 1, or an unsigned short between 0 to 65536.\r\n     */\r\n    seed(seed)\r\n    {\r\n        // scale the seed out\r\n        if(seed > 0 && seed < 1) {\r\n            seed *= 65536;\r\n        }\r\n    \r\n        // make sure round and current number of bits\r\n        seed = Math.floor(seed);\r\n        if (seed < 256) {\r\n            seed |= seed << 8;\r\n        }\r\n\r\n        // create perm, gradP and grad3 arrays\r\n        var perm = new Array(512);\r\n        var gradP = new Array(512);\r\n        var grad3 = [new Grad(1,1,0),new Grad(-1,1,0),new Grad(1,-1,0),new Grad(-1,-1,0),\r\n            new Grad(1,0,1),new Grad(-1,0,1),new Grad(1,0,-1),new Grad(-1,0,-1),\r\n            new Grad(0,1,1),new Grad(0,-1,1),new Grad(0,1,-1),new Grad(0,-1,-1)];\r\n    \r\n        // apply seed\r\n        for(var i = 0; i < 256; i++) \r\n        {\r\n            var v;\r\n            if (i & 1) {\r\n                v = p[i] ^ (seed & 255);\r\n            } else {\r\n                v = p[i] ^ ((seed>>8) & 255);\r\n            }\r\n    \r\n            perm[i] = perm[i + 256] = v;\r\n            gradP[i] = gradP[i + 256] = grad3[v % 12];\r\n        }\r\n\r\n        // store new params\r\n        this._perm = perm;\r\n        this._gradP = gradP;\r\n    }\r\n\r\n    /**\r\n     * Generate a perlin noise value for x,y coordinates.\r\n     * @param {Number} x X coordinate to generate perlin noise for.\r\n     * @param {Number} y Y coordinate to generate perlin noise for. \r\n     * @param {Number} blurDistance Distance to take neighbors to blur returned value with. Defaults to 0.25.\r\n     * @param {Number} contrast Optional contrast factor.\r\n     * @returns {Number} Perlin noise value for given point.\r\n     */\r\n    generateSmooth(x, y, blurDistance, contrast) \r\n    {\r\n        if (blurDistance === undefined) { \r\n            blurDistance = 0.25;\r\n        }\r\n        let a = this.generate(x-blurDistance, y-blurDistance, contrast);\r\n        let b = this.generate(x+blurDistance, y+blurDistance, contrast);\r\n        let c = this.generate(x-blurDistance, y+blurDistance, contrast);\r\n        let d = this.generate(x+blurDistance, y-blurDistance, contrast);\r\n        return (a + b + c + d) / 4;\r\n    }\r\n\r\n    /**\r\n     * Generate a perlin noise value for x,y coordinates.\r\n     * @param {Number} x X coordinate to generate perlin noise for.\r\n     * @param {Number} y Y coordinate to generate perlin noise for. \r\n     * @param {Number} contrast Optional contrast factor.\r\n     * @returns {Number} Perlin noise value for given point, ranged from 0 to 1.\r\n     */\r\n    generate(x, y, contrast) \r\n    {\r\n        // default contrast\r\n        if (contrast === undefined) {\r\n            contrast = 1;\r\n        }\r\n\r\n        // store new params\r\n        let perm = this._perm;\r\n        let gradP = this._gradP;\r\n\r\n        // find unit grid cell containing point\r\n        var X = Math.floor(x), Y = Math.floor(y);\r\n\r\n        // get relative xy coordinates of point within that cell\r\n        x = x - X; y = y - Y;\r\n\r\n        // wrap the integer cells at 255 (smaller integer period can be introduced here)\r\n        X = X & 255; Y = Y & 255;\r\n    \r\n        // calculate noise contributions from each of the four corners\r\n        var n00 = gradP[X+perm[Y]].dot2(x, y) * contrast;\r\n        var n01 = gradP[X+perm[Y+1]].dot2(x, y-1) * contrast;\r\n        var n10 = gradP[X+1+perm[Y]].dot2(x-1, y) * contrast;\r\n        var n11 = gradP[X+1+perm[Y+1]].dot2(x-1, y-1) * contrast;\r\n    \r\n        // compute the fade curve value for x\r\n        var u = fade(x);\r\n    \r\n        // interpolate the four results\r\n        return Math.min(lerp(\r\n            lerp(n00, n10, u),\r\n            lerp(n01, n11, u),\r\n            fade(y)) + 0.5, 1);\r\n    };\r\n}\r\n\r\n// export the perlin generator\r\nmodule.exports = Perlin;", "/**\r\n * Implement a storage adapter.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\storage_adapter.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\n\r\n/**\r\n * Storage adapter class that implement access to a storage device.\r\n * Used by the Storage utilitiy.\r\n */\r\nclass StorageAdapter\r\n{\r\n    /**\r\n     * Return if this storage adapter is persistent storage or not.\r\n     * @returns {Boolean} True if this storage type is persistent.\r\n     */\r\n    get persistent()\r\n    {\r\n        throw new Error(\"Not Implemented.\");\r\n    }\r\n\r\n    /**\r\n     * Check if this adapter is OK to be used.\r\n     * For example, an adapter for localStorage will make sure it exists and not null.\r\n     * @returns {Boolean} True if storage adapter is valid to be used.\r\n     */\r\n    isValid()\r\n    {\r\n        throw new Error(\"Not Implemented.\");\r\n    }\r\n\r\n    /**\r\n     * Check if a key exists.\r\n     * @param {String} key Key to check.\r\n     * @returns {Boolean} True if key exists in storage.\r\n     */\r\n    exists(key)\r\n    {\r\n        throw new Error(\"Not Implemented.\");\r\n    }\r\n\r\n    /**\r\n     * Set value.\r\n     * @param {String} key Key to set.\r\n     * @param {String} value Value to set.\r\n     */\r\n    setItem(key, value)\r\n    {\r\n        throw new Error(\"Not Implemented.\");\r\n    }\r\n\r\n    /**\r\n     * Get value.\r\n     * @param {String} key Key to get.\r\n     * @returns {String} Value or null if not set.\r\n     */\r\n    getItem(key)\r\n    {\r\n        throw new Error(\"Not Implemented.\");\r\n    }\r\n\r\n    /**\r\n     * Delete value.\r\n     * @param {String} key Key to delete.\r\n     */\r\n    deleteItem(key)\r\n    {\r\n        throw new Error(\"Not Implemented.\");\r\n    }\r\n    \r\n    /**\r\n     * Clear all values from this storage device.\r\n     * @param {String} prefix Storage keys prefix.\r\n     */\r\n    clear(prefix)\r\n    {\r\n        throw new Error(\"Not Implemented.\");\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Implement simple memory storage adapter.\r\n */\r\nclass StorageAdapterMemory\r\n{\r\n    /**\r\n     * Create the memory storage adapter.\r\n     */\r\n    constructor()\r\n    {\r\n        this._data = {};\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    get persistent()\r\n    {\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    isValid()\r\n    {\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    exists(key)\r\n    {\r\n        return Boolean(this._data[key]);\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    setItem(key, value)\r\n    {\r\n        this._data[key] = value;\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    getItem(key)\r\n    {\r\n        return this._data[key];\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    deleteItem(key)\r\n    {\r\n        delete this._data[key];\r\n    }\r\n    \r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    clear(prefix)\r\n    {\r\n        for (let key in this._data) {\r\n            if (key.indexOf(prefix) === 0) {\r\n                delete this._data[key];\r\n            }\r\n        }\r\n    }\r\n}\r\nStorageAdapter.memory = StorageAdapterMemory;\r\n\r\n\r\n/**\r\n * Implement simple localstorage storage adapter.\r\n */\r\nclass StorageAdapterLocalStorage\r\n{\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    get persistent()\r\n    {\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    isValid()\r\n    {\r\n        try {\r\n            return (typeof localStorage !== \"undefined\") && (localStorage !== null);\r\n        }\r\n        catch (e) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    exists(key)\r\n    {\r\n        return localStorage.getItem(key) !== null;\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    setItem(key, value)\r\n    {\r\n        localStorage.setItem(key, value);\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    getItem(key)\r\n    {\r\n        return localStorage.getItem(key);\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    deleteItem(key)\r\n    {\r\n        localStorage.deleteItem(key);\r\n    }\r\n    \r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    clear(prefix)\r\n    {\r\n        for (let i = 0; i < localStorage.length; i++) {\r\n            const key = localStorage.key(i);\r\n            if (key.indexOf(prefix) === 0) {\r\n                delete localStorage.deleteItem(key);\r\n            }\r\n        }\r\n    }\r\n}\r\nStorageAdapter.localStorage = StorageAdapterLocalStorage;\r\n\r\n\r\n/**\r\n * Implement simple sessionStorage storage adapter.\r\n */\r\nclass StorageAdapterSessionStorage\r\n{\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    get persistent()\r\n    {\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    isValid()\r\n    {\r\n        try {\r\n            return (typeof sessionStorage !== \"undefined\") && (sessionStorage !== null);\r\n        }\r\n        catch (e) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    exists(key)\r\n    {\r\n        return sessionStorage.getItem(key) !== null;\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    setItem(key, value)\r\n    {\r\n        sessionStorage.setItem(key, value);\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    getItem(key)\r\n    {\r\n        return sessionStorage.getItem(key);\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    deleteItem(key)\r\n    {\r\n        sessionStorage.deleteItem(key);\r\n    }\r\n    \r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    clear(prefix)\r\n    {\r\n        for (let i = 0; i < sessionStorage.length; i++) {\r\n            const key = sessionStorage.key(i);\r\n            if (key.indexOf(prefix) === 0) {\r\n                delete sessionStorage.deleteItem(key);\r\n            }\r\n        }\r\n    }\r\n}\r\nStorageAdapter.sessionStorage = StorageAdapterSessionStorage;\r\n\r\n\r\n// export the storage adapter class\r\nmodule.exports = StorageAdapter;", "/**\r\n * Implement a storage wrapper.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\storage.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst StorageAdapter = require(\"./storage_adapter\");\r\n\r\n\r\n/**\r\n * A thin wrapper layer around storage utility.\r\n */\r\nclass Storage\r\n{\r\n    /**\r\n     * Create the storage.\r\n     * @param {Array<StorageAdapter>} adapters List of storage adapters to pick from. Will use the first option returning 'isValid()' = true.\r\n     * @param {String} prefix Optional prefix to add to all keys under this storage instance.\r\n     * @param {Boolean} valuesAsBase64 If true, will encode and decode data as base64.\r\n     * @param {Boolean} keysAsBase64 If true, will encode and decode keys as base64.\r\n     */\r\n    constructor(adapters, prefix, valuesAsBase64, keysAsBase64)\r\n    {\r\n        // default adapters\r\n        adapters = adapters || Storage.defaultAdapters;\r\n\r\n        // default to array\r\n        if (!(adapters instanceof Array)) {\r\n            adapters = [adapters];\r\n        }\r\n\r\n        // choose adapter\r\n        this._adapter = null;\r\n        for (let adapter of adapters) {\r\n            if (adapter.isValid()) {\r\n                this._adapter = adapter;\r\n                break;\r\n            }\r\n        }\r\n\r\n        // set if should use base64\r\n        this.valuesAsBase64 = Boolean(valuesAsBase64);\r\n        this.keysAsBase64 = Boolean(keysAsBase64);\r\n\r\n        // set prefix\r\n        this._keysPrefix = 'shaku_storage_' + (prefix || '') + '_';\r\n    }\r\n\r\n    /**\r\n     * Return if this storage adapter is persistent storage or not.\r\n     * @returns {Boolean} True if this storage type is persistent.\r\n     */\r\n    get persistent()\r\n    {\r\n        return this.isValid && this._adapter.persistent;\r\n    }\r\n\r\n    /**\r\n     * Check if this storage instance has a valid adapter.\r\n     * @returns {Boolean} True if found a valid adapter to use, false otherwise.\r\n     */\r\n    get isValid()\r\n    {\r\n        return Boolean(this._adapter);\r\n    }\r\n\r\n    /**\r\n     * Convert key to string and add prefix if needed.\r\n     * @private\r\n     * @param {String} key Key to normalize.\r\n     * @returns {String} Normalized key.\r\n     */\r\n    normalizeKey(key)\r\n    {\r\n        key = this._keysPrefix + key.toString();\r\n        if (this.keysAsBase64) {\r\n            key = btoa(key);\r\n        }\r\n        return key;\r\n    }\r\n\r\n    /**\r\n     * Check if a key exists.\r\n     * @param {String} key Key to check.\r\n     * @returns {Boolean} True if key exists in storage.\r\n     */\r\n    exists(key)\r\n    {\r\n        if (typeof key !== 'string') { throw new Error(\"Key must be a string!\"); }\r\n        key = this.normalizeKey(key);\r\n        return this._adapter.exists(key);\r\n    }\r\n\r\n    /**\r\n     * Set value.\r\n     * @private\r\n     */\r\n    _set(key, value)\r\n    {\r\n        // json stringify\r\n        value = JSON.stringify({\r\n            data: value,\r\n            timestamp: (new Date()).getTime(),\r\n            src: \"Shaku\",\r\n            sver: 1.0\r\n        });\r\n\r\n        // convert to base64\r\n        if (this.valuesAsBase64) {\r\n            value = btoa(value);\r\n        }\r\n\r\n        // store value\r\n        this._adapter.setItem(key, value);\r\n    }\r\n\r\n    /**\r\n     * Get value.\r\n     * @private\r\n     */\r\n    _get(key)\r\n    {\r\n        // get value\r\n        var value = this._adapter.getItem(key);\r\n\r\n        // not found? return null\r\n        if (value === null) {\r\n            return null;\r\n        }\r\n\r\n        // convert from base64\r\n        if (this.valuesAsBase64) {\r\n            try {\r\n                value = atob(value);\r\n            }\r\n            catch (e) {\r\n                throw new Error(\"Failed to parse Base64 string while reading data. Did you try to read a value as Base64 that wasn't encoded as Base64 when written to storage?\");\r\n            }\r\n        }\r\n\r\n        // parse json\r\n        try {\r\n            value = JSON.parse(value);\r\n        }\r\n        catch (e) {\r\n            throw new Error(\"Failed to JSON-parse data from storage. Did you try to read something that wasn't written with the Storage utility?\");\r\n        }\r\n\r\n        // return value\r\n        return value.data;\r\n    }\r\n    \r\n    /**\r\n     * Set value.\r\n     * @param {String} key Key to set.\r\n     * @param {String} value Value to set.\r\n     */\r\n    setItem(key, value)\r\n    {\r\n        // sanity and normalize key\r\n        if (typeof key !== 'string') { throw new Error(\"Key must be a string!\"); }\r\n        key = this.normalizeKey(key);\r\n\r\n        // write value with metadata\r\n        this._set(key, value);\r\n    }\r\n\r\n    /**\r\n     * Get value.\r\n     * @param {String} key Key to get.\r\n     * @returns {String} Value or null if not set.\r\n     */\r\n    getItem(key)\r\n    {\r\n        // sanity and normalize key\r\n        if (typeof key !== 'string') { throw new Error(\"Key must be a string!\"); }\r\n        key = this.normalizeKey(key);\r\n\r\n        // read value from metadata\r\n        return this._get(key);\r\n    }\r\n\r\n    /**\r\n     * Get value and JSON parse it.\r\n     * @param {String} key Key to get.\r\n     * @returns {*} Value as a dictionary object or null if not set.\r\n     */\r\n    getJson(key)\r\n    {\r\n        return this.getItem(key) || null;\r\n    }\r\n\r\n    /**\r\n     * Set value as JSON.\r\n     * @param {String} key Key to set.\r\n     * @param {*} value Value to set as a dictionary.\r\n     */\r\n    setJson(key, value)\r\n    {\r\n        key = this.normalizeKey(key);\r\n        this._set(key, value);\r\n    }\r\n\r\n    /**\r\n     * Delete value.\r\n     * @param {String} key Key to delete.\r\n     */\r\n    deleteItem(key)\r\n    {\r\n        if (typeof key !== 'string') { throw new Error(\"Key must be a string!\"); }\r\n        key = this.normalizeKey(key);\r\n        this._adapter.deleteItem(key);\r\n    }\r\n    \r\n    /**\r\n     * Clear all values from this storage instance, based on prefix + adapter type.\r\n     */\r\n    clear()\r\n    {\r\n        this._adapter.clear(this._keysPrefix);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Default adapters to use when no adapters list is provided.\r\n */\r\nStorage.defaultAdapters = [new StorageAdapter.localStorage(), new StorageAdapter.sessionStorage(), new StorageAdapter.memory()];\r\n\r\n\r\n// export the storage class\r\nmodule.exports = Storage;", "/**\r\n * Provide a pathfinding algorithm.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\path_finder.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n*/\r\n'use strict';\r\nconst Vector2 = require(\"./vector2\");\r\n\r\n\r\n/**\r\n * Interface for a supported grid.\r\n */\r\nclass IGrid\r\n{\r\n    /**\r\n     * Check if a given tile is blocked from a given neihbor.\r\n     * @param {Vector2|Vector3} _from Source tile index.\r\n     * @param {Vector2|Vector3} _to Target tile index. Must be a neighbor of _from.\r\n     * @returns {Boolean} Can we travel from _from to _to?\r\n     */\r\n    isBlocked(_from, _to) { throw new Error(\"Not Implemented\"); }\r\n\r\n    /**\r\n     * Get the price to travel on a given tile.\r\n     * Should return 1 for \"normal\" traveling price, > 1 for expensive tile, and < 1 for a cheap tile to pass on.\r\n     * @param {Vector2|Vector3} _index Tile index.\r\n     * @returns {Number} Price factor to walk on.\r\n     */\r\n    getPrice(_index) { throw new Error(\"Not Implemented\"); }\r\n}\r\n\r\n\r\n/**\r\n * A path node.\r\n */\r\nclass Node\r\n{\r\n    constructor(position)\r\n    {\r\n        this.position = position;\r\n        this.gCost = 0;\r\n        this.hCost = 0;\r\n        this.parent = null;\r\n        this.price = 1;\r\n    }\r\n\r\n    get fCost()\r\n    {\r\n        return this.gCost + this.hCost;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Find a path between start to target.\r\n * @param {IGrid} grid Grid provider to check if tiles are blocked.\r\n * @param {Vector2|Vector3} startPos Starting tile index.\r\n * @param {Vector2|Vector3} targetPos Target tile index.\r\n * @param {*} options Additional options: { maxIterations, ignorePrices, allowDiagonal }\r\n * @returns {Array<Vector2>} List of tiles to traverse.\r\n */\r\nfunction findPath(grid, startPos, targetPos, options)\r\n{\r\n    let ret = _ImpFindPath(grid, startPos, targetPos, options || {});\r\n    return ret;\r\n}\r\n\r\n\r\n/**\r\n * Internal function that implements the path-finding algorithm.\r\n * @private\r\n */\r\nfunction _ImpFindPath(grid, startPos, targetPos, options)\r\n{\r\n    // do we allow diagonal tiles?\r\n    const allowDiagonal = options.allowDiagonal;\r\n\r\n    // get / create node\r\n    let nodesCache = {};\r\n    function getOrCreateNode(position) {\r\n\r\n        // get from cache\r\n        let key = (position.x + ',' + position.y);\r\n        if (nodesCache[key]) {\r\n            return nodesCache[key];\r\n        }\r\n\r\n        // create new\r\n        let ret = new Node(position);\r\n        nodesCache[key] = ret;\r\n        return ret;\r\n    }\r\n    \r\n    // create start and target node\r\n    let startNode = getOrCreateNode(startPos);\r\n    let targetNode = getOrCreateNode(targetPos);\r\n\r\n    // tiles we may still travel to\r\n    let openSet = [];\r\n    openSet.push(startNode);\r\n\r\n    // tiles we were blocked at\r\n    let closedSet = new Set();\r\n\r\n    // remove from array by value\r\n    function removeFromArray(arr, val) {\r\n        let index = arr.indexOf(val);\r\n        if (index !== -1) {\r\n            arr.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    // while we got open way to go...\r\n    let iterationsCount = -1;\r\n    while (openSet.length > 0)\r\n    {\r\n        // check iterations count\r\n        if (options.maxIterations) {\r\n            if (iterationsCount++ > options.maxIterations) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        // find optimal node to start from\r\n        let currentNode = openSet[0];\r\n        for (let i = 1; i < openSet.length; i++)\r\n        {\r\n            if ((openSet[i].fCost <= currentNode.fCost) && (openSet[i].hCost < currentNode.hCost))\r\n            {\r\n                currentNode = openSet[i];\r\n            }\r\n        }\r\n\r\n        // add current node to close set\r\n        removeFromArray(openSet, currentNode);\r\n        closedSet.add(currentNode);\r\n\r\n        // did we reach target? :D\r\n        if (currentNode == targetNode)\r\n        {\r\n            let finalPath = retracePath(startNode, targetNode);\r\n            return finalPath;\r\n        }\r\n\r\n        // get neighbor tiles\r\n        let neighbors = [];\r\n        for (let nx = -1; nx <= 1; nx++)\r\n        {\r\n            for (let ny = -1; ny <= 1; ny++)\r\n            {\r\n                if (nx === 0 && ny === 0) { continue; }\r\n                if (!allowDiagonal && (nx !== 0 && ny !== 0)) { continue; }\r\n                neighbors.push(getOrCreateNode({x: currentNode.position.x + nx, y: currentNode.position.y + ny, z: currentNode.position.z}));\r\n            }\r\n        }\r\n\r\n        // iterate neighbors\r\n        for (let neighbor of neighbors)\r\n        {\r\n            // skip if already passed or can't walk there\r\n            if (closedSet.has(neighbor) || grid.isBlocked(currentNode.position, neighbor.position)) {\r\n                continue;\r\n            }\r\n\r\n            // calc const and price to walk there\r\n            let price = (options.ignorePrices) ? 1 : grid.getPrice(neighbor.position);\r\n            let currStepCost = currentNode.gCost + getDistance(currentNode, neighbor) * price;\r\n\r\n            // update node price and add to open set\r\n            let isInOpenSet = (openSet.indexOf(neighbor) !== -1);\r\n            if (!isInOpenSet || (currStepCost < neighbor.gCost))\r\n            {\r\n                // update node price and parent\r\n                neighbor.gCost = currStepCost;\r\n                neighbor.hCost = getDistance(neighbor, targetNode);\r\n                neighbor.parent = currentNode;\r\n\r\n                // add to open set\r\n                if (!isInOpenSet) {\r\n                    openSet.push(neighbor);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // didn't find path\r\n    return null;\r\n}\r\n\r\n/**\r\n * Convert nodes structure with parents into a list of tile indices.\r\n * Go from end to start (for shortest path) and build list reversed.\r\n * @private\r\n */\r\nfunction retracePath(startNode, endNode)\r\n{\r\n    let path = [];\r\n    let currentNode = endNode;\r\n\r\n    while (currentNode !== startNode)\r\n    {\r\n        path.unshift(currentNode.position);\r\n        currentNode = currentNode.parent;\r\n    }\r\n\r\n    return path;\r\n}\r\n\r\n/**\r\n * Get distance between two points on grid.\r\n * This method is quick and dirty and takes diagonal into consideration.\r\n */\r\nfunction getDistance(pa, pb)\r\n{\r\n    let dx = (pa.position.x - pb.position.x);\r\n    let dy = (pa.position.y - pb.position.y);\r\n    return Math.sqrt(dx*dx + dy*dy);\r\n}\r\n\r\n\r\n// export main method and grid interface.\r\nconst PathFinder = {\r\n    findPath: findPath,\r\n    IGrid: IGrid\r\n};\r\nmodule.exports = PathFinder;", "/**\r\n * Transformation modes.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\transform_modes.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\n/**\r\n * Different ways we can combine local transformations with parent transformations.\r\n */\r\nconst TransformModes = {\r\n    \r\n    /**\r\n     * The vector or scalar will be relative to the entity's parent transformations, and the local axis will be rotated by the parent's rotation.\r\n     * For example, if we have an entity that renders a blue ball and a child entity that renders a red ball with offset of {100,0}, when we rotate the parent blue ball, the red ball will rotate around it, keeping a distance of 100 pixels. \r\n     */\r\n    Relative: 'relative',\r\n\r\n    /**\r\n     * The vector or scalar will be relative to the entity's parent transformations, but local axis will be constant.\r\n     * For example, if we have an entity that renders a blue ball and a child entity that renders a red ball with offset of {100,0}, no matter how we rotate the parent blue ball, the red ball will always keep offset of {100,0} from it, ie be rendered on its right. \r\n     */\r\n    AxisAligned: 'axis-aligned',\r\n\r\n    /**\r\n     * The vector or scalar will ignore any parent transformations.\r\n     * This means that the local transformations of the entity will always be its world transformations as well, no matter what it parent does.\r\n     */\r\n    Absolute: 'absolute'\r\n}\r\n\r\n\r\n// export the transform modes.\r\nmodule.exports = TransformModes;", "/**\r\n * Transformations object to store position, rotation and scale, that also support transformations inheritance.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\transformation.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst MathHelper = require(\"./math_helper\");\r\nconst TransformModes = require(\"./transform_modes\");\r\nconst Matrix = require(\"../gfx/matrix\");\r\nconst Vector2 = require(\"./vector2\");\r\n\r\n// some default values\r\nconst _defaults = {};\r\n_defaults.position = Vector2.zero;\r\n_defaults.positionMode = TransformModes.Relative;\r\n_defaults.scale = Vector2.one;\r\n_defaults.scaleMode = TransformModes.AxisAligned;\r\n_defaults.rotation = 0;\r\n_defaults.rotationMode = TransformModes.Relative;\r\n\r\n\r\n/**\r\n * Transformations helper class to store 2d position, rotation and scale.\r\n * Can also perform transformations inheritance, where we combine local with parent transformations.\r\n * \r\n * @example\r\n * // create local and world transformations\r\n * const transform = new Shaku.utils.Transformation();\r\n * const worldTransform = new Shaku.utils.Transformation();\r\n * // set offset to world transofm and rotation to local transform\r\n * worldTransform.setPosition({x: 100, y:50});\r\n * transform.setRotation(5);\r\n * // combine transformations and convert to a matrix\r\n * const combined = Shaku.utils.Transformation.combine(transform, worldTransform);\r\n * const matrix = combined.asMatrix();\r\n */\r\nclass Transformation\r\n{\r\n    /**\r\n     * Create the transformations.\r\n     * @param {Vector2} position Optional position value.\r\n     * @param {Number} rotation Optional rotation value.\r\n     * @param {Vector2} scale Optional sscale value.\r\n     */\r\n    constructor(position, rotation, scale)\r\n    {\r\n        /**\r\n         * @private\r\n         * Transformation local position.\r\n         * @name Transformation#position\r\n         * @type {Vector2}\r\n         */\r\n        this._position = position || _defaults.position.clone();\r\n        \r\n        /**\r\n         * @private\r\n         * Position transformation mode.\r\n         * @name Transformation#positionMode\r\n         * @type {TransformModes}\r\n         */\r\n        this._positionMode = _defaults.positionMode;\r\n\r\n        /**\r\n         * @private\r\n         * Transformation local scale.\r\n         * @name Transformation#scale\r\n         * @type {Vector2}\r\n         */\r\n        this._scale = scale || _defaults.scale.clone();\r\n\r\n        /**\r\n         * @private\r\n         * Scale transformation mode.\r\n         * @name Transformation#scaleMode\r\n         * @type {TransformModes}\r\n         */\r\n        this._scaleMode = _defaults.scaleMode;\r\n\r\n        /**\r\n         * @private\r\n         * Transformation local rotation.\r\n         * @name Transformation#rotation\r\n         * @type {Number}\r\n         */\r\n        this._rotation = rotation || _defaults.rotation;\r\n\r\n        /**\r\n         * @private\r\n         * Rotation transformation mode.\r\n         * @name Transformation#rotationMode\r\n         * @type {TransformModes}\r\n         */\r\n        this._rotationMode = _defaults.rotationMode;\r\n\r\n        /**\r\n         * Method to call when this transformation change.\r\n         * Function params: transformation instance (this), properties changed (boolean), transform modes changed (boolean).\r\n         * @name Transformation#onChange\r\n         * @type {Function}\r\n         */\r\n        this.onChange = null;\r\n    }\r\n\r\n    /**\r\n     * Get position.\r\n     * @returns {Vector2} Position.\r\n     */\r\n    getPosition()\r\n    {\r\n        return this._position.clone();\r\n    }\r\n\r\n    /**\r\n     * Get position transformations mode.\r\n     * @returns {TransformModes} Position transformation mode.\r\n     */\r\n    getPositionMode()\r\n    {\r\n        return this._positionMode;\r\n    }\r\n\r\n    /**\r\n     * Set position.\r\n     * @param {Vector2} value New position.\r\n     * @returns {Transformation} this.\r\n     */\r\n    setPosition(value)\r\n    {\r\n        if (this._position.equals(value)) { return; }\r\n        this._position.copy(value);\r\n        this._markDirty(true, false);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Set position X value.\r\n     * @param {Number} value New position.x value.\r\n     * @returns {Transformation} this.\r\n     */\r\n    setPositionX(value)\r\n    {\r\n        if (this._position.x === value) { return; }\r\n        this._position.x = value;\r\n        this._markDirty(true, false);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Set position Y value.\r\n     * @param {Number} value New position.y value.\r\n     * @returns {Transformation} this.\r\n     */\r\n    setPositionY(value)\r\n    {\r\n        if (this._position.y === value) { return; }\r\n        this._position.y = value;\r\n        this._markDirty(true, false);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Move position by a given vector.\r\n     * @param {Vector2} value Vector to move position by.\r\n     * @returns {Transformation} this.\r\n     */\r\n    move(value)\r\n    {\r\n        this._position.addSelf(value);\r\n        this._markDirty(true, false);\r\n        return this;\r\n    }\r\n    \r\n    /**\r\n     * Set position transformations mode.\r\n     * @param {TransformModes} value Position transformation mode.\r\n     * @returns {Transformation} this.\r\n     */\r\n    setPositionMode(value)\r\n    {\r\n        if (this._positionMode === value) { return; }\r\n        this._positionMode = value;\r\n        this._markDirty(false, true);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Get scale.\r\n     * @returns {Vector2} Scale.\r\n     */\r\n    getScale()\r\n    {\r\n        return this._scale.clone();\r\n    }\r\n\r\n    /**\r\n     * Get scale transformations mode.\r\n     * @returns {TransformModes} Scale transformation mode.\r\n     */\r\n    getScaleMode()\r\n    {\r\n        return this._scaleMode;\r\n    }\r\n\r\n    /**\r\n     * Set scale.\r\n     * @param {Vector2} value New scale.\r\n     * @returns {Transformation} this.\r\n     */\r\n    setScale(value)\r\n    {\r\n        if (this._scale.equals(value)) { return; }\r\n        this._scale.copy(value);\r\n        this._markDirty(true, false);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Set scale X value.\r\n     * @param {Number} value New scale.x value.\r\n     * @returns {Transformation} this.\r\n     */\r\n    setScaleX(value)\r\n    {\r\n        if (this._scale.x === value) { return; }\r\n        this._scale.x = value;\r\n        this._markDirty(true, false);\r\n        return this;\r\n    }\r\n    \r\n    /**\r\n     * Set scale Y value.\r\n     * @param {Number} value New scale.y value.\r\n     * @returns {Transformation} this.\r\n     */\r\n    setScaleY(value)\r\n    {\r\n        if (this._scale.y === value) { return; }\r\n        this._scale.y = value;\r\n        this._markDirty(true, false);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Scale by a given vector.\r\n     * @param {Vector2} value Vector to scale by.\r\n     * @returns {Transformation} this.\r\n     */\r\n    scale(value)\r\n    {\r\n        this._scale.mulSelf(value);\r\n        this._markDirty(true, false);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Set scale transformations mode.\r\n     * @param {TransformModes} value Scale transformation mode.\r\n     * @returns {Transformation} this.\r\n     */\r\n    setScaleMode(value)\r\n    {\r\n        if (this._scaleMode === value) { return; }\r\n        this._scaleMode = value;\r\n        this._markDirty(false, true);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Get rotation.\r\n     * @returns {Number} rotation.\r\n     */\r\n    getRotation()\r\n    {\r\n        return this._rotation;\r\n    }\r\n    \r\n    /**\r\n     * Get rotation as degrees.\r\n     * @returns {Number} rotation.\r\n     */\r\n    getRotationDegrees()\r\n    {\r\n        return MathHelper.toDegrees(this._rotation);\r\n    }\r\n\r\n    /**\r\n     * Get rotation as degrees, wrapped between 0 to 360.\r\n     * @returns {Number} rotation.\r\n     */\r\n    getRotationDegreesWrapped()\r\n    {\r\n        let ret = this.getRotationDegrees();\r\n        return MathHelper.wrapDegrees(ret);\r\n    }\r\n\r\n    /**\r\n     * Get rotation transformations mode.\r\n     * @returns {TransformModes} Rotation transformations mode.\r\n     */\r\n    getRotationMode()\r\n    {\r\n        return this._rotationMode;\r\n    }\r\n\r\n    /**\r\n     * Set rotation.\r\n     * @param {Number} value New rotation.\r\n     * @param {Boolean} wrap If true, will wrap value if out of possible range.\r\n     * @returns {Transformation} this.\r\n     */\r\n    setRotation(value, wrap)\r\n    {\r\n        if (this._rotation === value) { return; }\r\n        this._rotation = value;\r\n        if (wrap && ((this._rotation < 0) || (this._rotation > (Math.PI * 2)))) {\r\n            this._rotation = Math.atan2(Math.sin(this._rotation), Math.cos(this._rotation));\r\n        }\r\n        this._markDirty(true, false);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Rotate transformation by given radians.\r\n     * @param {Number} value Rotate value in radians.\r\n     * @param {Boolean} wrap If true, will wrap value if out of possible range.\r\n     * @returns {Transformation} this.\r\n     */\r\n    rotate(value, wrap)\r\n    {\r\n        this.setRotation(this._rotation + value, wrap);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Set rotation as degrees.\r\n     * @param {Number} value New rotation.\r\n     * @param {Boolean} wrap If true, will wrap value if out of possible range.\r\n     * @returns {Transformation} this.\r\n     */\r\n    setRotationDegrees(value, wrap)\r\n    {\r\n        const rads = MathHelper.toRadians(value, wrap);\r\n        return this.setRotation(rads);\r\n    }\r\n\r\n    /**\r\n     * Rotate transformation by given degrees.\r\n     * @param {Number} value Rotate value in degrees.\r\n     * @returns {Transformation} this.\r\n     */\r\n    rotateDegrees(value)\r\n    {\r\n        this._rotation += MathHelper.toRadians(value);\r\n        this._markDirty(true, false);\r\n        return this;\r\n    }\r\n        \r\n    /**\r\n     * Set rotation transformations mode.\r\n     * @param {TransformModes} value Rotation transformation mode.\r\n     * @returns {Transformation} this.\r\n     */\r\n    setRotationMode(value)\r\n    {\r\n        if (this._rotationMode === value) { return; }\r\n        this._rotationMode = value;\r\n        this._markDirty(false, true);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Notify about changes in values.\r\n     * @param {Boolean} localTransform Local transformations changed. \r\n     * @param {Boolean} transformationModes Transformation modes changed.\r\n     */\r\n    _markDirty(localTransform, transformationModes)\r\n    {\r\n        this._matrix = null;\r\n        if (this.onChange) {\r\n            this.onChange(this, localTransform, transformationModes);\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Check if this transformation equals another.\r\n     * @param {Transformation} other Other transform to compare to.\r\n     * @returns {Boolean} True if equal, false otherwise.\r\n     */\r\n    equals(other)\r\n    {\r\n        return  (this._rotation === other._rotation) && \r\n                (this._position.equals(other._position)) && \r\n                (this._scale.equals(other._scale));\r\n    }\r\n\r\n    /**\r\n     * Return a clone of this transformations.\r\n     * @returns {Transformation} Cloned transformations.\r\n     */\r\n    clone()\r\n    {\r\n        // create cloned transformation\r\n        const ret = new Transformation(this._position.clone(), this._rotation, this._scale.clone());\r\n\r\n        // copy transformation modes\r\n        ret._rotationMode = this._rotationMode;\r\n        ret._positionMode = this._positionMode;\r\n        ret._scaleMode = this._scaleMode;\r\n        \r\n        // clone matrix\r\n        ret._matrix = this._matrix;\r\n\r\n        // return clone\r\n        return ret;\r\n    }\r\n\r\n    /**\r\n     * Serialize this transformation into a dictionary.\r\n     */\r\n    serialize()\r\n    {\r\n        const ret = {};\r\n\r\n        // position + mode\r\n        if (!this._position.equals(_defaults.position)) {\r\n            ret.pos = this._position;\r\n        }\r\n        if (this._positionMode !== _defaults.positionMode) {\r\n            ret.posm = this._positionMode;\r\n        }\r\n\r\n        // scale + mode\r\n        if (!this._scale.equals(_defaults.scale)) {\r\n            ret.scl = this._scale;\r\n        }\r\n        if (this._scaleMode !== _defaults.scaleMode) {\r\n            ret.sclm = this._scaleMode;\r\n        }\r\n\r\n        // rotation + mode\r\n        if (this._rotation !== _defaults.rotation) {\r\n            ret.rot = Math.floor(MathHelper.toDegrees(this._rotation));\r\n        }\r\n        if (this._rotationMode !== _defaults.rotationMode) {\r\n            ret.rotm = this._rotationMode;\r\n        }\r\n\r\n        return ret;\r\n    }\r\n\r\n    /**\r\n     * Deserialize this transformation from a dictionary.\r\n     * @param {*} data Data to set.\r\n     */\r\n    deserialize(data)\r\n    {\r\n        this._position.copy(data.pos || _defaults.position);\r\n        this._scale.copy(data.scl || _defaults.scale);\r\n        this._rotation = MathHelper.toRadians(data.rot || _defaults.rotation);\r\n        this._positionMode = data.posm || _defaults.positionMode;\r\n        this._scaleMode = data.sclm || _defaults.scaleMode;\r\n        this._rotationMode = data.rotm || _defaults.rotationMode;\r\n        this._markDirty(true, true);\r\n    }\r\n    \r\n    /**\r\n     * Create and return a transformation matrix.\r\n     * @returns {Matrix} New transformation matrix.\r\n     */\r\n    asMatrix()\r\n    {\r\n        // return cached\r\n        if (this._matrix) {\r\n            return this._matrix;\r\n        }\r\n\r\n        // get matrix type and create list of matrices to combine\r\n        let matrices = [];\r\n\r\n        // apply position\r\n        if ((this._position.x !== 0) || (this._position.y !== 0)) \r\n        { \r\n            matrices.push(Matrix.translate(this._position.x, this._position.y, 0));\r\n        }\r\n        \r\n        // apply rotation\r\n        if (this._rotation) \r\n        { \r\n            matrices.push(Matrix.rotateZ(-this._rotation));\r\n        }\r\n        \r\n        // apply scale\r\n        if ((this._scale.x !== 1) || (this._scale.y !== 1)) \r\n        { \r\n            matrices.push(Matrix.scale(this._scale.x, this._scale.y));\r\n        }\r\n\r\n        // no transformations? identity matrix\r\n        if (matrices.length === 0) { \r\n            this._matrix = Matrix.identity; \r\n        }\r\n        // only one transformation? return it\r\n        else if (matrices.length === 1) { \r\n            this._matrix = matrices[0]; \r\n        }\r\n        // more than one transformation? combine matrices\r\n        else { \r\n            this._matrix = Matrix.multiplyMany(matrices); \r\n        }\r\n\r\n        // return matrix\r\n        return this._matrix;\r\n    }\r\n\r\n    /**\r\n     * Combine child transformations with parent transformations.\r\n     * @param {Transformation} child Child transformations.\r\n     * @param {Transformation} parent Parent transformations.\r\n     * @returns {Transformation} Combined transformations.\r\n     */\r\n    static combine(child, parent)\r\n    {\r\n        var position = combineVector(child._position, parent._position, parent, child._positionMode);\r\n        var scale = combineVectorMul(child._scale, parent._scale, parent, child._scaleMode);\r\n        var rotation = combineScalar(child._rotation, parent._rotation, parent, child._rotationMode);\r\n        return new Transformation(position, rotation, scale);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Combine child scalar value with parent using a transformation mode.\r\n * @param {Number} childValue Child value. \r\n * @param {Number} parentValue Parent value.\r\n * @param {Transformation} parent Parent transformations.\r\n * @param {TransformModes} mode Transformation mode. \r\n * @returns {Number} Combined value.\r\n */\r\nfunction combineScalar(childValue, parentValue, parent, mode)\r\n{\r\n    switch (mode)\r\n    {\r\n        case TransformModes.Absolute:\r\n            return childValue;\r\n\r\n        case TransformModes.AxisAligned:\r\n        case TransformModes.Relative:\r\n            return parentValue + childValue;\r\n\r\n        default:\r\n            throw new Error(\"Unknown transform mode!\");\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Combine child vector value with parent using a transformation mode.\r\n * @param {Vector2} childValue Child value. \r\n * @param {Vector2} parentValue Parent value.\r\n * @param {Transformation} parent Parent transformations.\r\n * @param {TransformModes} mode Transformation mode.\r\n * @returns {Vector2} Combined value.\r\n */\r\nfunction combineVector(childValue, parentValue, parent, mode)\r\n{\r\n    switch (mode)\r\n    {\r\n        case TransformModes.Absolute:\r\n            return childValue.clone();\r\n\r\n        case TransformModes.AxisAligned:\r\n            return parentValue.add(childValue);\r\n\r\n        case TransformModes.Relative:\r\n            return parentValue.add(childValue.rotatedRadians(parent._rotation));\r\n\r\n        default:\r\n            throw new Error(\"Unknown transform mode!\");\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Combine child vector value with parent using a transformation mode and multiplication.\r\n * @param {Vector2} childValue Child value. \r\n * @param {Vector2} parentValue Parent value.\r\n * @param {Transformation} parent Parent transformations.\r\n * @param {TransformModes} mode Transformation mode.\r\n * @returns {Vector2} Combined value.\r\n */\r\nfunction combineVectorMul(childValue, parentValue, parent, mode)\r\n{\r\n    switch (mode)\r\n    {\r\n        case TransformModes.Absolute:\r\n            return childValue.clone();\r\n\r\n        case TransformModes.AxisAligned:\r\n            return parentValue.mul(childValue);\r\n\r\n        case TransformModes.Relative:\r\n            return parentValue.mul(childValue.rotatedRadians(parent._rotation));\r\n\r\n        default:\r\n            throw new Error(\"Unknown transform mode!\");\r\n    }\r\n}\r\n\r\n\r\n// export the transformation object\r\nmodule.exports = Transformation;", "/**\r\n * Include all util classes.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\utils\\index.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\n\r\n module.exports = {\r\n    Vector2: require('./vector2'),\r\n    Vector3: require('./vector3'),\r\n    Rectangle: require('./rectangle'),\r\n    Circle: require('./circle'),\r\n    Line: require('./line'),\r\n    Color: require('./color'),\r\n    Animator: require('./animator'),\r\n    GameTime: require('./game_time'),\r\n    MathHelper: require('./math_helper'),\r\n    SeededRandom: require('./seeded_random'),\r\n    Perlin: require('./perlin'),\r\n    Storage: require('./storage'),\r\n    StorageAdapter: require('./storage_adapter'),\r\n    PathFinder: require('./path_finder'),\r\n    Transformation: require('./transformation'),\r\n    TransformationModes: require('./transform_modes')\r\n };", "/**\r\n * Implement the gfx vertex container.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\vertex.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst { Vector2, Color } = require(\"../utils\");\r\nconst Matrix = require(\"./matrix\");\r\n\r\n/**\r\n * A vertex we can push to sprite batch.\r\n */\r\nclass Vertex\r\n{\r\n    /**\r\n     * Create the vertex data.\r\n     * @param {Vector2|Vector3} position Vertex position.\r\n     * @param {Vector2} textureCoord Vertex texture coord (in pixels).\r\n     * @param {Color} color Vertex color (undefined will default to white).\r\n     */\r\n    constructor(position, textureCoord, color)\r\n    {\r\n        this.position = position || Vector2.zero;\r\n        this.textureCoord = textureCoord || Vector2.zero;\r\n        this.color = color || Color.white;\r\n    }\r\n\r\n    /**\r\n     * Transform this vertex position from a matrix.\r\n     * @param {Matrix} matrix Transformation matrix.\r\n     * @returns {Vertex} this.\r\n     */\r\n    transform(matrix)\r\n    {\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Set position.\r\n     * @param {Vector2|Vector3} position Vertex position.\r\n     * @returns {Vertex} this.\r\n     */\r\n    setPosition(position)\r\n    {\r\n        this.position = position.clone();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Set texture coordinates.\r\n     * @param {Vector2} textureCoord Vertex texture coord (in pixels).\r\n     * @returns {Vertex} this.\r\n     */\r\n    setTextureCoords(textureCoord)\r\n    {\r\n        this.textureCoord = textureCoord.clone();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Set vertex color.\r\n     * @param {Color} color Vertex color.\r\n     * @returns {Vertex} this.\r\n     */\r\n    setColor(color)\r\n    {\r\n        this.color = color.clone();\r\n        return this;\r\n    }\r\n}\r\n\r\n// export the vertex class\r\nmodule.exports = Vertex;", "/**\r\n * Matrix class.\r\n * Based on code from https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Matrix_math_for_the_web\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\matrix.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst Vector2 = require(\"../utils/vector2\");\r\nconst Vertex = require(\"./vertex\");\r\n\r\n/**\r\n * Implements a matrix.\r\n */\r\nclass Matrix\r\n{\r\n    /**\r\n     * Create the matrix.\r\n     * @param values matrix values array.\r\n     * @param cloneValues if true or undefined, will clone values instead of just holding a reference to them.\r\n     */\r\n    constructor(values, cloneValues)\r\n    {\r\n        // if no values are set, use identity\r\n        if (!values) {\r\n            values = Matrix.identity.values;\r\n        }\r\n\r\n        // clone values\r\n        if (cloneValues || cloneValues === undefined) {\r\n            this.values = values.slice(0);\r\n        }\r\n        // copy values reference\r\n        else {\r\n            this.values = values;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set the matrix values.\r\n     */\r\n    set(v11, v12, v13, v14, v21, v22, v23, v24, v31, v32, v33, v34, v41, v42, v43, v44)\r\n    {\r\n        this.values = new Float32Array([ v11, v12, v13, v14,\r\n                        v21, v22, v23, v24,\r\n                        v31, v32, v33, v34,\r\n                        v41, v42, v43, v44\r\n                    ]);\r\n    }\r\n\r\n    /**\r\n     * Clone the matrix.\r\n     * @returns {Matrix} Cloned matrix.\r\n     */\r\n    clone()\r\n    {\r\n        let ret = new Matrix(this.values, true);\r\n        return ret;\r\n    }\r\n    \r\n    /**\r\n     * Compare this matrix to another matrix.\r\n     * @param {Matrix} other Matrix to compare to.\r\n     * @returns {Boolean} If matrices are the same.\r\n     */\r\n    equals(other)\r\n    {\r\n        if (other === this) { return true; }\r\n        if (!other) { return false; }\r\n        for (let i = 0; i < this.values.length; ++i) {\r\n            if (this.values[i] !== other.values[i]) { return false; }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Create an orthographic projection matrix.\r\n     * @returns {Matrix} a new matrix with result.\r\n     */\r\n    static orthographic(left, right, bottom, top, near, far) \r\n    {\r\n        return new Matrix([\r\n          2 / (right - left), 0, 0, 0,\r\n          0, 2 / (top - bottom), 0, 0,\r\n          0, 0, 2 / (near - far), 0,\r\n     \r\n          (left + right) / (left - right),\r\n          (bottom + top) / (bottom - top),\r\n          (near + far) / (near - far),\r\n          1,\r\n        ], false);\r\n    }\r\n\r\n    /**\r\n     * Create a perspective projection matrix.\r\n     * @returns {Matrix} a new matrix with result.\r\n     */\r\n    static perspective(fieldOfViewInRadians, aspectRatio, near, far) \r\n    {\r\n        var f = 1.0 / Math.tan(fieldOfViewInRadians / 2);\r\n        var rangeInv = 1 / (near - far);\r\n      \r\n        return new Matrix([\r\n          f / aspectRatio, 0,                          0,   0,\r\n          0,               f,                          0,   0,\r\n          0,               0,    (near + far) * rangeInv,  -1,\r\n          0,               0,  near * far * rangeInv * 2,   0\r\n        ], false);\r\n    }\r\n\r\n    /**\r\n     * Create a translation matrix.\r\n     * @returns {Matrix} a new matrix with result.\r\n     */\r\n    static translate(x, y, z)\r\n    {\r\n        return new Matrix([\r\n            1,          0,          0,          0,\r\n            0,          1,          0,          0,\r\n            0,          0,          1,          0,\r\n            x || 0,     y || 0,     z || 0,     1\r\n        ], false);\r\n    }\r\n\r\n    /**\r\n     * Create a scale matrix.\r\n     * @returns {Matrix} a new matrix with result.\r\n     */\r\n    static scale(x, y, z)\r\n    {\r\n        return new Matrix([\r\n            x || 1,         0,              0,              0,\r\n            0,              y || 1,         0,              0,\r\n            0,              0,              z || 1,         0,\r\n            0,              0,              0,              1\r\n        ], false);\r\n    }\r\n    \r\n    /**\r\n     * Create a rotation matrix around X axis.\r\n     * @returns {Matrix} a new matrix with result.\r\n     */\r\n    static rotateX(a)\r\n    {\r\n        let sin = Math.sin;\r\n        let cos = Math.cos;\r\n        return new Matrix([\r\n            1,       0,        0,     0,\r\n            0,  cos(a),  -sin(a),     0,\r\n            0,  sin(a),   cos(a),     0,\r\n            0,       0,        0,     1\r\n        ], false);\r\n    }\r\n        \r\n    /**\r\n     * Create a rotation matrix around Y axis.\r\n     * @returns {Matrix} a new matrix with result.\r\n     */\r\n    static rotateY(a)\r\n    {\r\n        let sin = Math.sin;\r\n        let cos = Math.cos;\r\n        return new Matrix([\r\n             cos(a),   0, sin(a),   0,\r\n                  0,   1,      0,   0,\r\n            -sin(a),   0, cos(a),   0,\r\n                  0,   0,      0,   1\r\n        ], false);\r\n    }\r\n        \r\n    /**\r\n     * Create a rotation matrix around Z axis.\r\n     * @returns {Matrix} a new matrix with result.\r\n     */\r\n    static rotateZ(a)\r\n    {\r\n        let sin = Math.sin;\r\n        let cos = Math.cos;\r\n        return new Matrix([\r\n            cos(a), -sin(a),    0,    0,\r\n            sin(a),  cos(a),    0,    0,\r\n                0,       0,    1,    0,\r\n                0,       0,    0,    1\r\n        ], false);\r\n    }\r\n    \r\n    /**\r\n     * Multiply two matrices. \r\n     * @returns {Matrix} a new matrix with result.\r\n     */\r\n    static multiply(matrixA, matrixB) \r\n    {\r\n        // Slice the second matrix up into rows\r\n        let row0 = [matrixB.values[ 0], matrixB.values[ 1], matrixB.values[ 2], matrixB.values[ 3]];\r\n        let row1 = [matrixB.values[ 4], matrixB.values[ 5], matrixB.values[ 6], matrixB.values[ 7]];\r\n        let row2 = [matrixB.values[ 8], matrixB.values[ 9], matrixB.values[10], matrixB.values[11]];\r\n        let row3 = [matrixB.values[12], matrixB.values[13], matrixB.values[14], matrixB.values[15]];\r\n      \r\n        // Multiply each row by matrixA\r\n        let result0 = multiplyMatrixAndPoint(matrixA.values, row0);\r\n        let result1 = multiplyMatrixAndPoint(matrixA.values, row1);\r\n        let result2 = multiplyMatrixAndPoint(matrixA.values, row2);\r\n        let result3 = multiplyMatrixAndPoint(matrixA.values, row3);\r\n      \r\n        // Turn the result rows back into a single matrix\r\n        return new Matrix([\r\n          result0[0], result0[1], result0[2], result0[3],\r\n          result1[0], result1[1], result1[2], result1[3],\r\n          result2[0], result2[1], result2[2], result2[3],\r\n          result3[0], result3[1], result3[2], result3[3]\r\n        ], false);\r\n    }\r\n\r\n    /**\r\n     * Multiply an array of matrices.\r\n     * @param {Array<Matrix>} matrices Matrices to multiply.\r\n     * @returns {Matrix} new matrix with multiply result.\r\n     */\r\n    static multiplyMany(matrices)\r\n    {\r\n        let ret = matrices[0];\r\n        for(let i = 1; i < matrices.length; i++) {\r\n            ret = Matrix.multiply(ret, matrices[i]);\r\n        }        \r\n        return ret;\r\n    }\r\n        \r\n    /**\r\n     * Multiply two matrices and put result in first matrix. \r\n     * @returns {Matrix} matrixA, after it was modified.\r\n     */\r\n    static multiplyIntoFirst(matrixA, matrixB) \r\n    {\r\n        // Slice the second matrix up into rows\r\n        let row0 = [matrixB.values[ 0], matrixB.values[ 1], matrixB.values[ 2], matrixB.values[ 3]];\r\n        let row1 = [matrixB.values[ 4], matrixB.values[ 5], matrixB.values[ 6], matrixB.values[ 7]];\r\n        let row2 = [matrixB.values[ 8], matrixB.values[ 9], matrixB.values[10], matrixB.values[11]];\r\n        let row3 = [matrixB.values[12], matrixB.values[13], matrixB.values[14], matrixB.values[15]];\r\n    \r\n        // Multiply each row by matrixA\r\n        let result0 = multiplyMatrixAndPoint(matrixA.values, row0);\r\n        let result1 = multiplyMatrixAndPoint(matrixA.values, row1);\r\n        let result2 = multiplyMatrixAndPoint(matrixA.values, row2);\r\n        let result3 = multiplyMatrixAndPoint(matrixA.values, row3);\r\n    \r\n        // Turn the result rows back into a single matrix\r\n        matrixA.set(\r\n            result0[0], result0[1], result0[2], result0[3],\r\n            result1[0], result1[1], result1[2], result1[3],\r\n            result2[0], result2[1], result2[2], result2[3],\r\n            result3[0], result3[1], result3[2], result3[3]\r\n        );\r\n\r\n        // return the first matrix after it was modified\r\n        return matrixA;\r\n    }\r\n\r\n    /**\r\n     * Multiply an array of matrices into the first matrix in the array.\r\n     * @param {Array<Matrix>} matrices Matrices to multiply.\r\n     * @returns {Matrix} first matrix in array, after it was modified.\r\n     */\r\n    static multiplyManyIntoFirst(matrices)\r\n    {\r\n        let ret = matrices[0];\r\n        for(let i = 1; i < matrices.length; i++) {\r\n            ret = Matrix.multiplyIntoFirst(ret, matrices[i]);\r\n        }        \r\n        return ret;\r\n    }\r\n\r\n    /**\r\n     * Transform a 2d vertex.\r\n     * @param {Matrix} matrix Matrix to use to transform vector.\r\n     * @param {Vertex} vertex Vertex to transform.\r\n     * @returns {Vertex} A transformed vertex (cloned, not the original).\r\n     */\r\n    static transformVertex(matrix, vertex)\r\n    {\r\n        return new Vertex(Matrix.transformVector2(matrix, vertex.position), vertex.textureCoord, vertex.color);\r\n    }\r\n\r\n    /**\r\n     * Transform a 2d vector.\r\n     * @param {Matrix} matrix Matrix to use to transform vector.\r\n     * @param {Vector2} vector Vector to transform.\r\n     * @returns {Vector2} Transformed vector.\r\n     */\r\n    static transformVector2(matrix, vector)\r\n    {\r\n        const x = vector.x, y = vector.y, z = vector.z || 0;\r\n\t\tconst e = matrix.values;\r\n\r\n\t\tconst w = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] );\r\n\r\n\t\tconst resx = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] ) * w;\r\n\t\tconst resy = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] ) * w;\r\n\r\n        return new Vector2(resx, resy);\r\n    }\r\n\r\n    /**\r\n     * Transform a 3d vector.\r\n     * @param {Matrix} matrix Matrix to use to transform vector.\r\n     * @param {Vector3} vector Vector to transform.\r\n     * @returns {Vector3} Transformed vector.\r\n     */\r\n    static transformVector3(matrix, vector)\r\n    {\r\n        const x = vector.x, y = vector.y, z = vector.z || 0;\r\n        const e = matrix.values;\r\n\r\n        const w = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] );\r\n\r\n        const resx = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] ) * w;\r\n        const resy = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] ) * w;\r\n        const resz = ( e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] ) * w;\r\n\r\n        return new Vector3(resx, resy, resz);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Multiply matrix and vector.\r\n * @private\r\n */\r\nfunction multiplyMatrixAndPoint(matrix, point) \r\n{\r\n    // Give a simple variable name to each part of the matrix, a column and row number\r\n    let c0r0 = matrix[ 0], c1r0 = matrix[ 1], c2r0 = matrix[ 2], c3r0 = matrix[ 3];\r\n    let c0r1 = matrix[ 4], c1r1 = matrix[ 5], c2r1 = matrix[ 6], c3r1 = matrix[ 7];\r\n    let c0r2 = matrix[ 8], c1r2 = matrix[ 9], c2r2 = matrix[10], c3r2 = matrix[11];\r\n    let c0r3 = matrix[12], c1r3 = matrix[13], c2r3 = matrix[14], c3r3 = matrix[15];\r\n\r\n    // Now set some simple names for the point\r\n    let x = point[0];\r\n    let y = point[1];\r\n    let z = point[2];\r\n    let w = point[3];\r\n\r\n    // Multiply the point against each part of the 1st column, then add together\r\n    let resultX = (x * c0r0) + (y * c0r1) + (z * c0r2) + (w * c0r3);\r\n\r\n    // Multiply the point against each part of the 2nd column, then add together\r\n    let resultY = (x * c1r0) + (y * c1r1) + (z * c1r2) + (w * c1r3);\r\n\r\n    // Multiply the point against each part of the 3rd column, then add together\r\n    let resultZ = (x * c2r0) + (y * c2r1) + (z * c2r2) + (w * c2r3);\r\n\r\n    // Multiply the point against each part of the 4th column, then add together\r\n    let resultW = (x * c3r0) + (y * c3r1) + (z * c3r2) + (w * c3r3);\r\n\r\n    return [resultX, resultY, resultZ, resultW];\r\n}\r\n\r\n\r\n/**\r\n * An identity matrix.\r\n */\r\nMatrix.identity = new Matrix([\r\n    1, 0, 0, 0,\r\n    0, 1, 0, 0,\r\n    0, 0, 1, 0,\r\n    0, 0, 0, 1\r\n], false);\r\nObject.freeze(Matrix.identity);\r\n\r\n// export the matrix object\r\nmodule.exports = Matrix;", "/**\r\n * Effect base class.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\effects\\effect.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\nconst TextureAsset = require('../../assets/texture_asset.js');\r\nconst Color = require('../../utils/color.js');\r\nconst Rectangle = require('../../utils/rectangle.js');\r\nconst { TextureFilterMode, TextureFilterModes } = require('../texture_filter_modes');\r\nconst { TextureWrapMode, TextureWrapModes } = require('../texture_wrap_modes');\r\nconst Matrix = require('../matrix.js');\r\nconst _logger = require('../../logger.js').getLogger('gfx-effect');\r\n\r\n\r\n/**\r\n * Effect base class.\r\n * An effect = vertex shader + fragment shader + uniforms & attributes + setup code.\r\n */\r\nclass Effect\r\n{\r\n    /**\r\n     * Build the effect.\r\n     * Called from gfx manager.\r\n     * @private\r\n     * @param {WebGl} gl WebGL context.\r\n     */\r\n    _build(gl)\r\n    {\r\n        // create program\r\n        let program = gl.createProgram();\r\n\r\n        // build vertex shader\r\n        {\r\n            let shader = compileShader(gl, this.vertexCode, gl.VERTEX_SHADER);\r\n            gl.attachShader(program, shader);\r\n        }\r\n\r\n        // build fragment shader\r\n        {\r\n            let shader = compileShader(gl, this.fragmentCode, gl.FRAGMENT_SHADER);\r\n            gl.attachShader(program, shader);\r\n        }\r\n\r\n        // link program\r\n        gl.linkProgram(program)\r\n\r\n        // check for errors\r\n        if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\r\n            _logger.error(\"Error linking shader program:\");\r\n            _logger.error(gl.getProgramInfoLog(program));\r\n            throw new Error(\"Failed to link shader program.\");\r\n        }\r\n\r\n        // store program and gl\r\n        this._gl = gl;\r\n        this._program = program;\r\n\r\n        // a set of dynamically-created setters to set uniform values\r\n        this.uniforms = {};\r\n\r\n        // dictionary to bind uniform to built-in roles, like main texture or color\r\n        this._uniformBinds = {};\r\n\r\n        // initialize uniform setters\r\n        for (let uniform in this.uniformTypes) {\r\n\r\n            // get uniform location\r\n            let uniformLocation = this._gl.getUniformLocation(this._program, uniform);\r\n            if (uniformLocation === -1) { \r\n                _logger.error(\"Could not find uniform: \" + uniform);\r\n                throw new Error(`Uniform named '${uniform}' was not found in shader code!`); \r\n            }\r\n\r\n            // get gl setter method\r\n            let uniformData = this.uniformTypes[uniform];\r\n            if (!UniformTypes._values.has(uniformData.type)) { \r\n                _logger.error(\"Uniform has invalid type: \" + uniformData.type);\r\n                throw new Error(`Uniform '${uniform}' have illegal value type '${uniformData.type}'!`); \r\n            }\r\n\r\n            // build setter method for matrices\r\n            if (uniformData.type === UniformTypes.Matrix) {\r\n                (function(_this, name, location, method) {\r\n                    _this.uniforms[name] = (mat) => {\r\n                        _this._gl[method](location, false, mat);\r\n                    }\r\n                })(this, uniform, uniformLocation, uniformData.type);\r\n            }\r\n            // build setter method for textures\r\n            else if (uniformData.type === UniformTypes.Texture) {\r\n                (function(_this, name, location, method) {\r\n                    _this.uniforms[name] = (texture, index) => {\r\n                        index = index || 0;\r\n                        const glTexture = texture.texture || texture;\r\n                        const textureCode = _this._gl['TEXTURE' + (index || 0)];\r\n                        _this._gl.activeTexture(textureCode);\r\n                        _this._gl.bindTexture(_this._gl.TEXTURE_2D, glTexture);\r\n                        _this._gl.uniform1i(location, (index || 0));\r\n                        if (texture.filter) { _setTextureFilter(_this._gl, texture.filter); }\r\n                        if (texture.wrapMode) { _setTextureWrapMode(_this._gl, texture.wrapMode); }\r\n                    }\r\n                })(this, uniform, uniformLocation, uniformData.type);\r\n            }\r\n            // build setter method for other types\r\n            else {\r\n                (function(_this, name, location, method) {\r\n                    _this.uniforms[name] = (v1, v2, v3, v4) => {\r\n                        _this._gl[method](location, v1, v2, v3, v4);\r\n                    }\r\n                })(this, uniform, uniformLocation, uniformData.type);       \r\n            }\r\n\r\n            // set binding\r\n            let bindTo = uniformData.bind;\r\n            if (bindTo) {\r\n                this._uniformBinds[bindTo] = uniform;\r\n            }\r\n        }\r\n\r\n        // a set of dynamically-created setters to set attribute values\r\n        this.attributes = {};\r\n\r\n        // dictionary to bind attribute to built-in roles, like vertices positions or uvs\r\n        this._attributeBinds = {};\r\n\r\n        // get attribute locations\r\n        for (let attr in this.attributeTypes) {\r\n\r\n            // get attribute location\r\n            let attributeLocation = this._gl.getAttribLocation(this._program, attr);\r\n            if (attributeLocation === -1) { \r\n                _logger.error(\"Could not find attribute: \" + attr);\r\n                throw new Error(`Attribute named '${attr}' was not found in shader code!`); \r\n            }\r\n\r\n            // get attribute data\r\n            let attributeData = this.attributeTypes[attr];\r\n\r\n            // build setter method\r\n            (function(_this, name, location, data) {\r\n                _this.attributes[name] = (buffer) => {\r\n                    if (buffer) {\r\n                        _this._gl.bindBuffer(_this._gl.ARRAY_BUFFER, buffer);\r\n                        _this._gl.vertexAttribPointer(location, data.size, _this._gl[data.type] || _this._gl.FLOAT, data.normalize || false, data.stride || 0, data.offset || 0);\r\n                        _this._gl.enableVertexAttribArray(location);\r\n                    }\r\n                    else {\r\n                        _this._gl.disableVertexAttribArray(location);\r\n                    }\r\n                }\r\n            })(this, attr, attributeLocation, attributeData);\r\n      \r\n            // set binding\r\n            let bindTo = attributeData.bind;\r\n            if (bindTo) {\r\n                this._attributeBinds[bindTo] = attr;\r\n            }\r\n        }\r\n\r\n        // values we already set for this effect, so we won't set them again\r\n        this._cachedValues = {};\r\n    }\r\n\r\n    /**\r\n     * Get a dictionary with all shaders uniforms.\r\n     * Key = uniform name, as appears in shader code.\r\n     * Value = {\r\n     *              type: UniformTypes to represent uniform type,\r\n     *              bind: Optional bind to one of the built-in uniforms. See Effect.UniformBinds for details.\r\n     *         }\r\n     * @returns {*} Dictionary with uniforms descriptions.\r\n     */\r\n    get uniformTypes()\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n\r\n    /**\r\n     * Get a dictionary with all shader attributes.\r\n     * Key = attribute name, as appears in shader code.\r\n     * Value = {\r\n     *             size: size of every value in this attribute.\r\n     *             type: attribute type. See Effect.AttributeTypes for details.\r\n     *             normalize: if true, will normalize values.\r\n     *             stride: optional stride. \r\n     *             offset: optional offset.\r\n     *             bind: Optional bind to one of the built-in attributes. See Effect.AttributeBinds for details.\r\n     *         }\r\n     * @returns {*} Dictionary with attributes descriptions.\r\n     */\r\n    get attributeTypes()\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n\r\n    /**\r\n     * Make this effect active.\r\n     */\r\n    setAsActive()\r\n    {\r\n        // use effect program\r\n        this._gl.useProgram(this._program);\r\n\r\n        // enable / disable some features\r\n        if (this.enableDepthTest) { this._gl.enable(this._gl.DEPTH_TEST); } else { this._gl.disable(this._gl.DEPTH_TEST); }\r\n        if (this.enableFaceCulling) { this._gl.enable(this._gl.CULL_FACE); } else { this._gl.disable(this._gl.CULL_FACE); }\r\n        if (this.enableStencilTest) { this._gl.enable(this._gl.STENCIL_TEST); } else { this._gl.disable(this._gl.STENCIL_TEST); }\r\n        if (this.enableDithering) { this._gl.enable(this._gl.DITHER); } else { this._gl.disable(this._gl.DITHER); }\r\n\r\n        // reset cached values\r\n        this._cachedValues = {};\r\n    }\r\n\r\n    /**\r\n     * Prepare effect before drawing it with batching.\r\n     * @param {Mesh} mesh Mesh we're about to draw.\r\n     * @param {Matrix} world World matrix.\r\n     */\r\n    prepareToDrawBatch(mesh, world)\r\n    {\r\n        this._cachedValues = {};\r\n        this.setPositionsAttribute(mesh.positions);\r\n        this.setTextureCoordsAttribute(mesh.textureCoords);\r\n        this.setColorsAttribute(mesh.colors);\r\n        this.setWorldMatrix(world);\r\n    }\r\n\r\n    /**\r\n     * Get this effect's vertex shader code, as string.\r\n     * @returns {String} Vertex shader code. \r\n     */\r\n    get vertexCode()\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n\r\n    /**\r\n     * Get this effect's fragment shader code, as string.\r\n     * @returns {String} Fragment shader code. \r\n     */\r\n    get fragmentCode()\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n\r\n    /**\r\n     * Should this effect enable depth test?\r\n     */\r\n    get enableDepthTest()\r\n    {\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Should this effect enable face culling?\r\n     */\r\n    get enableFaceCulling()\r\n    {\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Should this effect enable stencil test?\r\n     */\r\n    get enableStencilTest()\r\n    {\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Should this effect enable dithering?\r\n     */\r\n    get enableDithering()\r\n    {\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Set the main texture.\r\n     * Only works if there's a uniform type bound to 'MainTexture'.\r\n     * @param {TextureAsset} texture Texture to set.\r\n     * @returns {Boolean} True if texture was changed, false if there was no need to change the texture.\r\n     */\r\n    setTexture(texture)\r\n    {\r\n        // already using this texture? skip\r\n        if (texture === this._cachedValues.texture) { \r\n            return false; \r\n        }\r\n\r\n        // get texture uniform\r\n        let uniform = this._uniformBinds[Effect.UniformBinds.MainTexture];\r\n\r\n        // set texture\r\n        if (uniform) {\r\n            this._cachedValues.texture = texture;\r\n            let glTexture = texture.texture || texture;\r\n            this._gl.activeTexture(this._gl.TEXTURE0);\r\n            this._gl.bindTexture(this._gl.TEXTURE_2D, glTexture);\r\n            this.uniforms[uniform](texture, 0);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Set the main tint color.\r\n     * Only works if there's a uniform type bound to 'Color'.\r\n     * @param {Color} color Color to set.\r\n     */\r\n    setColor(color)\r\n    {\r\n        let uniform = this._uniformBinds[Effect.UniformBinds.Color];\r\n        if (uniform) {\r\n            if (color.equals(this._cachedValues.color)) { return; }\r\n            this._cachedValues.color = color.clone();\r\n            this.uniforms[uniform](color.floatArray);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set uvOffset and uvScale params from source rectangle and texture.\r\n     * @param {Rectangle} sourceRect Source rectangle to set, or null to take entire texture.\r\n     * @param {TextureAsset} texture Texture asset to set source rect for.\r\n     */\r\n    setUvOffsetAndScale(sourceRect, texture)\r\n    {\r\n        // skip if the same\r\n        if (sourceRect) {\r\n            if (sourceRect.equals(this._cachedValues.sourceRect)) { return; }\r\n        }\r\n        else {\r\n            if (this._cachedValues.sourceRect === null) { return; }\r\n        }\r\n        this._cachedValues.sourceRect = sourceRect ? sourceRect.clone() : null;\r\n\r\n        // default source rect\r\n        if (!sourceRect) { sourceRect = new Rectangle(0, 0, texture.width, texture.height); }\r\n\r\n        // set uv offset\r\n        let uvOffset = this._uniformBinds[Effect.UniformBinds.UvOffset];\r\n        if (uvOffset) {\r\n            this.uniforms[uvOffset](sourceRect.x / texture.width, sourceRect.y / texture.height);\r\n        }\r\n        \r\n        // set uv scale\r\n        let uvScale = this._uniformBinds[Effect.UniformBinds.UvScale];\r\n        if (uvScale) {\r\n            this.uniforms[uvScale](sourceRect.width / texture.width, sourceRect.height / texture.height);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set the projection matrix uniform.\r\n     * @param {Matrix} matrix Matrix to set.\r\n     */\r\n    setProjectionMatrix(matrix)\r\n    {\r\n        let uniform = this._uniformBinds[Effect.UniformBinds.Projection];\r\n        if (uniform) {\r\n            if (matrix.equals(this._cachedValues.projection)) { return; }\r\n            this._cachedValues.projection = matrix.clone();\r\n            this.uniforms[uniform](matrix.values);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set the world matrix uniform.\r\n     * @param {Matrix} matrix Matrix to set.\r\n     */\r\n    setWorldMatrix(matrix)\r\n    {\r\n        let uniform = this._uniformBinds[Effect.UniformBinds.World];\r\n        if (uniform) {\r\n            this.uniforms[uniform](matrix.values);\r\n        }\r\n    }\r\n     \r\n    /**\r\n     * Set the vertices position buffer.\r\n     * Only works if there's an attribute type bound to 'Position'.\r\n     * @param {WebGLBuffer} buffer Vertices position buffer.\r\n     */\r\n    setPositionsAttribute(buffer)\r\n    {\r\n        let attr = this._attributeBinds[Effect.AttributeBinds.Position];\r\n        if (attr) {\r\n            if (buffer === this._cachedValues.positions) { return; }\r\n            this._cachedValues.positions = buffer;\r\n            this.attributes[attr](buffer);\r\n        }\r\n    }\r\n     \r\n    /**\r\n     * Set the vertices texture coords buffer.\r\n     * Only works if there's an attribute type bound to 'TextureCoords'.\r\n     * @param {WebGLBuffer} buffer Vertices texture coords buffer.\r\n     */\r\n    setTextureCoordsAttribute(buffer)\r\n    {\r\n        let attr = this._attributeBinds[Effect.AttributeBinds.TextureCoords];\r\n        if (attr) {\r\n            if (buffer === this._cachedValues.coords) { return; }\r\n            this._cachedValues.coords = buffer;\r\n            this.attributes[attr](buffer);\r\n        }\r\n    }\r\n         \r\n    /**\r\n     * Set the vertices colors buffer.\r\n     * Only works if there's an attribute type bound to 'Colors'.\r\n     * @param {WebGLBuffer} buffer Vertices colors buffer.\r\n     */\r\n     setColorsAttribute(buffer)\r\n     {\r\n         let attr = this._attributeBinds[Effect.AttributeBinds.Colors];\r\n         if (attr) {\r\n            if (buffer === this._cachedValues.colors) { return; }\r\n            this._cachedValues.colors = buffer;\r\n            this.attributes[attr](buffer);\r\n         }\r\n     }\r\n}\r\n\r\n/**\r\n * Build a shader.\r\n */\r\nfunction compileShader(gl, code, type) \r\n{\r\n    let shader = gl.createShader(type);\r\n\r\n    gl.shaderSource(shader, code);\r\n    gl.compileShader(shader);\r\n\r\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n        _logger.error(`Error compiling ${type === gl.VERTEX_SHADER ? \"vertex\" : \"fragment\"} shader:`);\r\n        _logger.error(gl.getShaderInfoLog(shader));\r\n        throw new Error(\"Failed to compile a shader.\");\r\n    }\r\n\r\n    return shader;\r\n}\r\n\r\n/** @typedef {String} UniformType */\r\n\r\n/**\r\n * Uniform types enum.\r\n * @readonly\r\n * @enum {UniformType}\r\n */\r\nconst UniformTypes = \r\n{\r\n    Texture: 'texture',\r\n    Matrix: 'uniformMatrix4fv',\r\n    Color: 'uniform4fv',\r\n\r\n    Float: 'uniform1f',\r\n    FloatArray: 'uniform1fv',\r\n\r\n    Int: 'uniform1i',\r\n    IntArray: 'uniform1iv',\r\n\r\n    Float2: 'uniform2f',\r\n    Float2Array: 'uniform2fv',\r\n\r\n    Int2: 'uniform2i',\r\n    Int2Array: 'uniform2iv',\r\n    \r\n    Float3: 'uniform3f',\r\n    Float3Array: 'uniform3fv',\r\n\r\n    Int3: 'uniform3i',\r\n    Int3Array: 'uniform3iv',\r\n    \r\n    Float4: 'uniform4f',\r\n    Float4Array: 'uniform4fv',\r\n\r\n    Int4: 'uniform4i',\r\n    Int4Array: 'uniform4iv',\r\n}\r\nObject.defineProperty(UniformTypes, '_values', {\r\n    value: new Set(Object.values(UniformTypes)),\r\n    writable: false,\r\n});\r\nObject.freeze(UniformTypes);\r\n\r\n// attach uniform types to effect\r\nEffect.UniformTypes = UniformTypes;\r\n\r\n// define uniform binds - connect uniform name to special usage, like key texture, etc.\r\nEffect.UniformBinds = {\r\n    MainTexture: 'texture',     // bind uniform to be used as the main texture.\r\n    Color: 'color',             // bind uniform to be used as a main color.\r\n    Projection: 'projection',   // bind uniform to be used as the projection matrix.\r\n    World: 'world',             // bind uniform to be used as the world matrix.\r\n    UvOffset: 'uvOffset',       // bind uniform to be used as UV offset.\r\n    UvScale: 'uvScale',         // bind uniform to be used as UV scale.\r\n};\r\nObject.freeze(Effect.UniformBinds);\r\n\r\n// define attribute value types.\r\nEffect.AttributeTypes = {\r\n    Byte: 'BYTE',\r\n    Short: 'SHORT',\r\n    UByte: 'UNSIGNED_BYTE',\r\n    UShort: 'UNSIGNED_SHORT',\r\n    Float: 'FLOAT',\r\n    HalfFloat: 'HALF_FLOAT',\r\n};\r\nObject.freeze(Effect.AttributeTypes);\r\n\r\n// define attribute binds - connect attribute name to special usage, like position, uvs, etc.\r\nEffect.AttributeBinds = {\r\n    Position: 'position',   // bind attribute to be used for vertices position array.\r\n    TextureCoords: 'uvs',   // bind attribute to be used for texture coords array.\r\n    Colors: 'colors',       // bind attribute to be used for vertices colors array.\r\n}\r\nObject.freeze(Effect.AttributeBinds);\r\n\r\n\r\n/**\r\n * Set texture mag and min filters.\r\n * @private\r\n * @param {TextureFilterModes} filter Texture filter to set.\r\n */\r\nfunction _setTextureFilter(gl, filter)\r\n{\r\n    if (!TextureFilterModes._values.has(filter)) { throw new Error(\"Invalid texture filter mode! Please pick a value from 'TextureFilterModes'.\"); }\r\n    let glMode = gl[filter];\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, glMode);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, glMode);\r\n}\r\n\r\n/**\r\n * Set texture wrap mode on X and Y axis.\r\n * @private\r\n * @param {TextureWrapMode} wrapX Wrap mode on X axis.\r\n * @param {TextureWrapMode} wrapY Wrap mode on Y axis.\r\n */\r\n function _setTextureWrapMode(gl, wrapX, wrapY)\r\n{\r\n    if (wrapY === undefined) { wrapY = wrapX; }\r\n    if (!TextureWrapModes._values.has(wrapX)) { throw new Error(\"Invalid texture wrap mode! Please pick a value from 'TextureWrapModes'.\"); }\r\n    if (!TextureWrapModes._values.has(wrapY)) { throw new Error(\"Invalid texture wrap mode! Please pick a value from 'TextureWrapModes'.\"); }\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl[wrapX]);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl[wrapY]);\r\n}\r\n\r\n\r\n// export the effect class.\r\nmodule.exports = Effect;", "/**\r\n * Implement a basic effect to draw sprites.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\effects\\basic.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst Effect = require(\"./effect\");\r\n\r\n// vertex shader code\r\nconst vertexShader = `\r\nattribute vec3 position;\r\nattribute vec2 coord;\r\nattribute vec4 color;\r\n\r\nuniform mat4 projection;\r\nuniform mat4 world;\r\n\r\nvarying vec2 v_texCoord;\r\nvarying vec4 v_color;\r\n\r\nvoid main(void) {\r\n    gl_Position = projection * world * vec4(position, 1.0);\r\n    gl_PointSize = 1.0;\r\n    v_texCoord = coord;\r\n    v_color = color;\r\n}\r\n    `;\r\n\r\n// fragment shader code\r\nconst fragmentShader = `  \r\n#ifdef GL_ES\r\n    precision highp float;\r\n#endif\r\n\r\nuniform sampler2D texture;\r\n\r\nvarying vec2 v_texCoord;\r\nvarying vec4 v_color;\r\n\r\nvoid main(void) {\r\n    gl_FragColor = texture2D(texture, v_texCoord) * v_color;\r\n    gl_FragColor.rgb *= gl_FragColor.a;\r\n}\r\n    `;\r\n\r\n/**\r\n * Default basic effect to draw 2d sprites.\r\n */\r\nclass BasicEffect extends Effect\r\n{\r\n    /** @inheritdoc */\r\n    get vertexCode() \r\n    { \r\n        return vertexShader; \r\n    }\r\n\r\n    /** @inheritdoc */\r\n    get fragmentCode()\r\n    { \r\n        return fragmentShader;\r\n    }\r\n\r\n    /** @inheritdoc */\r\n    get uniformTypes()\r\n    {\r\n        return {\r\n            \"texture\": { type: Effect.UniformTypes.Texture, bind: Effect.UniformBinds.MainTexture },\r\n            \"projection\": { type: Effect.UniformTypes.Matrix, bind: Effect.UniformBinds.Projection },\r\n            \"world\": { type: Effect.UniformTypes.Matrix, bind: Effect.UniformBinds.World },\r\n        };\r\n    }\r\n\r\n    /** @inheritdoc */\r\n    get attributeTypes()\r\n    {\r\n        return {\r\n            \"position\": { size: 3, type: Effect.AttributeTypes.Float, normalize: false, bind: Effect.AttributeBinds.Position },\r\n            \"coord\": { size: 2, type: Effect.AttributeTypes.Float, normalize: false, bind: Effect.AttributeBinds.TextureCoords },\r\n            \"color\": { size: 4, type: Effect.AttributeTypes.Float, normalize: false, bind: Effect.AttributeBinds.Colors },\r\n        };\r\n    }\r\n}\r\n\r\n\r\n// export the basic shader\r\nmodule.exports = BasicEffect;", "/**\r\n * Implement an effect to draw MSDF font textures.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\effects\\msdf_font.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst Effect = require(\"./effect\");\r\n\r\n// vertex shader code\r\nconst vertexShader = `#version 300 es\r\nin vec3 a_position;\r\nin vec2 a_coord;\r\nin vec4 a_color;\r\n\r\nuniform mat4 u_projection;\r\nuniform mat4 u_world;\r\n\r\nout vec2 v_texCoord;\r\nout vec4 v_color;\r\n\r\nvoid main(void) {\r\n    gl_Position = u_projection * u_world * vec4(a_position, 1.0);\r\n    gl_PointSize = 1.0;\r\n    v_texCoord = a_coord;\r\n    v_color = a_color;\r\n}`;\r\n\r\n// fragment shader code\r\nconst fragmentShader = `#version 300 es\r\nprecision highp float;\r\n\r\nuniform sampler2D u_texture;\r\n\r\nin vec2 v_texCoord;\r\nin vec4 v_color;\r\n\r\nout vec4 FragColor;\r\n\r\nfloat median(float r, float g, float b) {\r\n  return max(min(r, g), min(max(r, g), b));\r\n}\r\n\r\nvoid main(void) {\r\n  vec3 _sample = texture(u_texture, v_texCoord).rgb;\r\n  float sigDist = median(_sample.r, _sample.g, _sample.b) - 0.5;\r\n  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);\r\n  // float alpha = clamp((sigDist / (fwidth(sigDist) * 1.5)) + 0.5, 0.0, 1.0);\r\n\r\n  vec3 color = v_color.rgb * alpha;\r\n  FragColor = vec4(color, alpha) * v_color.a;\r\n}`;\r\n\r\n/**\r\n * Default effect to draw MSDF font textures.\r\n */\r\nclass MsdfFontEffect extends Effect\r\n{\r\n    /** @inheritdoc */\r\n    get vertexCode() \r\n    { \r\n        return vertexShader; \r\n    }\r\n\r\n    /** @inheritdoc */\r\n    get fragmentCode()\r\n    { \r\n        return fragmentShader;\r\n    }\r\n\r\n    /** @inheritdoc */\r\n    get uniformTypes()\r\n    {\r\n        return {\r\n            \"u_texture\": { type: Effect.UniformTypes.Texture, bind: Effect.UniformBinds.MainTexture },\r\n            \"u_projection\": { type: Effect.UniformTypes.Matrix, bind: Effect.UniformBinds.Projection },\r\n            \"u_world\": { type: Effect.UniformTypes.Matrix, bind: Effect.UniformBinds.World },\r\n        };\r\n    }\r\n\r\n    /** @inheritdoc */\r\n    get attributeTypes()\r\n    {\r\n        return {\r\n            \"a_position\": { size: 3, type: Effect.AttributeTypes.Float, normalize: false, bind: Effect.AttributeBinds.Position },\r\n            \"a_coord\": { size: 2, type: Effect.AttributeTypes.Float, normalize: false, bind: Effect.AttributeBinds.TextureCoords },\r\n            \"a_color\": { size: 4, type: Effect.AttributeTypes.Float, normalize: false, bind: Effect.AttributeBinds.Colors },\r\n        };\r\n    }\r\n}\r\n\r\n\r\n// export the basic shader\r\nmodule.exports = MsdfFontEffect;", "/**\r\n * Include all built-in effects.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\effects\\index.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\n\r\n module.exports = {\r\n    Effect: require('./effect'),\r\n    BasicEffect: require('./basic'),\r\n    MsdfFontEffect: require('./msdf_font'),\r\n }", "/**\r\n * Define a mesh object.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\mesh.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\n\r\nconst { Color } = require(\"../utils\");\r\n\r\n /**\r\n  * Class to hold a mesh.\r\n  */\r\n class Mesh\r\n {\r\n    /**\r\n     * Create the mesh object.\r\n     * @param {WebGLBuffer} positions vertices positions buffer. \r\n     * @param {WebGLBuffer} textureCoords vertices texture coords buffer.\r\n     * @param {WebGLBuffer} colorss vertices colors buffer.\r\n     * @param {WebGLBuffer} indices indices buffer.\r\n     * @param {Number} indicesCount how many indices we have.\r\n     */\r\n    constructor(positions, textureCoords, colorsBuffer, indices, indicesCount)\r\n    {\r\n        this.positions = positions;\r\n        this.textureCoords = textureCoords;\r\n        this.colors = colorsBuffer;\r\n        this.indices = indices;\r\n        this.indicesCount = indicesCount;\r\n        this.__color = new Color(-1, -1, -1, -1);\r\n        Object.freeze(this);\r\n    }\r\n\r\n    /**\r\n     * Override the colors buffer, if possible.\r\n     * @param {WebGl} gl WebGL context.\r\n     * @param {Color} color Color to set.\r\n     */\r\n    overrideColors(gl, color)\r\n    {\r\n        if (color.equals(this.__color)) { return; }\r\n        this.__color.copy(color);\r\n\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.colors);\r\n        const colors = [];\r\n        for (let i = 0; i < this.indicesCount; ++i) {\r\n            colors.push(color.r);\r\n            colors.push(color.g);\r\n            colors.push(color.b);\r\n            colors.push(color.a);\r\n        }\r\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(colors), gl.DYNAMIC_DRAW);\r\n    }\r\n }\r\n \r\n // export the mesh class.\r\n module.exports = Mesh;", "/**\r\n * Define utility to generate meshes.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\mesh_generator.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\nconst Mesh = require(\"./mesh\");\r\n\r\n/**\r\n * Utility class to generate meshes.\r\n * @private\r\n */\r\nclass MeshGenerator\r\n{\r\n    /**\r\n     * Create the mesh generator.\r\n     */\r\n    constructor(gl)\r\n    {\r\n        this._gl = gl;\r\n    }\r\n\r\n    /**\r\n     * Generate and return a textured quad.\r\n     * @returns {Mesh} Quad mesh.\r\n     */\r\n    quad()\r\n    {\r\n        const gl = this._gl;\r\n\r\n        const positionBuffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\r\n        let x = 0.5; // <- 0.5 so total size would be 1x1\r\n        const positions = [\r\n            -x, -x,  0,\r\n             x, -x,  0,\r\n            -x,  x,  0,\r\n            x,  x,  0,\r\n        ];\r\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(positions), gl.STATIC_DRAW);\r\n    \r\n        const textureCoordBuffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, textureCoordBuffer);\r\n        const textureCoordinates = [\r\n            0.0,  0.0,\r\n            1.0,  0.0,\r\n            0.0,  1.0,\r\n            1.0,  1.0,\r\n        ];\r\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(textureCoordinates), gl.STATIC_DRAW);\r\n\r\n        const colorsBuffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, colorsBuffer);\r\n        const colors = [\r\n            1,1,1,1,\r\n            1,1,1,1,\r\n            1,1,1,1,\r\n            1,1,1,1,\r\n        ];\r\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(colors), gl.DYNAMIC_DRAW);\r\n    \r\n        const indexBuffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);\r\n        const indices = [\r\n            0, 1, 3, 2\r\n        ];\r\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.STATIC_DRAW);\r\n    \r\n        return new Mesh(positionBuffer, textureCoordBuffer, colorsBuffer, indexBuffer, indices.length);\r\n    }\r\n}\r\n\r\n// export the meshes generator.\r\nmodule.exports = MeshGenerator;", "/**\r\n * Camera class.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\camera.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\n\r\nconst Rectangle = require(\"../utils/rectangle\");\r\nconst Vector2 = require(\"../utils/vector2\");\r\nconst Matrix = require(\"./matrix\");\r\n\r\n /**\r\n  * Implements a Camera object.\r\n  */\r\nclass Camera\r\n{\r\n    /**\r\n     * Create the camera.\r\n     * @param {Gfx} gfx The gfx manager instance.\r\n     */\r\n    constructor(gfx)\r\n    {\r\n        /**\r\n         * Camera projection matrix.\r\n         * You can set it manually, or use 'orthographicOffset' / 'orthographic' / 'perspective' helper functions.\r\n         */\r\n        this.projection = null;\r\n\r\n        this._region = null;\r\n        this._gfx = gfx;\r\n        this.orthographic();\r\n        this._viewport = null;\r\n    }\r\n\r\n    /**\r\n     * Get camera's viewport (drawing region to set when using this camera).\r\n     * @returns {Rectangle} Camera's viewport as rectangle.\r\n     */\r\n    get viewport()\r\n    {\r\n        return this._viewport;\r\n    }\r\n\r\n    /**\r\n     * Set camera's viewport.\r\n     * @param {Rectangle} viewport New viewport to set or null to not use any viewport when using this camera.\r\n     */\r\n    set viewport(viewport)\r\n    {\r\n        this._viewport = viewport;\r\n        return viewport;\r\n    }\r\n\r\n    /**\r\n     * Get the region this camera covers.\r\n     * @returns {Rectangle} region this camera covers.\r\n     */\r\n    getRegion()\r\n    {\r\n        return this._region.clone();\r\n    }\r\n\r\n    /**\r\n     * Make this camera an orthographic camera with offset.\r\n     * @param {Vector2} offset Camera offset (top-left corner).\r\n     * @param {Boolean} ignoreViewportSize If true, will take the entire canvas size for calculation and ignore the viewport size, if set.\r\n     * @param {Number} near Near clipping plane.\r\n     * @param {Number} far Far clipping plane.\r\n     */\r\n    orthographicOffset(offset, ignoreViewportSize, near, far)\r\n    {\r\n        let renderingSize = (ignoreViewportSize || !this.viewport) ? this._gfx.getCanvasSize() : this.viewport.getSize();\r\n        let region = new Rectangle(offset.x, offset.y, renderingSize.x, renderingSize.y);\r\n        this.orthographic(region, near, far);\r\n    }\r\n\r\n    /**\r\n     * Make this camera an orthographic camera.\r\n     * @param {Rectangle} region Camera left, top, bottom and right. If not set, will take entire canvas.\r\n     * @param {Number} near Near clipping plane.\r\n     * @param {Number} far Far clipping plane.\r\n     */\r\n    orthographic(region, near, far) \r\n    {\r\n        if (region === undefined) {\r\n            region = this._gfx.getRenderingRegion();\r\n        }\r\n        this._region = region;\r\n        this.projection = Matrix.orthographic(region.left, region.right, region.bottom, region.top, near || -1, far || 400);\r\n    }\r\n\r\n    /**\r\n     * Make this camera a perspective camera.\r\n     * @private\r\n     * @param {*} fieldOfView Field of view angle in radians.\r\n     * @param {*} aspectRatio Aspect ratio.\r\n     * @param {*} near Near clipping plane.\r\n     * @param {*} far Far clipping plane.\r\n     */\r\n    _perspective(fieldOfView, aspectRatio, near, far) \r\n    {\r\n        this.projection = Matrix.perspective(fieldOfView || (Math.PI / 2), aspectRatio || 1, near || 0.1, far || 1000)\r\n    }\r\n}\r\n\r\n// export the camera object\r\nmodule.exports = Camera;", "/**\r\n * Define a sprite object.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\sprite.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\nconst TextureAsset = require(\"../assets/texture_asset\");\r\nconst Color = require(\"../utils/color\");\r\nconst Rectangle = require(\"../utils/rectangle\");\r\nconst Vector2 = require(\"../utils/vector2\");\r\nconst Vector3 = require(\"../utils/vector3\");\r\nconst {BlendMode, BlendModes} = require(\"./blend_modes\");\r\n\r\n/**\r\n * Sprite class.\r\n * This object is a helper class to hold all the properties of a texture to render.\r\n */\r\nclass Sprite\r\n{\r\n    /**\r\n     * Create the texture object.\r\n     * @param {TextureAsset} texture Texture asset.\r\n     * @param {Rectangle=} sourceRect Optional source rect.\r\n     */\r\n    constructor(texture, sourceRect)\r\n    {\r\n        /**\r\n         * Texture to use for this sprite.\r\n         * @name Sprite#texture\r\n         * @type {TextureAsset}\r\n         */\r\n        this.texture = texture;\r\n        \r\n        /**\r\n         * Sprite position.\r\n         * If Vector3 is provided, the z value will be passed to vertices position in shader code.\r\n         * This property is locked when static=true.\r\n         * @name Sprite#position\r\n         * @type {Vector2|Vector3}\r\n         */\r\n        this.position = new Vector2(0, 0);\r\n\r\n        /**\r\n         * Sprite size.\r\n         * If Vector3 is provided, the z value will be passed to the bottom vertices position in shader code, as position.z + size.z.\r\n         * This property is locked when static=true.\r\n         * @name Sprite#size\r\n         * @type {Vector2|Vector3}\r\n         */\r\n        if (sourceRect) {\r\n            this.size = new Vector2(sourceRect.width, sourceRect.height);\r\n        } else if (texture && texture.valid) {\r\n            this.size = texture.size.clone();\r\n        }\r\n        else {\r\n            this.size = new Vector2(100, 100);\r\n        }\r\n\r\n        /**\r\n         * Sprite source rectangle in texture.\r\n         * Null will take entire texture.\r\n         * This property is locked when static=true.\r\n         * @name Sprite#sourceRect\r\n         * @type {Rectangle}\r\n         */\r\n        this.sourceRect = sourceRect || null;\r\n        \r\n        /**\r\n         * Sprite blend mode.\r\n         * @name Sprite#blendMode\r\n         * @type {BlendMode}\r\n         */\r\n        this.blendMode = BlendModes.AlphaBlend;\r\n        \r\n        /**\r\n         * Sprite rotation in radians.\r\n         * This property is locked when static=true.\r\n         * @name Sprite#rotation\r\n         * @type {Number}\r\n         */\r\n        this.rotation = 0;\r\n        \r\n        /**\r\n         * Sprite origin point.\r\n         * This property is locked when static=true.\r\n         * @name Sprite#origin\r\n         * @type {Vector2}\r\n         */\r\n        this.origin = new Vector2(0.5, 0.5);\r\n        \r\n        /**\r\n         * Skew the sprite corners on X and Y axis, around the origin point.\r\n         * This property is locked when static=true.\r\n         * @name Sprite#skew\r\n         * @type {Vector2}\r\n         */\r\n        this.skew = new Vector2(0, 0);\r\n        \r\n        /**\r\n         * Sprite color.\r\n         * If array is set, will assign each color to different vertex, starting from top-left.\r\n         * @name Sprite#color\r\n         * @type {Color|Array<Color>}\r\n         */\r\n        this.color = Color.white;\r\n\r\n        /**\r\n         * Is this a static sprite.\r\n         * Static sprites will only calculate vertices properties once, and reuse them in following render calls.\r\n         * This will improve performance, but also means that once the sprite is rendered once, changing things like position, size, rotation, etc.\r\n         * won't affect the output. To refresh the properties of a static sprite, you need to call updateStaticProperties() manually.\r\n         * @name Sprite#static\r\n         * @type {Boolean}\r\n         */\r\n        this.static = false;\r\n    }\r\n\r\n    /**\r\n     * Set the source Rectangle automatically from spritesheet.\r\n     * This method get sprite index in sheet and how many sprites there are in total, and calculate the desired\r\n     * offset and size in source Rectangle based on it + source image size.\r\n     * @param {Vector2} index Sprite index in spritesheet.\r\n     * @param {Vector2} spritesCount How many sprites there are in spritesheet in total.\r\n     * @param {Number=} margin How many pixels to trim from the tile (default is 0).\r\n     * @param {Boolean=} setSize If true will also set width and height based on source rectangle (default is true).\r\n     */\r\n    setSourceFromSpritesheet(index, spritesCount, margin, setSize) {\r\n        margin = margin || 0;\r\n        let w = this.texture.width / spritesCount.x;\r\n        let h = this.texture.height / spritesCount.y;\r\n        let x = w * index.x + margin;\r\n        let y = h * index.y + margin;\r\n        w -= 2*margin;\r\n        h -= 2*margin;\r\n        if (setSize || setSize === undefined) {\r\n            this.size.set(w, h)\r\n        }\r\n        if (this.sourceRect) {\r\n            this.sourceRect.set(x, y, w, h);\r\n        } else {\r\n            this.sourceRect = new Rectangle(x, y, w, h);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Clone this sprite.\r\n     * @returns {Sprite} cloned sprite.\r\n     */\r\n    clone()\r\n    {\r\n        let ret = new Sprite(this.texture, this.sourceRect);\r\n        ret.position = this.position.clone();\r\n        ret.size = this.size.clone();\r\n        ret.blendMode = this.blendMode;\r\n        ret.rotation = this.rotation;\r\n        ret.origin = this.origin.clone();\r\n        ret.color = this.color.clone();\r\n        ret.static = this.static;\r\n        return ret;\r\n    }\r\n\r\n    /**\r\n     * Manually update the static properties (position, size, rotation, origin, source rectangle, etc.) of a static sprite.\r\n     */\r\n    updateStaticProperties()\r\n    {\r\n        this._cachedVertices = null;\r\n    }\r\n\r\n    /**\r\n     * Check if this sprite is flipped around X axis.\r\n     * This is just a sugarcoat that returns if size.x < 0.\r\n     * @returns {Boolean} If sprite is flipped on X axis.\r\n     */\r\n    get flipX()\r\n    {\r\n        return this.size.x < 0;\r\n    }\r\n\r\n    /**\r\n     * Flip sprite around X axis.\r\n     * This is just a sugarcoat that set size.x to negative or positive value, without changing its scale.\r\n     * @param {Boolean} flip Should we flip the sprite around X axis. If undefined, will take the negative of flipX current value, ie will toggle flipping.\r\n     */\r\n    set flipX(flip)\r\n    {\r\n        if (flip === undefined) flip = !this.flipX;\r\n        this.size.x = Math.abs(this.size.x) * (flip ? -1 : 1);\r\n        return flip;\r\n    }\r\n\r\n    /**\r\n     * Check if this sprite is flipped around y axis.\r\n     * This is just a sugarcoat that returns if size.y < 0.\r\n     * @returns {Boolean} If sprite is flipped on Y axis.\r\n     */\r\n     get flipY()\r\n     {\r\n         return this.size.y < 0;\r\n     }\r\n \r\n     /**\r\n      * Flip sprite around Y axis.\r\n      * This is just a sugarcoat that set size.y to negative or positive value, without changing its scale.\r\n      * @param {Boolean} flip Should we flip the sprite around Y axis. If undefined, will take the negative of flipY current value, ie will toggle flipping.\r\n      */\r\n     set flipY(flip)\r\n     {\r\n         if (flip === undefined) flip = !this.flipY;\r\n         this.size.y = Math.abs(this.size.y) * (flip ? -1 : 1);\r\n         return flip;\r\n     }\r\n}\r\n\r\n// export the sprite class.\r\nmodule.exports = Sprite;", "/**\r\n * Define a sprites group.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\sprites_group.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst Color = require(\"../utils/color\");\r\nconst Vector2 = require(\"../utils/vector2\");\r\nconst Matrix = require(\"./matrix\");\r\nconst Sprite = require(\"./sprite\");\r\n\r\n\r\n/**\r\n * Sprites group class.\r\n * This object is a container to hold sprites collection + parent transformations.\r\n * You need SpritesGroup to use batched rendering.\r\n */\r\nclass SpritesGroup\r\n{\r\n    /**\r\n     * Create the group object.\r\n     */\r\n    constructor()\r\n    {\r\n        this._sprites = [];\r\n        this.rotation = 0;\r\n        this.position = new Vector2(0, 0);\r\n        this.scale = new Vector2(1, 1);\r\n    }\r\n\r\n    /**\r\n     * Iterate all sprites.\r\n     * @param {Function} callback Callback to run on all sprites in group.\r\n     */\r\n    forEach(callback)\r\n    {\r\n        this._sprites.forEach(callback);\r\n    }\r\n\r\n    /**\r\n     * Set color for all sprites in group.\r\n     * @param {Color} color Color to set.\r\n     */\r\n    setColor(color)\r\n    {\r\n        for (let i = 0; i < this._sprites.length; ++i) {\r\n            this._sprites[i].color.copy(color);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get group's transformations.\r\n     * @returns {Matrix} Transformations matrix, or null if there's nothing to apply.\r\n     */\r\n    getTransform()\r\n    {\r\n        let matrices = [];\r\n\r\n        if ((this.position.x !== 0) || (this.position.y !== 0)) \r\n        { \r\n            matrices.push(Matrix.translate(this.position.x, this.position.y, 0));\r\n        }\r\n        \r\n        if (this.rotation) \r\n        { \r\n            matrices.push(Matrix.rotateZ(-this.rotation));\r\n        }\r\n        \r\n        if ((this.scale.x !== 1) || (this.scale.y !== 1)) \r\n        { \r\n            matrices.push(Matrix.scale(this.scale.x, this.scale.y));\r\n        }\r\n\r\n        if (matrices.length === 0) { return null };\r\n        if (matrices.length === 1) { return matrices[0]; }\r\n        return Matrix.multiplyMany(matrices);\r\n    }\r\n    \r\n    /**\r\n     * Adds a sprite to group.\r\n     * @param {Sprite} sprite Sprite to add.\r\n     * @returns {Sprite} The newly added sprite.\r\n     */\r\n    add(sprite)\r\n    {\r\n        this._sprites.push(sprite);\r\n        return sprite;\r\n    }\r\n        \r\n    /**\r\n     * Remove a sprite from group.\r\n     * @param {Sprite} sprite Sprite to remove.\r\n     */\r\n    remove(sprite)\r\n    {\r\n        for (let i = 0; i < this._sprites.length; ++i) {\r\n            if (this._sprites[i] === sprite) {\r\n                this._sprites.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Shift first sprite element.\r\n     * @returns {Sprite} The removed sprite.\r\n     */\r\n    shift()\r\n    {\r\n        return this._sprites.shift();\r\n    }\r\n\r\n    /**\r\n     * Sort sprites.\r\n     * @param {Function} compare Comparer method.\r\n     */\r\n    sort(compare)\r\n    {\r\n        this._sprites.sort(compare);\r\n    }\r\n\r\n    /**\r\n     * Sort by texture and blend mode for maximum efficiency in batching.\r\n     * This will change sprites order.\r\n     */\r\n    sortForBatching()\r\n    {\r\n        this._sprites.sort((a,b) => {\r\n            let at = a.texture.url + a.blendMode;\r\n            let bt = b.texture.url + b.blendMode;\r\n            return (at > bt) ? 1 : ((bt > at) ? -1 : 0);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Sprites count in group.\r\n     * @returns {Number} Number of sprites in group.\r\n     */\r\n    get count()\r\n    {\r\n        return this._sprites.length;\r\n    }\r\n}\r\n\r\n\r\n// export the sprites group class.\r\nmodule.exports = SpritesGroup;", "/**\r\n * Implement a font texture asset type.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\assets\\font_texture_asset.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst Asset = require(\"./asset\");\r\nconst Vector2 = require(\"../utils/vector2\");\r\nconst Rectangle = require(\"../utils/rectangle\");\r\nconst TextureAsset = require(\"./texture_asset\");\r\n\r\n\r\n/**\r\n * A font texture asset, dynamically generated from loaded font and canvas.\r\n * This asset type creates an atlas of all the font's characters as textures, so we can later render them as sprites.\r\n */\r\nclass FontTextureAsset extends Asset\r\n{\r\n    /** @inheritdoc */\r\n    constructor(url)\r\n    {\r\n        super(url);\r\n        this._fontName = null;\r\n        this._fontSize = null;\r\n        this._placeholderChar = null;\r\n        this._sourceRects = null;\r\n        this._texture = null;\r\n        this._lineHeight = 0;\r\n    }\r\n\r\n    /**\r\n     * Get line height.\r\n     */\r\n    get lineHeight()\r\n    {\r\n        return this._lineHeight;\r\n    }\r\n\r\n    /**\r\n     * Get font name.\r\n     */\r\n    get fontName()\r\n    {\r\n        return this._fontName;\r\n    }\r\n\r\n    /**\r\n     * Get font size.\r\n     */\r\n    get fontSize()\r\n    {\r\n        return this._fontSize;\r\n    }\r\n\r\n    /**\r\n     * Get placeholder character.\r\n     */\r\n    get placeholderCharacter()\r\n    {\r\n        return this._placeholderChar;\r\n    }\r\n\r\n    /**\r\n     * Get the texture.\r\n     */\r\n    get texture()\r\n    {\r\n        return this._texture;\r\n    }\r\n\r\n    /**\r\n     * Generate the font texture from a font found in given URL.\r\n     * @param {*} params Additional params. Possible values are:\r\n     *                      - fontName: mandatory font name. on some browsers if the font name does not match the font you actually load via the URL, it will not be loaded properly.\r\n     *                      - missingCharPlaceholder (default='?'): character to use for missing characters.\r\n     *                      - smoothFont (default=true): if true, will set font to smooth mode.\r\n     *                      - fontSize (default=52): font size in texture. larget font size will take more memory, but allow for sharper text rendering in larger scales.\r\n     *                      - enforceTexturePowerOfTwo (default=true): if true, will force texture size to be power of two.\r\n     *                      - maxTextureWidth (default=1024): max texture width.\r\n     *                      - charactersSet (default=FontTextureAsset.defaultCharactersSet): which characters to set in the texture.\r\n     *                      - extraPadding (default=0,0): Optional extra padding to add around characters in texture.\r\n     *                      - sourceRectOffsetAdjustment (default=0,0): Optional extra offset in characters source rectangles. Use this for fonts that are too low / height and bleed into other characters source rectangles.\r\n     * @returns {Promise} Promise to resolve when fully loaded.\r\n     */\r\n    load(params)\r\n    {\r\n        return new Promise(async (resolve, reject) => {\r\n            \r\n            if (!params || !params.fontName) {\r\n                return reject(\"When loading font texture you must provide params with a 'fontName' value!\");\r\n            }\r\n        \r\n            // set default missing char placeholder + store it\r\n            this._placeholderChar = (params.missingCharPlaceholder || '?')[0];\r\n    \r\n            // set smoothing mode\r\n            let smooth = params.smoothFont === undefined ? true : params.smoothFont;\r\n\r\n            // set extra margins\r\n            let extraPadding = params.extraPadding || {x: 0, y: 0};\r\n    \r\n            // set max texture size\r\n            let maxTextureWidth = params.maxTextureWidth || 1024;\r\n    \r\n            // default chars set\r\n            let charsSet = params.charactersSet || FontTextureAsset.defaultCharactersSet;\r\n    \r\n            // make sure charSet got the placeholder char\r\n            if (charsSet.indexOf(this._placeholderChar) === -1) {\r\n                charsSet += this._placeholderChar;\r\n            }\r\n    \r\n            // load font\r\n            let fontFace = new FontFace(params.fontName, `url(${this.url})`);\r\n            await fontFace.load();\r\n            document.fonts.add(fontFace);\r\n            \r\n            // store font name and size\r\n            this._fontName = params.fontName;\r\n            this._fontSize = params.fontSize || 52;\r\n            let margin = {x: 10, y: 5};\r\n\r\n            // measure font height\r\n            let fontFullName = this.fontSize.toString() + 'px ' + this.fontName;\r\n            let fontHeight = measureTextHeight(this.fontName, this.fontSize, undefined, extraPadding.y);\r\n            let fontWidth = measureTextWidth(this.fontName, this.fontSize, undefined, extraPadding.x);\r\n\r\n            // set line height\r\n            this._lineHeight = fontHeight;\r\n\r\n            // calc estimated size of a single character in texture\r\n            let estimatedCharSizeInTexture = new Vector2(fontWidth + margin.x * 2, fontHeight + margin.y * 2);\r\n\r\n            // calc texture size\r\n            let charsPerRow = Math.floor(maxTextureWidth / estimatedCharSizeInTexture.x);\r\n            let textureWidth = Math.min(charsSet.length * estimatedCharSizeInTexture.x, maxTextureWidth);\r\n            let textureHeight = Math.ceil(charsSet.length / charsPerRow) * (estimatedCharSizeInTexture.y);\r\n\r\n            // make width and height powers of two\r\n            if (params.enforceTexturePowerOfTwo || params.enforceTexturePowerOfTwo === undefined) {\r\n                textureWidth = makePowerTwo(textureWidth);\r\n                textureHeight = makePowerTwo(textureHeight);\r\n            }\r\n\r\n            // a dictionary to store the source rect of every character\r\n            this._sourceRects = {};\r\n\r\n            // create a canvas to generate the texture on\r\n            let canvas = document.createElement('canvas');\r\n            canvas.width = textureWidth;\r\n            canvas.height = textureHeight;\r\n            if (!smooth) {\r\n                canvas.style.webkitFontSmoothing = \"none\";\r\n                canvas.style.fontSmooth = \"never\";\r\n                canvas.style.textRendering = \"geometricPrecision\";\r\n            }\r\n            let ctx = canvas.getContext('2d');\r\n            ctx.textBaseline =  \"bottom\"\r\n\r\n            // set font and white color\r\n            ctx.font = fontFullName;\r\n            ctx.fillStyle = '#ffffffff';\r\n            ctx.imageSmoothingEnabled = smooth;\r\n\r\n            // draw the font texture\r\n            let x = 0; let y = 0;\r\n            for (let i = 0; i < charsSet.length; ++i) {\r\n                \r\n                // get actual width of current character\r\n                let currChar = charsSet[i];\r\n                let currCharWidth = Math.ceil(ctx.measureText(currChar).width + extraPadding.x);\r\n\r\n                // check if need to break line down in texture\r\n                if (x + currCharWidth > textureWidth) {\r\n                    y += Math.round(fontHeight + margin.y);\r\n                    x = 0;\r\n                }\r\n\r\n                // calc source rect\r\n                const offsetAdjustment = params.sourceRectOffsetAdjustment || {x: 0, y: 0};\r\n                let sourceRect = new Rectangle(x + offsetAdjustment.x, y + offsetAdjustment.y, currCharWidth, fontHeight);\r\n                this._sourceRects[currChar] = sourceRect;\r\n\r\n                // draw character\r\n                ctx.fillText(currChar, x, y + fontHeight);\r\n\r\n                // move to next spot in texture\r\n                x += Math.round(currCharWidth + margin.x);\r\n            }\r\n                    \r\n            // do threshold effect\r\n            if (!smooth) {\r\n                let imageData = ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n                let data = imageData.data;\r\n                for (let i = 0; i < data.length; i += 4) {\r\n                    if (data[i+3] > 0 && (data[i+3] < 255 || data[i] < 255 || data[i+1] < 255 || data[i+2] < 255)) {\r\n                        data[i + 3] = 0;\r\n                    }\r\n                }\r\n                ctx.putImageData(imageData, 0, 0);\r\n            }\r\n\r\n            // convert canvas to image\r\n            let img = new Image();\r\n            img.src = canvas.toDataURL(\"image/png\");\r\n            img.onload = () => {\r\n\r\n                // convert image to texture\r\n                let texture = new TextureAsset(this.url + '__font-texture');\r\n                texture.fromImage(img);\r\n\r\n                // success!\r\n                this._texture = texture;\r\n                this._notifyReady();\r\n                resolve();\r\n\r\n            };\r\n        });\r\n    }\r\n\r\n    /** @inheritdoc */\r\n    get valid()\r\n    {\r\n        return Boolean(this._texture);\r\n    }\r\n    \r\n    /**\r\n     * Get the source rectangle for a given character in texture.\r\n     * @param {Character} character Character to get source rect for.\r\n     * @returns {Rectangle} Source rectangle for character.\r\n     */\r\n    getSourceRect(character)\r\n    {\r\n        return this._sourceRects[character] || this._sourceRects[this.placeholderCharacter];\r\n    }\r\n\r\n    /**\r\n     * When drawing the character, get the offset to add to the cursor.\r\n     * @param {Character} character Character to get the offset for.\r\n     * @returns {Vector2} Offset to add to the cursor before drawing the character.\r\n     */\r\n    getPositionOffset (character) {\r\n        return Vector2.zero;\r\n    }\r\n\r\n    /**\r\n     * Get how much to advance the cursor when drawing this character.\r\n     * @param {Character} character Character to get the advance for.\r\n     * @returns {Number} Distance to move the cursor after drawing the character.\r\n     */\r\n    getXAdvance (character) {\r\n        return this.getSourceRect(character).width;\r\n    }\r\n\r\n    /** @inheritdoc */\r\n    destroy()\r\n    {\r\n        if (this._texture) this._texture.destroy();\r\n        this._fontName = null;\r\n        this._fontSize = null;\r\n        this._placeholderChar = null;\r\n        this._sourceRects = null;\r\n        this._texture = null;\r\n        this._lineHeight = 0;\r\n    }\r\n}\r\n\r\n// default ascii characters to generate font textures for\r\nFontTextureAsset.defaultCharactersSet = \" !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u00A0\u00A1\u00A2\u00A3\u00A4\u00A5\u00A6\u00A7\u00A8\u00A9\u00AA\u00AB\u00AC\u00AD\u00AE\u00AF\u00B0\u00B1\u00B2\u00B3\u00B4\u00B5\u00B6\u00B7\u00B8\u00B9\u00BA\u00BB\u00BC\u00BD\u00BE\";\r\n\r\n// return the closest power-of-two value to a given number\r\nfunction makePowerTwo(val)\r\n{\r\n    let ret = 2;\r\n    while (ret < val) {\r\n        if (ret >= val) { return ret; }\r\n        ret = ret * 2;\r\n    }\r\n    return ret;\r\n}\r\n\r\n\r\n/**\r\n * Measure font's actual height.\r\n */\r\nfunction measureTextHeight(fontFamily, fontSize, char, extraHeight) \r\n{\r\n    let text = document.createElement('pre');\r\n    text.style.fontFamily = fontFamily;\r\n    text.style.fontSize = fontSize + \"px\";\r\n    text.style.paddingBottom = text.style.paddingLeft = text.style.paddingTop = text.style.paddingRight = '0px';\r\n    text.style.marginBottom = text.style.marginLeft = text.style.marginTop = text.style.marginRight = '0px';\r\n    text.textContent = char || \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 \";\r\n    document.body.appendChild(text);\r\n    let result = text.getBoundingClientRect().height + (extraHeight || 0);\r\n    document.body.removeChild(text);\r\n    return Math.ceil(result);\r\n};\r\n\r\n/**\r\n * Measure font's actual width.\r\n */\r\nfunction measureTextWidth(fontFamily, fontSize, char, extraWidth) \r\n{\r\n    // special case to ignore \\r and \\n when measuring text width\r\n    if (char === '\\n' || char === '\\r') { return 0; }\r\n\r\n    // measure character width\r\n    let canvas = document.createElement(\"canvas\");\r\n    let context = canvas.getContext(\"2d\");\r\n    context.font = fontSize.toString() + 'px ' + fontFamily;\r\n    let result = 0;\r\n    let text = char || \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 \";\r\n    for (let i = 0; i < text.length; ++i) {\r\n        result = Math.max(result, context.measureText(text[i]).width + (extraWidth || 0));\r\n    }\r\n    return Math.ceil(result);\r\n};\r\n\r\n// export the asset type.\r\nmodule.exports = FontTextureAsset;", "/**\r\n * Implement json asset type.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\assets\\json_asset.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst Asset = require(\"./asset\");\r\n\r\n\r\n/**\r\n * A loadable json asset.\r\n * This asset type loads JSON from a remote file.\r\n */\r\nclass JsonAsset extends Asset\r\n{\r\n    /** @inheritdoc */\r\n    constructor(url)\r\n    {\r\n        super(url);\r\n        this._data = null;\r\n    }\r\n\r\n    /**\r\n     * Load the JSON data from the asset URL.\r\n     * @returns {Promise} Promise to resolve when fully loaded.\r\n     */\r\n    load()\r\n    {\r\n        return new Promise((resolve, reject) => {\r\n\r\n            var request = new XMLHttpRequest();\r\n            request.open('GET', this.url, true);\r\n            request.responseType = 'json';     \r\n\r\n            // on load, validate audio content\r\n            request.onload = () => \r\n            {\r\n                if (request.readyState == 4) {\r\n                    if (request.response) {\r\n                        this._data = request.response;\r\n                        this._notifyReady();\r\n                        resolve();\r\n                    }\r\n                    else {\r\n                        if (request.status === 200) {\r\n                            reject(\"Response is not a valid JSON!\");\r\n                        }\r\n                        else {\r\n                            reject(request.statusText);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // on load error, reject\r\n            request.onerror = (e) => {\r\n                reject(e);\r\n            }\r\n\r\n            // initiate request\r\n            request.send();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Create the JSON data asset from object or string.\r\n     * @param {Object|String} source Data to create asset from.\r\n     * @returns {Promise} Promise to resolve when asset is ready.\r\n     */\r\n    create(source)\r\n    {\r\n        return new Promise((resolve, reject) => {\r\n\r\n            // make sure data is a valid json + clone it\r\n            try\r\n            {\r\n                if (source) {\r\n                    if (typeof source === 'string') {\r\n                        source = JSON.parse(source);\r\n                    }\r\n                    else {\r\n                        source = JSON.parse(JSON.stringify(source));\r\n                    }\r\n                }\r\n                else {\r\n                    source = {};\r\n                }\r\n            }\r\n            catch (e)\r\n            {\r\n                return reject(\"Data is not a valid JSON serializable object!\");\r\n            }\r\n\r\n            // store data and resolve\r\n            this._data = source;\r\n            this._notifyReady();\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Get json data.\r\n     * @returns {*} Data as dictionary.\r\n     */\r\n    get data()\r\n    {\r\n        return this._data;\r\n    }\r\n\r\n    /** @inheritdoc */\r\n    get valid()\r\n    {\r\n        return Boolean(this._data);\r\n    }\r\n    \r\n    /** @inheritdoc */\r\n    destroy()\r\n    {\r\n        this._data = null;\r\n    }\r\n}\r\n\r\n\r\n// export the asset type.\r\nmodule.exports = JsonAsset;", "/**\r\n * Implement a MSDF font texture asset type.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\assets\\msdf_font_texture_asset.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst Vector2 = require(\"../utils/vector2\");\r\nconst Rectangle = require(\"../utils/rectangle\");\r\nconst TextureAsset = require(\"./texture_asset\");\r\nconst FontTextureAsset = require('./font_texture_asset')\r\nconst JsonAsset = require('./json_asset')\r\n\r\n\r\n/**\r\n * A MSDF font texture asset, from a pregenerated msdf texture atlas (from msdf-bmfont-xml, for example).\r\n * This asset uses a signed distance field atlas to render characters as sprites at high res.\r\n */\r\nclass MsdfFontTextureAsset extends FontTextureAsset\r\n{\r\n    /** @inheritdoc */\r\n    constructor(url)\r\n    {\r\n        super(url)\r\n        this._positionOffsets = null\r\n        this._xAdvances = null\r\n    }\r\n\r\n    /**\r\n     * Generate the font metadata and texture from the given URL.\r\n     * @param {*} params Additional params. Possible values are:\r\n     *                      - jsonUrl: mandatory url for the font's json metadata (generated via msdf-bmfont-xml, for example)\r\n     *                      - textureUrl: mandatory url for the font's texture atlas (generated via msdf-bmfont-xml, for example)\r\n     *                      - missingCharPlaceholder (default='?'): character to use for missing characters.\r\n     *                      \r\n     * @returns {Promise} Promise to resolve when fully loaded.\r\n     */\r\n    load(params)\r\n    {\r\n        return new Promise(async (resolve, reject) => {\r\n            \r\n            if (!params || !params.jsonUrl || !params.textureUrl) {\r\n                return reject(\"When loading an msdf font you must provide params with a 'jsonUrl' and a 'textureUrl'!\");\r\n            }\r\n\r\n            // TODO: allow atlas with multiple textures\r\n            // TODO: infer textureUrl from json contents\r\n            // TODO: infer jsonUrl from url\r\n\r\n            let atlas_json = new JsonAsset(params.jsonUrl);\r\n            let atlas_texture = new TextureAsset(params.textureUrl);\r\n            await Promise.all([atlas_json.load(), atlas_texture.load()]);\r\n\r\n            let atlas_metadata = atlas_json.data;\r\n            atlas_texture.filter = \"LINEAR\";\r\n\r\n            if (atlas_metadata.common.pages > 1) {\r\n                throw new Error(\"Can't use MSDF font with several pages\");\r\n            }\r\n\r\n            // set default missing char placeholder + store it\r\n            this._placeholderChar = (params.missingCharPlaceholder || '?')[0];\r\n\r\n            if (!atlas_metadata.info.charset.includes(this._placeholderChar)) {\r\n                throw new Error(\"The atlas' charset doesn't include the given placeholder character\");\r\n            }\r\n\r\n            this._fontName = atlas_metadata.info.face;\r\n            this._fontSize = atlas_metadata.info.size;\r\n\r\n            // set line height\r\n            this._lineHeight = atlas_metadata.common.lineHeight;\r\n\r\n            // dictionaries to store per-character data\r\n            this._sourceRects = {};\r\n            this._positionOffsets = {};\r\n            this._xAdvances = {};\r\n            this._kernings = {};\r\n\r\n            for (const charData of atlas_metadata.chars) {\r\n                let currChar = charData.char;\r\n        \r\n                let sourceRect = new Rectangle(charData.x, charData.y, charData.width, charData.height)\r\n                this._sourceRects[currChar] = sourceRect;\r\n                this._positionOffsets[currChar] = new Vector2(\r\n                  charData.xoffset,\r\n                  charData.yoffset\r\n                )\r\n                this._xAdvances[currChar] = charData.xadvance\r\n            }\r\n\r\n            this._texture = atlas_texture;\r\n            this._notifyReady();\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    /** @inheritdoc */\r\n    getPositionOffset (character) {\r\n        return this._positionOffsets[character] || this._positionOffsets[this.placeholderCharacter];\r\n    }\r\n\r\n    /** @inheritdoc */\r\n    getXAdvance (character) {\r\n        return this._xAdvances[character] || this._xAdvances[this.placeholderCharacter];\r\n    }\r\n\r\n    /** @inheritdoc */\r\n    destroy()\r\n    {\r\n        super.destroy();\r\n        this._positionOffsets = null\r\n        this._xAdvances = null\r\n        this._kernings = null\r\n    }\r\n}\r\n\r\n// export the asset type.\r\nmodule.exports = MsdfFontTextureAsset;", "/**\r\n * Define possible text alignments.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\text_alignment.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\n/** @typedef {String} TextAlignment */\r\n\r\n/**\r\n * Possible text alignments.\r\n * @readonly\r\n * @enum {TextAlignment}\r\n */\r\nconst TextAlignments = {\r\n\r\n    /**\r\n     * Align text left-to-right.\r\n     */\r\n    Left: \"left\",\r\n\r\n    /**\r\n     * Align text right-to-left.\r\n     */\r\n    Right: \"right\",\r\n\r\n    /**\r\n     * Align text to center.\r\n     */\r\n    Center: \"center\",\r\n};\r\n\r\nObject.freeze(TextAlignments);\r\nmodule.exports = {TextAlignments: TextAlignments};", "/**\r\n * Implement the gfx sprite batch renderer.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\sprite_batch.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst { Rectangle, Color } = require('../utils');\r\nconst Vector2 = require('../utils/vector2');\r\nconst Vertex = require('./vertex');\r\nconst { BlendModes } = require('./blend_modes');\r\nconst Matrix = require('./matrix');\r\nconst Mesh = require('./mesh');\r\nconst _logger = require('../logger.js').getLogger('gfx');\r\n\r\n\r\n/**\r\n * Sprite batch renderer, responsible on drawing a batch of sprites with as little draw calls as possible.\r\n */\r\nclass SpriteBatch\r\n{\r\n    /**\r\n     * Create the spritebatch.\r\n     * @param {Gfx} gfx Gfx manager.\r\n     */\r\n    constructor(gfx)\r\n    {\r\n        this._gfx = gfx;\r\n        this._gl = gfx._gl;\r\n        this._positions = gfx._dynamicBuffers.positionArray;\r\n        this._uvs = gfx._dynamicBuffers.textureArray;\r\n        this._colors = gfx._dynamicBuffers.colorsArray;\r\n        this._positionsBuff = gfx._dynamicBuffers.positionBuffer;\r\n        this._uvsBuff = gfx._dynamicBuffers.textureCoordBuffer;\r\n        this._colorsBuff = gfx._dynamicBuffers.colorsBuffer;\r\n        this._indexBuff = gfx._dynamicBuffers.indexBuffer;\r\n\r\n        /** \r\n         * If true, will floor vertices positions before pushing them to batch.\r\n         */\r\n        this.snapPixels = true;\r\n\r\n        /**\r\n         * If true, will slightly offset texture uv when rotating sprites, to prevent bleeding while using texture atlas.\r\n         */\r\n        this.applyAntiBleeding = true;\r\n    }\r\n\r\n    /**\r\n     * Create and return a new vertex.\r\n     * @param {Vector2} position Vertex position.\r\n     * @param {Vector2} textureCoord Vertex texture coord.\r\n     * @param {Color} color Vertex color.\r\n     * @returns {Vertex} new vertex object.\r\n     */\r\n    vertex(position, textureCoord, color)\r\n    {\r\n        return new Vertex(position, textureCoord, color);\r\n    }\r\n\r\n    /**\r\n     * Get if batch is currently drawing.\r\n     * @returns {Boolean} True if batch is drawing.\r\n     */\r\n    get drawing()\r\n    {\r\n        return this._drawing;\r\n    }\r\n\r\n    /**\r\n     * Start drawing a batch.\r\n     * @param {Effect} effect Effect to use.\r\n     * @param {Matrix} transform Optional transformations to apply on all sprites.\r\n     */\r\n    begin(effect, transform)\r\n    {\r\n        if (this._drawing) {\r\n            _logger.error(\"Start drawing a batch while already drawing a batch!\");\r\n        }\r\n\r\n        if (effect) {\r\n            this._gfx.useEffect(effect);\r\n        }\r\n        this._effect = this._gfx._activeEffect;\r\n\r\n        this._currBlend = BlendModes.AlphaBlend;\r\n        this._currTexture = null;\r\n        this._currBatchCount = 0;\r\n\r\n        this._transform = transform;\r\n\r\n        this._drawing = true;\r\n    }\r\n\r\n    /**\r\n     * Finish drawing batch (and render whatever left in buffers).\r\n     */\r\n    end()\r\n    {\r\n        if (!this._drawing) {\r\n            _logger.error(\"Stop drawing a batch without starting it first!\");\r\n        }\r\n\r\n        if (this._currBatchCount) {\r\n            this._drawCurrentBatch();\r\n        }\r\n        this._drawing = false;\r\n    }\r\n\r\n    /**\r\n     * Set the currently active texture.\r\n     * @param {Texture} texture Texture to set.\r\n     */\r\n    setTexture(texture)\r\n    {\r\n        if (texture !== this._currTexture) {\r\n            if (this._currBatchCount) {\r\n                this._drawCurrentBatch();\r\n            }\r\n            this._currTexture = texture;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Add sprite to batch.\r\n     * Note: changing texture or blend mode may trigger a draw call.\r\n     * @param {Sprite|Array<Sprite>} sprites Sprite or multiple sprites to draw.\r\n     * @param {Boolean} cullOutOfScreen If true, will cull sprites that are not visible.\r\n     */\r\n    draw(sprites, cullOutOfScreen)\r\n    {\r\n        // if single sprite, turn to array\r\n        if (sprites.length === undefined) { sprites = [sprites]; }\r\n\r\n        // get visible region\r\n        let region = cullOutOfScreen ? this._gfx.getRenderingRegion() : null;\r\n\r\n        // get buffers\r\n        let positions = this._positions;\r\n        let uvs = this._uvs;\r\n        let colors = this._colors;\r\n        \r\n        for (let sprite of sprites) {\r\n\r\n            // if texture changed, blend mode changed, or we have too many indices - draw current batch\r\n            if (this._currBatchCount) {\r\n                if ((this._currBatchCount >= this.batchSpritesCount) || \r\n                    (sprite.blendMode !== this._currBlend) || \r\n                    (sprite.texture !== this._currTexture)) {\r\n                    this._drawCurrentBatch();\r\n                }\r\n            }\r\n\r\n            // set texture and blend (used internally when drawing batch)\r\n            this._currTexture = sprite.texture;\r\n            this._currBlend = sprite.blendMode;\r\n\r\n            // set colors batch\r\n            let ci = this._currBatchCount * 4 * 4;\r\n\r\n            // array of colors\r\n            if (sprite.color instanceof Array) {\r\n                let lastColor = sprite.color[0];\r\n                for (let x = 0; x < 4; ++x) {\r\n                    let curr = (sprite.color[x] || lastColor);\r\n                    colors[ci + x*4 + 0] = curr.r;\r\n                    colors[ci + x*4 + 1] = curr.g;\r\n                    colors[ci + x*4 + 2] = curr.b;\r\n                    colors[ci + x*4 + 3] = curr.a;\r\n                    lastColor = curr;\r\n                }\r\n            }\r\n            // single color\r\n            else {\r\n                for (let x = 0; x < 4; ++x) {\r\n                    colors[ci + x*4 + 0] = sprite.color.r;\r\n                    colors[ci + x*4 + 1] = sprite.color.g;\r\n                    colors[ci + x*4 + 2] = sprite.color.b;\r\n                    colors[ci + x*4 + 3] = sprite.color.a;\r\n                }\r\n            }\r\n\r\n            // check if its a static sprite with cached properties. if so, we'll use it.\r\n            if (sprite.static && sprite._cachedVertices) {\r\n\r\n                // get vertices from cache\r\n                let topLeft = sprite._cachedVertices[0];\r\n                let topRight = sprite._cachedVertices[1];\r\n                let bottomLeft = sprite._cachedVertices[2];\r\n                let bottomRight = sprite._cachedVertices[3];\r\n\r\n                // set positions\r\n                let pi = this._currBatchCount * 4 * 3;\r\n                positions[pi+0] = topLeft.position.x;             positions[pi+1] = topLeft.position.y;             positions[pi+2] = topLeft.position.z || 0;\r\n                positions[pi+3] = topRight.position.x;            positions[pi+4] = topRight.position.y;            positions[pi+5] = topRight.position.z || 0;\r\n                positions[pi+6] = bottomLeft.position.x;          positions[pi+7] = bottomLeft.position.y;          positions[pi+8] = bottomLeft.position.z || 0;\r\n                positions[pi+9] = bottomRight.position.x;         positions[pi+10] = bottomRight.position.y;        positions[pi+11] = bottomRight.position.z || 0;\r\n        \r\n                // set uvs\r\n                let uvi = this._currBatchCount * 4 * 2;\r\n                uvs[uvi+0] = topLeft.uv.x;          uvs[uvi+1] = topLeft.uv.y;\r\n                uvs[uvi+2] = bottomRight.uv.x;      uvs[uvi+3] = topLeft.uv.y;\r\n                uvs[uvi+4] = topLeft.uv.x;          uvs[uvi+5] = bottomRight.uv.y;\r\n                uvs[uvi+6] = bottomRight.uv.x;      uvs[uvi+7] = bottomRight.uv.y;\r\n\r\n                // increase sprites count and continue\r\n                this._currBatchCount++;\r\n                continue;\r\n            }\r\n\r\n            // calculate vertices positions\r\n            let sizeX = sprite.size.x;\r\n            let sizeY = sprite.size.y;\r\n            let left = -sizeX * sprite.origin.x;\r\n            let top = -sizeY * sprite.origin.y;\r\n\r\n            // calculate corners\r\n            let topLeft = new Vector2(left, top);\r\n            let topRight = new Vector2(left + sizeX, top);\r\n            let bottomLeft = new Vector2(left, top + sizeY);\r\n            let bottomRight = new Vector2(left + sizeX, top + sizeY);\r\n\r\n            // apply skew\r\n            if (sprite.skew) {\r\n                if (sprite.skew.x) {\r\n                    topLeft.x += sprite.skew.x * sprite.origin.y;\r\n                    topRight.x += sprite.skew.x * sprite.origin.y;\r\n                    bottomLeft.x -= sprite.skew.x * (1 - sprite.origin.y);\r\n                    bottomRight.x -= sprite.skew.x * (1 - sprite.origin.y);\r\n                }\r\n                if (sprite.skew.y) {\r\n                    topLeft.y += sprite.skew.y * sprite.origin.x;\r\n                    bottomLeft.y += sprite.skew.y * sprite.origin.x;\r\n                    topRight.y -= sprite.skew.y * (1 - sprite.origin.x);\r\n                    bottomRight.y -= sprite.skew.y * (1 - sprite.origin.x);\r\n                }\r\n            }\r\n\r\n            // apply rotation\r\n            if (sprite.rotation) {\r\n                let cos = Math.cos(sprite.rotation);\r\n                let sin = Math.sin(sprite.rotation);\r\n                function rotateVec(vector)\r\n                {\r\n                    let x = (vector.x * cos - vector.y * sin);\r\n                    let y = (vector.x * sin + vector.y * cos);\r\n                    vector.set(x, y);\r\n                }\r\n                rotateVec(topLeft);\r\n                rotateVec(topRight);\r\n                rotateVec(bottomLeft);\r\n                rotateVec(bottomRight);\r\n            }\r\n\r\n            // add sprite position\r\n            topLeft.addSelf(sprite.position);\r\n            topRight.addSelf(sprite.position);\r\n            bottomLeft.addSelf(sprite.position);\r\n            bottomRight.addSelf(sprite.position);\r\n\r\n            // snap pixels\r\n            if (this.snapPixels)\r\n            {\r\n                topLeft.floorSelf();\r\n                topRight.floorSelf();\r\n                bottomLeft.floorSelf();\r\n                bottomRight.floorSelf();\r\n            }\r\n\r\n            // optional z position\r\n            let z = sprite.position.z || 0;\r\n            let zDepth = sprite.size.z || 0;\r\n\r\n            // cull out-of-screen sprites\r\n            if (cullOutOfScreen)\r\n            {\r\n                let destRect = Rectangle.fromPoints([topLeft, topRight, bottomLeft, bottomRight]);\r\n                if (!region.collideRect(destRect)) {\r\n                    continue;\r\n                }\r\n            }\r\n\r\n            // update positions buffer\r\n            let pi = this._currBatchCount * 4 * 3;\r\n            positions[pi+0] = topLeft.x;             positions[pi+1] = topLeft.y;             positions[pi+2] = z;\r\n            positions[pi+3] = topRight.x;            positions[pi+4] = topRight.y;            positions[pi+5] = z;\r\n            positions[pi+6] = bottomLeft.x;          positions[pi+7] = bottomLeft.y;          positions[pi+8] = z + zDepth;\r\n            positions[pi+9] = bottomRight.x;         positions[pi+10] = bottomRight.y;        positions[pi+11] = z + zDepth;\r\n\r\n            // set uvs buffer\r\n            let uvi = this._currBatchCount * 4 * 2;\r\n            var uvTl;\r\n            var uvBr;\r\n\r\n            // got source rect, apply uvs\r\n            if (sprite.sourceRect) {\r\n                uvTl = {x: sprite.sourceRect.x / this._currTexture.width, y: sprite.sourceRect.y / this._currTexture.height};\r\n                uvBr = {x: uvTl.x + (sprite.sourceRect.width / this._currTexture.width), y: uvTl.y + (sprite.sourceRect.height / this._currTexture.height)};\r\n                if (sprite.rotation && this.applyAntiBleeding) {\r\n                    let marginX = 0.015 / this._currTexture.width;\r\n                    let marginY = 0.015 / this._currTexture.height;\r\n                    uvTl.x += marginX;\r\n                    uvBr.x -= marginX * 2;\r\n                    uvTl.y += marginY;\r\n                    uvBr.y -= marginY * 2;\r\n                }\r\n                uvs[uvi+0] = uvTl.x;  uvs[uvi+1] = uvTl.y;\r\n                uvs[uvi+2] = uvBr.x;  uvs[uvi+3] = uvTl.y;\r\n                uvs[uvi+4] = uvTl.x;  uvs[uvi+5] = uvBr.y;\r\n                uvs[uvi+6] = uvBr.x;  uvs[uvi+7] = uvBr.y;\r\n            }\r\n            // no source rect, take entire texture\r\n            else {\r\n                uvs[uvi+0] = 0;  uvs[uvi+1] = 0;\r\n                uvs[uvi+2] = 1;  uvs[uvi+3] = 0;\r\n                uvs[uvi+4] = 0;  uvs[uvi+5] = 1;\r\n                uvs[uvi+6] = 1;  uvs[uvi+7] = 1;\r\n            }\r\n\r\n            // set cached vertices\r\n            if (sprite.static) {\r\n                sprite._cachedVertices = [\r\n                    {position: topLeft, uv: uvTl || {x:0, y:0}},\r\n                    {position: topRight},\r\n                    {position: bottomLeft},\r\n                    {position: bottomRight, uv: uvBr || {x:1, y:1}},\r\n                ];\r\n            }\r\n                    \r\n            // increase sprites count\r\n            this._currBatchCount++;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Push vertices directly to batch.\r\n     * @param {Array<Vertex>} vertices Vertices to push.\r\n     */\r\n    pushVertices(vertices)\r\n    {\r\n        // sanity\r\n        if (!vertices || vertices.length !== 4) {\r\n            throw new Error(\"Vertices must be array of 4 values!\");\r\n        }\r\n\r\n        // get buffers and offset\r\n        let positions = this._positions;\r\n        let uvs = this._uvs;\r\n        let colors = this._colors;\r\n\r\n        // push colors\r\n        for (let i = 0; i < vertices.length; ++i) \r\n        {\r\n            let vertex = vertices[i];\r\n            let ci = (this._currBatchCount * (4 * 4)) + (i * 4);\r\n            colors[ci + 0] = vertex.color.r;\r\n            colors[ci + 1] = vertex.color.g;\r\n            colors[ci + 2] = vertex.color.b;\r\n            colors[ci + 3] = vertex.color.a;\r\n        }\r\n\r\n        // push positions\r\n        let topLeft = vertices[0].position;\r\n        let topRight = vertices[1].position;\r\n        let bottomLeft = vertices[2].position;\r\n        let bottomRight = vertices[3].position;\r\n        let pi = this._currBatchCount * 4 * 3;\r\n        positions[pi+0] = topLeft.x;             positions[pi+1] = topLeft.y;             positions[pi+2] = topLeft.z || 0;\r\n        positions[pi+3] = topRight.x;            positions[pi+4] = topRight.y;            positions[pi+5] = topRight.z || 0;\r\n        positions[pi+6] = bottomLeft.x;          positions[pi+7] = bottomLeft.y;          positions[pi+8] = bottomLeft.z || 0;\r\n        positions[pi+9] = bottomRight.x;         positions[pi+10] = bottomRight.y;        positions[pi+11] = bottomRight.z || 0;\r\n\r\n        // set texture coords\r\n        let uvi = (this._currBatchCount * (4 * 2));\r\n        uvs[uvi++] = vertices[0].textureCoord.x / this._currTexture.width; \r\n        uvs[uvi++] = vertices[0].textureCoord.y / this._currTexture.height;\r\n        uvs[uvi++] = vertices[1].textureCoord.x / this._currTexture.width; \r\n        uvs[uvi++] = vertices[1].textureCoord.y / this._currTexture.height;\r\n        uvs[uvi++] = vertices[2].textureCoord.x / this._currTexture.width; \r\n        uvs[uvi++] = vertices[2].textureCoord.y / this._currTexture.height;\r\n        uvs[uvi++] = vertices[3].textureCoord.x / this._currTexture.width; \r\n        uvs[uvi++] = vertices[3].textureCoord.y / this._currTexture.height;\r\n\r\n        // increase batch count\r\n        this._currBatchCount++;\r\n    }\r\n\r\n    /**\r\n     * How many sprites we can have in batch, in total.\r\n     */\r\n    get batchSpritesCount()\r\n    {\r\n        return this._gfx.batchSpritesCount;\r\n    }\r\n\r\n    /**\r\n     * Draw current batch.\r\n     * @private\r\n     */\r\n    _drawCurrentBatch()\r\n    {\r\n        // get some members\r\n        let gl = this._gl;\r\n        let transform = this._transform;\r\n        let positionArray = this._positions;\r\n        let textureArray = this._uvs;\r\n        let colorsArray = this._colors;\r\n        let positionBuffer = this._positionsBuff;\r\n        let textureCoordBuffer = this._uvsBuff;\r\n        let colorsBuffer = this._colorsBuff;\r\n        let indexBuffer = this._indexBuff;\r\n\r\n        // some sanity checks\r\n        if (this._effect !== this._gfx._activeEffect) {\r\n            _logger.error(\"Effect changed while drawing batch!\");\r\n        }\r\n\r\n        // set blend mode if needed\r\n        this._gfx._setBlendMode(this._currBlend);\r\n\r\n        // prepare effect and texture\r\n        let mesh = new Mesh(positionBuffer, textureCoordBuffer, colorsBuffer, indexBuffer, this._currBatchCount * 6);\r\n        this._gfx._activeEffect.prepareToDrawBatch(mesh, transform || Matrix.identity);\r\n        this._gfx._setActiveTexture(this._currTexture);\r\n\r\n        // should we slice the arrays?\r\n        let shouldSliceArrays = this._currBatchCount < this.batchSpritesCount / 2;\r\n\r\n        // copy position buffer\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, \r\n            shouldSliceArrays ? positionArray.slice(0, this._currBatchCount * 4 * 3) : positionArray, \r\n            gl.DYNAMIC_DRAW);\r\n\r\n        // copy texture buffer\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, textureCoordBuffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, \r\n            shouldSliceArrays ? textureArray.slice(0, this._currBatchCount * 4 * 2) : textureArray, \r\n            gl.DYNAMIC_DRAW);\r\n\r\n        // copy color buffer\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, colorsBuffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, \r\n            shouldSliceArrays ? colorsArray.slice(0, this._currBatchCount * 4 * 4) : colorsArray, \r\n            gl.DYNAMIC_DRAW);\r\n\r\n        // set indices\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);\r\n        this._currIndices = null;\r\n\r\n        // draw elements\r\n        gl.drawElements(gl.TRIANGLES, this._currBatchCount * 6, gl.UNSIGNED_SHORT, 0);\r\n        this._gfx._drawCallsCount++;\r\n        this._gfx._drawQuadsCount += this._currBatchCount;\r\n\r\n        // reset current counter\r\n        this._currBatchCount = 0;\r\n    }\r\n}\r\n\r\n\r\n// export the sprite batch class\r\nmodule.exports = SpriteBatch;", "/**\r\n * Implement the gfx manager.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\gfx.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst IManager = require('../manager.js');\r\nconst Color = require('../utils/color.js');\r\nconst { BlendMode, BlendModes } = require('./blend_modes.js');\r\nconst Rectangle = require('../utils/rectangle.js');\r\nconst { Effect, BasicEffect, MsdfFontEffect } = require('./effects');\r\nconst TextureAsset = require('../assets/texture_asset.js');\r\nconst { TextureFilterMode, TextureFilterModes } = require('./texture_filter_modes.js');\r\nconst { TextureWrapMode, TextureWrapModes } = require('./texture_wrap_modes.js');\r\nconst MeshGenerator = require('./mesh_generator.js');\r\nconst Matrix = require('./matrix.js');\r\nconst Camera = require('./camera.js');\r\nconst Sprite = require('./sprite.js');\r\nconst SpritesGroup = require('./sprites_group.js');\r\nconst Vector2 = require('../utils/vector2.js');\r\nconst FontTextureAsset = require('../assets/font_texture_asset.js');\r\nconst MsdfFontTextureAsset = require('../assets/msdf_font_texture_asset.js');\r\nconst { TextAlignment, TextAlignments } = require('./text_alignments.js');\r\nconst Mesh = require('./mesh.js');\r\nconst Circle = require('../utils/circle.js');\r\nconst SpriteBatch = require('./sprite_batch.js');\r\nconst Vector3 = require('../utils/vector3.js');\r\nconst Vertex = require('./vertex');\r\nconst _whiteColor = Color.white;\r\nconst _logger = require('../logger.js').getLogger('gfx');\r\n\r\n\r\n/**\r\n * Gfx is the graphics manager. \r\n * Everything related to rendering and managing your game canvas goes here.\r\n * \r\n * To access the Graphics manager you use `Shaku.gfx`. \r\n */\r\nclass Gfx extends IManager\r\n{\r\n    /**\r\n     * Create the manager.\r\n     */\r\n    constructor()\r\n    {\r\n        super();\r\n        this._gl = null;\r\n        this._initSettings = { antialias: true, alpha: true, depth: false, premultipliedAlpha: true, desynchronized: false };\r\n        this._canvas = null;\r\n        this._lastBlendMode = null;\r\n        this._activeEffect = null;\r\n        this._camera = null;\r\n        this._projection = null;\r\n        this._currIndices = null;\r\n        this._dynamicBuffers = null;\r\n        this._fb = null;\r\n        /**\r\n         * Built in Effects.\r\n         * @type {{Basic: Effect, MsdfFont: Effect}\r\n         * @public\r\n         */\r\n        this.builtinEffects = {};\r\n        this.meshes = {};\r\n        this.defaultTextureFilter = TextureFilterModes.Nearest;\r\n        this.defaultTextureWrapMode = TextureWrapModes.Clamp;\r\n        this.whiteTexture = null;\r\n        this._renderTarget = null;\r\n        this._viewport = null;\r\n        this._drawCallsCount = 0;\r\n        this._drawQuadsCount = 0;\r\n        this.spritesBatch = null;\r\n    }\r\n\r\n    /**\r\n     * Get how many sprites we can draw in a single batch.\r\n     * @private\r\n     * @returns {Number} batch max sprites count.\r\n     */\r\n    get batchSpritesCount()\r\n    {\r\n        return 2048;\r\n    }\r\n\r\n    /**\r\n     * Maximum number of vertices we allow when drawing lines.\r\n     * @private\r\n     * @returns {Number} max vertices per lines strip.\r\n     */\r\n    get maxLineSegments()\r\n    {\r\n        return 512;\r\n    }\r\n\r\n    /**\r\n     * Set WebGL init flags (passed as additional params to the getContext() call). \r\n     * You must call this *before* initializing *Shaku*.\r\n     * \r\n     * By default, *Shaku* will init WebGL context with the following flags:\r\n     * - antialias: true.\r\n     * - alpha: true.\r\n     * - depth: false.\r\n     * - premultipliedAlpha: true.\r\n     * - desynchronized: false.\r\n     * @example\r\n     * Shaku.gfx.setContextAttributes({ antialias: true, alpha: false });\r\n     * @param {Dictionary} flags WebGL init flags to set.\r\n     */\r\n    setContextAttributes(flags)\r\n    {\r\n        if (this._gl) { throw new Error(\"Can't call setContextAttributes() after gfx was initialized!\"); }\r\n        this._initSettings = flags;\r\n    }\r\n\r\n    /**\r\n     * Set the canvas element to initialize on.\r\n     * You must call this *before* initializing Shaku. Calling this will prevent Shaku from creating its own canvas.\r\n     * @example\r\n     * Shaku.gfx.setCanvas(document.getElementById('my-canvas')); \r\n     * @param {HTMLCanvasElement} element Canvas element to initialize on.\r\n     */\r\n    setCanvas(element)\r\n    {\r\n        if (this._gl) { throw new Error(\"Can't call setCanvas() after gfx was initialized!\"); }\r\n        this._canvas = element;\r\n    }\r\n\r\n    /**\r\n     * Get the canvas element controlled by the gfx manager.\r\n     * If you didn't provide your own canvas before initialization, you must add this canvas to your document after initializing `Shaku`.\r\n     * @example\r\n     * document.body.appendChild(Shaku.gfx.canvas);\r\n     * @returns {HTMLCanvasElement} Canvas we use for rendering.\r\n     */\r\n    get canvas()\r\n    {\r\n        return this._canvas;\r\n    }\r\n\r\n    /**\r\n     * Get the Effect base class, which is required to implement custom effects.\r\n     * @see Effect\r\n     */\r\n    get Effect()\r\n    {\r\n        return Effect;\r\n    }\r\n\r\n    /**\r\n     * Get the default Effect class, which is required to implement custom effects that inherit and reuse parts from the default effect.\r\n     * @see BasicEffect\r\n     */\r\n    get BasicEffect()\r\n    {\r\n        return BasicEffect;\r\n    }\r\n    \r\n    /**\r\n     * Get the Effect for rendering fonts with an MSDF texture.\r\n     * @see MsdfFontEffect\r\n     */\r\n    get MsdfFontEffect()\r\n    {\r\n        return MsdfFontEffect;\r\n    }    \r\n\r\n    /**\r\n     * Get the sprite class.\r\n     * @see Sprite\r\n     */\r\n    get Sprite()\r\n    {\r\n        return Sprite;\r\n    }\r\n\r\n    /**\r\n     * Get the sprites group object.\r\n     * @see SpritesGroup\r\n     */\r\n    get SpritesGroup()\r\n    {\r\n        return SpritesGroup;\r\n    }\r\n\r\n    /**\r\n     * Get the matrix object.\r\n     * @see Matrix\r\n     */\r\n    get Matrix()\r\n    {\r\n        return Matrix;\r\n    }\r\n\r\n    /**\r\n     * Get the vertex object.\r\n     * @see Vertex\r\n     */\r\n    get Vertex()\r\n    {\r\n        return Vertex;\r\n    }\r\n\r\n    /**\r\n     * Get the text alignments options.\r\n     * * Left: align text to the left.\r\n     * * Right: align text to the right.\r\n     * * Center: align text to center.\r\n     * @see TextAlignments\r\n     */\r\n    get TextAlignments()\r\n    {\r\n        return TextAlignments;\r\n    }\r\n\r\n    /**\r\n     * Get the text alignments options.\r\n     * This getter is deprecated, please use `TextAlignments` instead.\r\n     * * Left: align text to the left.\r\n     * * Right: align text to the right.\r\n     * * Center: align text to center.\r\n     * @deprecated\r\n     * @see TextAlignments\r\n     */\r\n    get TextAlignment()\r\n    {\r\n        if (!this._TextAlignment_dep) {\r\n            console.warn(`'gfx.TextAlignment' is deprecated and will be removed in future versions. Please use 'gfx.TextAlignments' instead.`);\r\n            this._TextAlignment_dep = true;\r\n        }\r\n        return TextAlignments;\r\n    }\r\n\r\n    /**\r\n     * Create and return a new camera instance.\r\n     * @param {Boolean} withViewport If true, will create camera with viewport value equal to canvas' size.\r\n     * @returns {Camera} New camera object.\r\n     */\r\n    createCamera(withViewport)\r\n    {\r\n        let ret = new Camera(this);\r\n        if (withViewport) {\r\n            ret.viewport = this.getRenderingRegion();\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    /**\r\n     * Set default orthographic camera from offset.\r\n     * @param {Vector2} offset Camera top-left corner.\r\n     * @returns {Camera} Camera instance.\r\n     */\r\n    setCameraOrthographic(offset)\r\n    {\r\n        let camera = this.createCamera();\r\n        camera.orthographicOffset(offset);\r\n        this.applyCamera(camera);\r\n        return camera;\r\n    }\r\n    \r\n    /**\r\n     * Create and return an effect instance.\r\n     * @see Effect\r\n     * @param {Class} type Effect class type. Must inherit from Effect base class.\r\n     * @returns {Effect} Effect instance.\r\n     */\r\n    createEffect(type)\r\n    {\r\n        if (!(type.prototype instanceof Effect)) { throw new Error(\"'type' must be a class type that inherits from 'Effect'.\"); }\r\n        let effect = new type();\r\n        effect._build(this._gl);\r\n        return effect;\r\n    }\r\n\r\n    /**\r\n     * Set resolution and canvas to the max size of its parent element or screen.\r\n     * If the canvas is directly under document body, it will take the max size of the page.\r\n     * @param {Boolean} limitToParent if true, will use parent element size. If false, will stretch on entire document.\r\n     * @param {Boolean} allowOddNumbers if true, will permit odd numbers, which could lead to small artefacts when drawing pixel art. If false (default) will round to even numbers.\r\n     */\r\n    maximizeCanvasSize(limitToParent, allowOddNumbers)\r\n    {\r\n        // new width and height\r\n        let width = 0;\r\n        let height = 0;\r\n\r\n        // parent\r\n        if (limitToParent) {\r\n            let parent = this._canvas.parentElement;\r\n            width = parent.clientWidth - this._canvas.offsetLeft;\r\n            height = parent.clientHeight - this._canvas.offsetTop;\r\n        }\r\n        // entire screen\r\n        else {\r\n            width = window.innerWidth;\r\n            height = window.innerHeight;\r\n            this._canvas.style.left = '0px';\r\n            this._canvas.style.top = '0px';\r\n        }\r\n\r\n        // make sure even numbers\r\n        if (!allowOddNumbers) {\r\n            if (width % 2 !== 0) { width++; }\r\n            if (height % 2 !== 0) { height++; }\r\n        }\r\n\r\n        // if changed, set resolution\r\n        if ((this._canvas.width !== width) || (this._canvas.height !== height)) {\r\n            this.setResolution(width, height, true);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set a render target (texture) to render on.\r\n     * @example\r\n     * // create render target\r\n     * let renderTarget = await Shaku.assets.createRenderTarget('_my_render_target', 800, 600);\r\n     * \r\n     * // use render target\r\n     * Shaku.gfx.setRenderTarget(renderTarget);\r\n     * // .. draw some stuff here\r\n     * \r\n     * // reset render target and present it on screen\r\n     * // note the negative height - render targets end up with flipped Y axis\r\n     * Shaku.gfx.setRenderTarget(null);\r\n     * Shaku.gfx.draw(renderTarget, new Shaku.utils.Vector2(screenX / 2, screenY / 2), new Shaku.utils.Vector2(screenX, -screenY));\r\n     * @param {TextureAsset|Array<TextureAsset>|null} texture Render target texture to set as render target, or null to reset and render back on canvas. Can also be array for multiple targets, which will take layouts 0-15 by their order.\r\n     * @param {Boolean=} keepCamera If true, will keep current camera settings. If false (default) will reset camera.\r\n     */\r\n    setRenderTarget(texture, keepCamera)\r\n    {\r\n        // present buffered data\r\n        this.presentBufferedData();\r\n\r\n        // if texture is null, remove any render target\r\n        if (texture === null) {\r\n            this._renderTarget = null;\r\n            //this._gl.drawBuffers([this._gl.BACK]);\r\n            this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, null);\r\n            this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL, false);\r\n            if (!keepCamera) {\r\n                this.resetCamera();\r\n            }\r\n            return;\r\n        }\r\n\r\n        // convert texture to array\r\n        if (!(texture instanceof Array)) {\r\n            texture = [texture];\r\n        }\r\n\r\n        // bind the framebuffer\r\n        this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, this._fb);\r\n        this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL, false);\r\n        \r\n        // set render targets\r\n        var drawBuffers = [];\r\n        for (let index = 0; index < texture.length; ++index) {\r\n            \r\n            // attach the texture as the first color attachment\r\n            const attachmentPoint = this._gl['COLOR_ATTACHMENT' + index];\r\n            this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER, attachmentPoint, this._gl.TEXTURE_2D, texture[index].texture, 0);\r\n\r\n            // index 0 is the \"main\" render target\r\n            if (index === 0) {\r\n                this._renderTarget = texture[index];\r\n            }\r\n\r\n            // to set drawBuffers in the end\r\n            drawBuffers.push(attachmentPoint);\r\n        }\r\n\r\n        // set draw buffers\r\n        this._gl.drawBuffers(drawBuffers);\r\n\r\n        // unbind frame buffer\r\n        //this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, null);\r\n\r\n        // reset camera\r\n        if (!keepCamera) {\r\n            this.resetCamera();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set effect to use for future draw calls.\r\n     * @example\r\n     * let effect = Shaku.gfx.createEffect(MyEffectType);\r\n     * Shaku.gfx.useEffect(effect);\r\n     * @param {Effect | null} effect Effect to use or null to use the basic builtin effect.\r\n     */\r\n    useEffect(effect)\r\n    {\r\n        // present buffered data\r\n        this.presentBufferedData();\r\n\r\n        // if null, use default\r\n        if (effect === null) {\r\n            this.useEffect(this.builtinEffects.Basic);\r\n            return;\r\n        }\r\n\r\n        // same effect? skip\r\n        if (this._activeEffect === effect) {\r\n            return;\r\n        }\r\n\r\n        // set effect\r\n        effect.setAsActive();\r\n        this._activeEffect = effect;\r\n        if (this._projection) { this._activeEffect.setProjectionMatrix(this._projection); }\r\n    }\r\n\r\n    /**\r\n     * Set resolution and canvas size.\r\n     * @example\r\n     * // set resolution and size of 800x600.\r\n     * Shaku.gfx.setResolution(800, 600, true);\r\n     * @param {Number} width Resolution width.\r\n     * @param {Number} height Resolution height.\r\n     * @param {Boolean} updateCanvasStyle If true, will also update the canvas *css* size in pixels.\r\n     */\r\n    setResolution(width, height, updateCanvasStyle)\r\n    {\r\n        this.presentBufferedData();\r\n\r\n        this._canvas.width = width;\r\n        this._canvas.height = height;\r\n\r\n        if (width % 2 !== 0 || height % 2 !== 0) {\r\n            _logger.warn(\"Resolution to set is not even numbers; This might cause minor artefacts when using texture atlases. Consider using even numbers instead.\");\r\n        }\r\n        \r\n        if (updateCanvasStyle) {\r\n            this._canvas.style.width = width + 'px';\r\n            this._canvas.style.height = height + 'px';\r\n        }\r\n\r\n        this._gl.viewport(0, 0, width, height);\r\n        this.resetCamera();\r\n    }\r\n\r\n    /**\r\n     * Reset camera properties to default camera.\r\n     */\r\n    resetCamera()\r\n    {\r\n        this._camera = this.createCamera();\r\n        let size = this.getRenderingSize();\r\n        this._camera.orthographic(new Rectangle(0, 0, size.x, size.y));\r\n        this.applyCamera(this._camera);\r\n    }\r\n\r\n    /**\r\n     * Set viewport, projection and other properties from a camera instance.\r\n     * Changing the camera properties after calling this method will *not* update the renderer, until you call applyCamera again.\r\n     * @param {Camera} camera Camera to apply.\r\n     */\r\n    applyCamera(camera)\r\n    {\r\n        this.presentBufferedData();\r\n        this._viewport = camera.viewport;\r\n        let viewport = this.getRenderingRegion(true);\r\n        this._gl.viewport(viewport.x, viewport.y, viewport.width, viewport.height);\r\n        this._projection = camera.projection.clone();\r\n        if (this._activeEffect) { this._activeEffect.setProjectionMatrix(this._projection); }\r\n    }\r\n\r\n    /**\r\n     * Get current rendering region.\r\n     * @param {Boolean} includeOffset If true (default) will include viewport offset, if exists.\r\n     * @returns {Rectangle} Rectangle with rendering region.\r\n     */\r\n    getRenderingRegion(includeOffset)\r\n    {\r\n        if (this._viewport) {\r\n            let ret = this._viewport.clone();\r\n            if (includeOffset === false) {\r\n                ret.x = ret.y = 0;\r\n            }\r\n            return ret;\r\n        }\r\n        return new Rectangle(0, 0, (this._renderTarget || this._canvas).width, (this._renderTarget || this._canvas).height);\r\n    }\r\n\r\n    /**\r\n     * Get current rendering size.\r\n     * Unlike 'canvasSize', this takes viewport and render target into consideration.\r\n     * @returns {Vector2} rendering size.\r\n     */\r\n    getRenderingSize()\r\n    {\r\n        let region = this.getRenderingRegion();\r\n        return region.getSize();\r\n    }\r\n    \r\n    /**\r\n     * Get canvas size as vector.\r\n     * @returns {Vector2} Canvas size.\r\n     */\r\n    getCanvasSize()\r\n    {\r\n        return new Vector2(this._canvas.width, this._canvas.height);\r\n    }\r\n\r\n    /** \r\n     * @inheritdoc\r\n     * @private\r\n     */\r\n    setup()\r\n    {        \r\n        return new Promise(async (resolve, reject) => {  \r\n\r\n            _logger.info(\"Setup gfx manager..\");\r\n\r\n            // if no canvas is set, create one\r\n            if (!this._canvas) {\r\n                this._canvas = document.createElement('canvas');\r\n            }\r\n\r\n            // get gl context\r\n            this._gl = this._canvas.getContext('webgl2', this._initSettings) || this._canvas.getContext('webgl', this._initSettings);\r\n            if (!this._gl) {\r\n                _logger.error(\"Can't get WebGL context!\");\r\n                return reject(\"Failed to get WebGL context from canvas!\");\r\n            }\r\n\r\n            // create default effects\r\n            this.builtinEffects.Basic = this.createEffect(BasicEffect);\r\n            this.builtinEffects.MsdfFont = this.createEffect(MsdfFontEffect);\r\n\r\n            // setup textures assets gl context\r\n            TextureAsset._setWebGl(this._gl);\r\n\r\n            // create framebuffer (used for render targets)\r\n            this._fb = this._gl.createFramebuffer();\r\n\r\n            // create base meshes\r\n            let _meshGenerator = new MeshGenerator(this._gl);\r\n            this.meshes = {\r\n                quad: _meshGenerator.quad()\r\n            }\r\n            Object.freeze(this.meshes);\r\n\r\n            // create a useful single white pixel texture\r\n            let whitePixelImage = new Image();\r\n            whitePixelImage.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=';\r\n            await new Promise((resolve, reject) => { whitePixelImage.onload = resolve; });\r\n            this.whiteTexture = new TextureAsset('__runtime_white_pixel__');\r\n            this.whiteTexture.fromImage(whitePixelImage);\r\n\r\n            // dynamic buffers, used for batch rendering\r\n            this._dynamicBuffers = {\r\n                \r\n                positionBuffer: this._gl.createBuffer(),\r\n                positionArray: new Float32Array(3 * 4 * this.batchSpritesCount),\r\n\r\n                textureCoordBuffer: this._gl.createBuffer(),\r\n                textureArray: new Float32Array(2 * 4 * this.batchSpritesCount),\r\n\r\n                colorsBuffer: this._gl.createBuffer(),\r\n                colorsArray: new Float32Array(4 * 4 * this.batchSpritesCount),\r\n\r\n                indexBuffer: this._gl.createBuffer(),\r\n\r\n                linesIndexBuffer: this._gl.createBuffer(),\r\n            }\r\n\r\n            // create the indices buffer for batching\r\n            let indices = new Uint16Array(this.batchSpritesCount * 6); // 6 = number of indices per sprite\r\n            let inc = 0;\r\n            for(let i = 0; i < indices.length; i += 6) {\r\n                \r\n                indices[i] = inc;\r\n                indices[i+1] = inc + 1;\r\n                indices[i+2] = inc + 2;\r\n\r\n                indices[i+3] = inc + 1;\r\n                indices[i+4] = inc + 3;\r\n                indices[i+5] = inc + 2;\r\n\r\n                inc += 4;\r\n            }\r\n            this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER, this._dynamicBuffers.indexBuffer);\r\n            this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER, indices, this._gl.STATIC_DRAW);\r\n\r\n            // create the indices buffer for drawing lines\r\n            let lineIndices = new Uint16Array(this.maxLineSegments);\r\n            for (let i = 0; i < lineIndices.length; i += 6) {          \r\n                lineIndices[i] = i;\r\n            }\r\n            this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER, this._dynamicBuffers.linesIndexBuffer);\r\n            this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER, lineIndices, this._gl.STATIC_DRAW);\r\n            \r\n            // create sprites batch\r\n            this.spritesBatch = new SpriteBatch(this);\r\n\r\n            // use default effect\r\n            this.useEffect(null);\r\n\r\n            // create default camera\r\n            this._camera = this.createCamera();\r\n            this.applyCamera(this._camera);\r\n\r\n            // success!\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Generate a sprites group to render a string using a font texture.\r\n     * Take the result of this method and use with gfx.drawGroup() to render the text.\r\n     * This is what you use when you want to draw texts with `Shaku`.\r\n     * Note: its best to always draw texts with *batching* enabled.\r\n     * @example\r\n     * // load font texture\r\n     * let fontTexture = await Shaku.assets.loadFontTexture('assets/DejaVuSansMono.ttf', {fontName: 'DejaVuSansMono'});\r\n     * \r\n     * // generate 'hello world!' text (note: you don't have to regenerate every frame if text didn't change)\r\n     * let text1 = Shaku.gfx.buildText(fontTexture, \"Hello World!\");\r\n     * text1.position.set(40, 40);\r\n     * \r\n     * // draw text\r\n     * Shaku.gfx.drawGroup(text1, true);\r\n     * @param {FontTextureAsset} fontTexture Font texture asset to use.\r\n     * @param {String} text Text to generate sprites for.\r\n     * @param {Number=} fontSize Font size, or undefined to use font texture base size.\r\n     * @param {Color|Array<Color>=} color Text sprites color. If array is set, will assign each color to different vertex, starting from top-left.\r\n     * @param {TextAlignment=} alignment Text alignment.\r\n     * @param {Vector2=} offset Optional starting offset.\r\n     * @param {Vector2=} marginFactor Optional factor for characters and line spacing. For example value of 2,1 will make double horizontal spacing. \r\n     * @returns {SpritesGroup} Sprites group containing the needed sprites to draw the given text with its properties.\r\n     */\r\n    buildText(fontTexture, text, fontSize, color, alignment, offset, marginFactor)\r\n    {\r\n        // make sure text is a string\r\n        if (typeof text !== 'string') {\r\n            text = '' + text;\r\n        }\r\n\r\n        // sanity\r\n        if (!fontTexture || !fontTexture.valid) {\r\n            throw new Error(\"Font texture is invalid!\");\r\n        }\r\n\r\n        // default alignment\r\n        alignment = alignment || TextAlignments.Left;\r\n\r\n        // default color\r\n        color = color || Color.black;\r\n\r\n        // default font size\r\n        fontSize = fontSize || fontTexture.fontSize;\r\n\r\n        // default margin factor\r\n        marginFactor = marginFactor || Vector2.one;\r\n\r\n        // get character scale factor\r\n        let scale = fontSize / fontTexture.fontSize;\r\n\r\n        // current character offset\r\n        let position = new Vector2(0, 0);\r\n\r\n        // current line characters and width\r\n        let currentLineSprites = [];\r\n        let lineWidth = 0;\r\n\r\n        // go line down\r\n        function breakLine()\r\n        {\r\n            // add offset to update based on alignment\r\n            let offsetX = 0;\r\n            switch (alignment) {\r\n\r\n                case TextAlignments.Right:\r\n                    offsetX = -lineWidth;\r\n                    break;\r\n\r\n                case TextAlignments.Center:\r\n                    offsetX = -lineWidth / 2;\r\n                    break;\r\n\r\n            }\r\n\r\n            // if we need to shift characters for alignment, do it\r\n            if (offsetX != 0) {\r\n                for (let i = 0; i < currentLineSprites.length; ++i) {\r\n                    currentLineSprites[i].position.x += offsetX;\r\n                }\r\n            }\r\n\r\n            // update offset\r\n            position.x = 0;\r\n            position.y += fontTexture.lineHeight * scale * marginFactor.y;\r\n\r\n            // reset line width and sprites\r\n            currentLineSprites = [];\r\n            lineWidth = 0;\r\n        }\r\n\r\n        // create group to return and build sprites\r\n        let ret = new SpritesGroup();\r\n        for (let i = 0; i < text.length; ++i) \r\n        {\r\n            // get character and source rect\r\n            let character = text[i];\r\n            let sourceRect = fontTexture.getSourceRect(character);\r\n\r\n            // special case - break line\r\n            if (character === '\\n') {\r\n                breakLine();\r\n                continue;\r\n            }\r\n\r\n            // calculate character size\r\n            let size = new Vector2(sourceRect.width * scale, sourceRect.height * scale);\r\n\r\n            // create sprite (unless its space)\r\n            if (character !== ' ') {\r\n\r\n                // create sprite and add to group\r\n                let sprite = new Sprite(fontTexture.texture, sourceRect);\r\n                sprite.size = size;\r\n                if (fontTexture instanceof MsdfFontTextureAsset) {\r\n                    sprite.origin.set(0, 0);\r\n                }\r\n                else {\r\n                    sprite.origin.set(0.5, 0.5);\r\n                }\r\n                sprite.position.copy(position).addSelf(fontTexture.getPositionOffset(character).mul(scale));\r\n                if (color instanceof Color) {\r\n                    sprite.color.copy(color);\r\n                }\r\n                else {\r\n                    sprite.color = [];\r\n                    for (let col of color) {\r\n                        sprite.color.push(col.clone());\r\n                    }\r\n                }\r\n                sprite.origin.x = 0;\r\n                ret.add(sprite);\r\n\r\n                // add to current line sprites\r\n                currentLineSprites.push(sprite);\r\n            }\r\n\r\n            let moveCursorAmount = fontTexture.getXAdvance(character) * scale * marginFactor.x;\r\n\r\n            // update current line width\r\n            lineWidth += moveCursorAmount;\r\n\r\n            // set position for next character\r\n            position.x += moveCursorAmount;\r\n        }\r\n\r\n        // call break line on last line, to adjust alignment for last line\r\n        breakLine();\r\n\r\n        // set position\r\n        if (offset) {\r\n            ret.position.set(offset.x, offset.y);\r\n        }\r\n\r\n        // return group\r\n        return ret;\r\n    }\r\n\r\n    /**\r\n     * Draw a SpritesGroup object. \r\n     * A SpritesGroup is a collection of sprites we can draw in bulks with transformations to apply on the entire group.\r\n     * @example\r\n     * // load texture\r\n     * let texture = await Shaku.assets.loadTexture('assets/sprite.png');\r\n     * \r\n     * // create group and set entire group's position and scale\r\n     * let group = new Shaku.gfx.SpritesGroup();\r\n     * group.position.set(125, 300);\r\n     * group.scale.set(2, 2);\r\n     *\r\n     * // create 5 sprites and add to group\r\n     * for (let i = 0; i < 5; ++i) {\r\n     *   let sprite = new Shaku.gfx.Sprite(texture);\r\n     *   sprite.position.set(100 * i, 150);\r\n     *   sprite.size.set(50, 50);\r\n     *   group.add(sprite)\r\n     * }\r\n     * \r\n     * // draw the group with automatic culling of invisible sprites\r\n     * Shaku.gfx.drawGroup(group, true);\r\n     * @param {SpritesGroup} group Sprites group to draw.\r\n     * @param {Boolean} cullOutOfScreen If true and in batching mode, will cull automatically any quad that is completely out of screen.\r\n     */\r\n    drawGroup(group, cullOutOfScreen)\r\n    {\r\n        this._drawBatch(group, Boolean(cullOutOfScreen));\r\n    }\r\n\r\n    /**\r\n     * Draw a single sprite object.\r\n     * Sprites are optional objects that store all the parameters for a `draw()` call. They are also used for batch rendering.\r\n     * @example\r\n     * // load texture and create sprite\r\n     * let texture = await Shaku.assets.loadTexture('assets/sprite.png');\r\n     * let sprite = new Shaku.gfx.Sprite(texture);\r\n     * \r\n     * // set position and size\r\n     * sprite.position.set(100, 150);\r\n     * sprite.size.set(50, 50);\r\n     * \r\n     * // draw sprite\r\n     * Shaku.gfx.drawSprite(sprite);\r\n     * @param {Sprite} sprite Sprite object to draw.\r\n     */\r\n    drawSprite(sprite)\r\n    {\r\n        if (!sprite.texture || !sprite.texture.valid) { return; }\r\n        this.__startDrawingSprites(this._activeEffect, null);\r\n        this.spritesBatch.draw(sprite);\r\n    }\r\n\r\n    /**\r\n     * Draw a texture to cover a given destination rectangle.\r\n     * @example\r\n     * // cover the entire screen with an image\r\n     * let texture = await Shaku.assets.loadTexture('assets/sprite.png');\r\n     * Shaku.gfx.cover(texture, Shaku.gfx.getRenderingRegion());\r\n     * @example\r\n     * // draw with additional params\r\n     * let sourceRect = new Shaku.utils.Rectangle(0, 0, 64, 64);\r\n     * let color = Shaku.utils.Color.blue;\r\n     * let blendMode = Shaku.gfx.BlendModes.Multiply;\r\n     * let rotation = Math.PI / 4;\r\n     * let origin = new Shaku.utils.Vector2(0.5, 0.5);\r\n     * Shaku.gfx.draw(texture, position, size, sourceRect, color, blendMode, rotation, origin);\r\n     * @param {TextureAsset} texture Texture to draw.\r\n     * @param {Rectangle|Vector2} destRect Destination rectangle to draw on. If vector is provided, will draw from 0,0 with vector as size.\r\n     * @param {Rectangle=} sourceRect Source rectangle, or undefined to use the entire texture.\r\n     * @param {Color|Array<Color>|undefined} color Tint color, or undefined to not change color. If array is set, will assign each color to different vertex, starting from top-left.\r\n     * @param {BlendMode=} blendMode Blend mode, or undefined to use alpha blend.\r\n     */\r\n    cover(texture, destRect, sourceRect, color, blendMode)\r\n    {\r\n        if ((destRect instanceof Vector2) || (destRect instanceof Vector3)) {\r\n            destRect = new Rectangle(0, 0, destRect.x, destRect.y);\r\n        }\r\n        return this.draw(texture, destRect.getCenter(), destRect.getSize(), sourceRect, color, blendMode);\r\n    }\r\n\r\n    /**\r\n     * Draw a texture.\r\n     * @example\r\n     * // a simple draw with position and size\r\n     * let texture = await Shaku.assets.loadTexture('assets/sprite.png');\r\n     * let position = new Shaku.utils.Vector2(100, 100);\r\n     * let size = new Shaku.utils.Vector2(75, 125); // if width == height, you can pass as a number instead of vector\r\n     * Shaku.gfx.draw(texture, position, size);\r\n     * @example\r\n     * // draw with additional params\r\n     * let sourceRect = new Shaku.utils.Rectangle(0, 0, 64, 64);\r\n     * let color = Shaku.utils.Color.blue;\r\n     * let blendMode = Shaku.gfx.BlendModes.Multiply;\r\n     * let rotation = Math.PI / 4;\r\n     * let origin = new Shaku.utils.Vector2(0.5, 0.5);\r\n     * Shaku.gfx.draw(texture, position, size, sourceRect, color, blendMode, rotation, origin);\r\n     * @param {TextureAsset} texture Texture to draw.\r\n     * @param {Vector2|Vector3} position Drawing position (at origin). If vector3 is provided, will pass z value to the shader code position attribute.\r\n     * @param {Vector2|Vector3|Number} size Drawing size. If vector3 is provided, will pass z value to the shader code position attribute for the bottom vertices, as position.z + size.z.\r\n     * @param {Rectangle} sourceRect Source rectangle, or undefined to use the entire texture.\r\n     * @param {Color|Array<Color>|undefined} color Tint color, or undefined to not change color. If array is set, will assign each color to different vertex, starting from top-left.\r\n     * @param {BlendMode=} blendMode Blend mode, or undefined to use alpha blend.\r\n     * @param {Number=} rotation Rotate sprite.\r\n     * @param {Vector2=} origin Drawing origin. This will be the point at 'position' and rotation origin.\r\n     * @param {Vector2=} skew Skew the drawing corners on X and Y axis, around the origin point.\r\n     */\r\n    draw(texture, position, size, sourceRect, color, blendMode, rotation, origin, skew)\r\n    {\r\n        let sprite = new Sprite(texture, sourceRect);\r\n        sprite.position = position;\r\n        sprite.size = (typeof size === 'number') ? new Vector2(size, size) : size;\r\n        if (color) { sprite.color = color; }\r\n        if (blendMode) { sprite.blendMode = blendMode; }\r\n        if (rotation !== undefined) { sprite.rotation = rotation; }\r\n        if (origin) { sprite.origin = origin; }\r\n        if (skew) { sprite.skew = skew; }\r\n        this.drawSprite(sprite);\r\n    }\r\n\r\n    /**\r\n     * Draw a textured quad from vertices.\r\n     * @param {TextureAsset} texture Texture to draw.\r\n     * @param {Array<Vertex>} vertices Quad vertices to draw (should be: top-left, top-right, bottom-left, bottom-right).\r\n     * @param {BlendMode=} blendMode Blend mode to set.\r\n     */\r\n    drawQuadFromVertices(texture, vertices, blendMode)\r\n    {\r\n        if (!texture || !texture.valid) { return; }\r\n        this.__startDrawingSprites(this._activeEffect, null);\r\n        this._setBlendMode(blendMode || BlendModes.AlphaBlend);\r\n        this.spritesBatch.setTexture(texture);\r\n        this.spritesBatch.pushVertices(vertices);\r\n    }\r\n\r\n    /**\r\n     * Draw a filled colored rectangle.\r\n     * @example\r\n     * // draw a 50x50 red rectangle at position 100x100, that will rotate over time\r\n     * Shaku.gfx.fillRect(new Shaku.utils.Rectangle(100, 100, 50, 50), Shaku.utils.Color.red, null, Shaku.gameTime.elapsed);\r\n     * @param {Rectangle} destRect Rectangle to fill.\r\n     * @param {Color|Array<Color>} color Rectangle fill color.\r\n     * @param {BlendMode=} blend Blend mode.\r\n     * @param {Number=} rotation Rotate the rectangle around its center.\r\n     */\r\n    fillRect(destRect, color, blend, rotation)\r\n    {\r\n        this.draw(this.whiteTexture, \r\n            new Vector2(destRect.x + destRect.width / 2, destRect.y + destRect.height / 2),\r\n            new Vector2(destRect.width, destRect.height), null, color, blend || BlendModes.Opaque, rotation, null, null);\r\n    }\r\n\r\n    /**\r\n     * Draw a list of filled colored rectangles as a batch.\r\n     * @example\r\n     * // draw a 50x50 red rectangle at position 100x100, that will rotate over time\r\n     * Shaku.gfx.fillRects([new Shaku.utils.Rectangle(100, 100, 50, 50), new Shaku.utils.Rectangle(150, 150, 25, 25)], Shaku.utils.Color.red, null, Shaku.gameTime.elapsed);\r\n     * @param {Array<Rectangle>} destRects Rectangles to fill.\r\n     * @param {Array<Color>|Color} colors Rectangles fill color. If array is set, will assign each color to different vertex, starting from top-left.\r\n     * @param {BlendMode=} blend Blend mode.\r\n     * @param {(Array<Number>|Number)=} rotation Rotate the rectangles around its center.\r\n     */\r\n    fillRects(destRects, colors, blend, rotation)\r\n    {\r\n        // build group\r\n        if (rotation === undefined) { rotation = 0; }\r\n        let group = new SpritesGroup();\r\n        for (let i = 0; i < destRects.length; ++i) {\r\n            let sprite = new Sprite(this.whiteTexture);\r\n            sprite.color = colors[i] || colors;\r\n            sprite.rotation = rotation.length ? rotation[i] : rotation;\r\n            sprite.blendMode = blend || BlendModes.Opaque;\r\n            let destRect = destRects[i];\r\n            sprite.size.set(destRect.width, destRect.height);\r\n            sprite.position.set(destRect.x + destRect.width / 2, destRect.y + destRect.width / 2);\r\n            sprite.origin.set(0.5, 0.5);\r\n            group.add(sprite);\r\n        }\r\n\r\n        // draw group\r\n        this.drawGroup(group);\r\n    }\r\n\r\n    /**\r\n     * Draw an outline colored rectangle.\r\n     * @example\r\n     * // draw a 50x50 red rectangle at position 100x100, that will rotate over time\r\n     * Shaku.gfx.outlineRect(new Shaku.utils.Rectangle(100, 100, 50, 50), Shaku.utils.Color.red, null, Shaku.gameTime.elapsed);\r\n     * @param {Rectangle} destRect Rectangle to draw outline for.\r\n     * @param {Color} color Rectangle outline color.\r\n     * @param {BlendMode=} blend Blend mode.\r\n     * @param {Number=} rotation Rotate the rectangle around its center.\r\n     */\r\n    outlineRect(destRect, color, blend, rotation)\r\n    {\r\n        // get corners\r\n        let topLeft = destRect.getTopLeft();\r\n        let topRight = destRect.getTopRight();\r\n        let bottomRight = destRect.getBottomRight();\r\n        let bottomLeft = destRect.getBottomLeft();\r\n\r\n        // rotate vertices\r\n        if (rotation) {\r\n\r\n            // center rect\r\n            let center = destRect.getCenter();\r\n            topLeft.subSelf(center);\r\n            topRight.subSelf(center);\r\n            bottomLeft.subSelf(center);\r\n            bottomRight.subSelf(center);\r\n\r\n            // do rotation\r\n            let cos = Math.cos(rotation);\r\n            let sin = Math.sin(rotation);\r\n            function rotateVec(vector)\r\n            {\r\n                let x = (vector.x * cos - vector.y * sin);\r\n                let y = (vector.x * sin + vector.y * cos);\r\n                vector.set(x, y);\r\n            }\r\n            rotateVec(topLeft);\r\n            rotateVec(topRight);\r\n            rotateVec(bottomLeft);\r\n            rotateVec(bottomRight);\r\n\r\n            // return to original position\r\n            topLeft.addSelf(center);\r\n            topRight.addSelf(center);\r\n            bottomLeft.addSelf(center);\r\n            bottomRight.addSelf(center);\r\n        }\r\n        \r\n        // draw rectangle with lines strip\r\n        this.drawLinesStrip([topLeft, topRight, bottomRight, bottomLeft], color, blend, true);\r\n    }\r\n\r\n    /**\r\n     * Draw an outline colored circle.\r\n     * @example\r\n     * // draw a circle at 50x50 with radius of 85\r\n     * Shaku.gfx.outlineCircle(new Shaku.utils.Circle(new Shaku.utils.Vector2(50, 50), 85), Shaku.utils.Color.red);\r\n     * @param {Circle} circle Circle to draw.\r\n     * @param {Color} color Circle outline color.\r\n     * @param {BlendMode=} blend Blend mode.\r\n     * @param {Number=} lineAmount How many lines to compose the circle from (bigger number = smoother circle).\r\n     */\r\n    outlineCircle(circle, color, blend, lineAmount)\r\n    {\r\n        // defaults\r\n        if (lineAmount === undefined) { lineAmount = 32; }\r\n\r\n        // generate list of lines to draw circle\r\n        let lines = [];\r\n        const twicePi = 2 * Math.PI;\r\n        for (let i = 0; i <= lineAmount; i++) {\r\n            let point = new Vector2(\r\n                circle.center.x + (circle.radius * Math.cos(i * twicePi / lineAmount)), \r\n                circle.center.y + (circle.radius * Math.sin(i * twicePi / lineAmount))\r\n            );\r\n            lines.push(point);\r\n        }\r\n\r\n        // draw lines\r\n        this.drawLinesStrip(lines, color, blend);\r\n    }\r\n\r\n    /**\r\n     * Draw a filled colored circle.\r\n     * @example\r\n     * // draw a filled circle at 50x50 with radius of 85\r\n     * Shaku.gfx.fillCircle(new Shaku.utils.Circle(new Shaku.utils.Vector2(50, 50), 85), Shaku.utils.Color.red);\r\n     * @param {Circle} circle Circle to draw.\r\n     * @param {Color} color Circle fill color.\r\n     * @param {BlendMode=} blend Blend mode.\r\n     * @param {Number=} lineAmount How many lines to compose the circle from (bigger number = smoother circle).\r\n     */\r\n    fillCircle(circle, color, blend, lineAmount)\r\n    {\r\n        // defaults\r\n        if (lineAmount === undefined) { lineAmount = 32; }\r\n\r\n        // generate list of lines to draw circle\r\n        let lines = [circle.center];\r\n        const twicePi = 2 * Math.PI;\r\n        for (let i = 0; i <= lineAmount; i++) {\r\n            let point = new Vector2(\r\n                circle.center.x + (circle.radius * Math.cos(i * twicePi / lineAmount)), \r\n                circle.center.y + (circle.radius * Math.sin(i * twicePi / lineAmount))\r\n            );\r\n            lines.push(point);\r\n        }\r\n\r\n        // prepare effect and buffers\r\n        let gl = this._gl;\r\n        this._fillShapesBuffer(lines, color, blend, (verts) => {\r\n            gl.drawArrays(gl.TRIANGLE_FAN, 0, verts.length);\r\n            this._drawCallsCount++;\r\n        }, true, 1);\r\n    }\r\n\r\n    /**\r\n     * Draw a list of filled colored circles using batches.\r\n     * @example\r\n     * // draw a filled circle at 50x50 with radius of 85\r\n     * Shaku.gfx.fillCircles([new Shaku.utils.Circle(new Shaku.utils.Vector2(50, 50), 85), new Shaku.utils.Circle(new Shaku.utils.Vector2(150, 125), 35)], Shaku.utils.Color.red);\r\n     * @param {Array<Circle>} circles Circles list to draw.\r\n     * @param {Color|Array<Color>} colors Circles fill color or a single color for all circles.\r\n     * @param {BlendMode=} blend Blend mode.\r\n     * @param {Number=} lineAmount How many lines to compose the circle from (bigger number = smoother circle).\r\n     */\r\n    fillCircles(circles, colors, blend, lineAmount)\r\n    {\r\n        // defaults\r\n        if (lineAmount === undefined) { lineAmount = 32; }\r\n\r\n        // build vertices and colors arrays\r\n        let vertsArr = [];\r\n        let colorsArr = colors.length ? [] : null;\r\n\r\n        // generate vertices and colors\r\n        for (let i = 0; i < circles.length; ++i) {\r\n\r\n            let circle = circles[i];\r\n            let color = colors[i] || colors;\r\n\r\n            const twicePi = 2 * Math.PI;\r\n            for (let i = 0; i <= lineAmount; i++) {\r\n\r\n                // set vertices\r\n                vertsArr.push(new Vector2(\r\n                    circle.center.x + (circle.radius * Math.cos(i * twicePi / lineAmount)), \r\n                    circle.center.y + (circle.radius * Math.sin(i * twicePi / lineAmount))\r\n                ));\r\n                vertsArr.push(new Vector2(\r\n                    circle.center.x + (circle.radius * Math.cos((i+1) * twicePi / lineAmount)), \r\n                    circle.center.y + (circle.radius * Math.sin((i+1) * twicePi / lineAmount))\r\n                ));\r\n                vertsArr.push(circle.center);\r\n\r\n                // set colors\r\n                if (colorsArr) {\r\n                    colorsArr.push(color);\r\n                    colorsArr.push(color);\r\n                    colorsArr.push(color);\r\n                }\r\n            }\r\n        }\r\n\r\n        // prepare effect and buffers\r\n        let gl = this._gl;\r\n        this._fillShapesBuffer(vertsArr, colorsArr || colors, blend, (verts) => {\r\n            gl.drawArrays(gl.TRIANGLES, 0, verts.length);\r\n            this._drawCallsCount++;\r\n        }, false, 3);\r\n    }\r\n\r\n    /**\r\n     * Draw a single line between two points.\r\n     * @example\r\n     * Shaku.gfx.drawLine(new Shaku.utils.Vector2(50,50), new Shaku.utils.Vector2(150,50), Shaku.utils.Color.red);\r\n     * @param {Vector2} startPoint Line start point.\r\n     * @param {Vector2} endPoint Line end point.\r\n     * @param {Color} color Line color.\r\n     * @param {BlendMode=} blendMode Blend mode to draw lines with (default to Opaque).\r\n     */\r\n    drawLine(startPoint, endPoint, color, blendMode)\r\n    {\r\n        return this.drawLines([startPoint, endPoint], color, blendMode, false);\r\n    }\r\n\r\n    /**\r\n     * Draw a strip of lines between an array of points.\r\n     * @example\r\n     * let lines = [new Shaku.utils.Vector2(50,50), new Shaku.utils.Vector2(150,50), new Shaku.utils.Vector2(150,150)];\r\n     * let colors = [Shaku.utils.Color.random(), Shaku.utils.Color.random(), Shaku.utils.Color.random()];\r\n     * Shaku.gfx.drawLinesStrip(lines, colors);\r\n     * @param {Array<Vector2>} points Points to draw line between.\r\n     * @param {Color|Array<Color>} colors Single lines color if you want one color for all lines, or an array of colors per segment.\r\n     * @param {BlendMode=} blendMode Blend mode to draw lines with (default to Opaque).\r\n     * @param {Boolean=} looped If true, will also draw a line from last point back to first point.\r\n     */\r\n    drawLinesStrip(points, colors, blendMode, looped)\r\n    {\r\n        // prepare effect and buffers\r\n        let gl = this._gl;\r\n\r\n        // do loop - note: we can't use gl.LINE_LOOPED in case we need multiple buffers inside '_fillShapesBuffer' which will invoke more than one draw\r\n        if (looped) {\r\n            points = points.slice(0);\r\n            points.push(points[0]);\r\n            if (colors && colors.length) {\r\n                colors = colors.slice(0);\r\n                colors.push(colors[0]);\r\n            }\r\n        }\r\n\r\n        // draw lines\r\n        this._fillShapesBuffer(points, colors, blendMode, (verts) => {\r\n            gl.drawArrays(gl.LINE_STRIP, 0, verts.length);\r\n            this._drawCallsCount++;\r\n        }, true, 2);\r\n    }\r\n\r\n    /**\r\n     * Draw a list of lines from an array of points.\r\n     * @example\r\n     * let lines = [new Shaku.utils.Vector2(50,50), new Shaku.utils.Vector2(150,50), new Shaku.utils.Vector2(150,150)];\r\n     * let colors = [Shaku.utils.Color.random(), Shaku.utils.Color.random(), Shaku.utils.Color.random()];\r\n     * Shaku.gfx.drawLines(lines, colors);\r\n     * @param {Array<Vector2>} points Points to draw line between.\r\n     * @param {Color|Array<Color>} colors Single lines color if you want one color for all lines, or an array of colors per segment.\r\n     * @param {BlendMode=} blendMode Blend mode to draw lines with (default to Opaque).\r\n     */\r\n    drawLines(points, colors, blendMode)\r\n    {\r\n        // prepare effect and buffers\r\n        let gl = this._gl;\r\n        this._fillShapesBuffer(points, colors, blendMode, (verts) => {\r\n            gl.drawArrays(gl.LINES, 0, verts.length);\r\n            this._drawCallsCount++;\r\n        }, true, 2);\r\n    }\r\n\r\n    /**\r\n     * Draw a single point from vector.\r\n     * @example\r\n     * Shaku.gfx.drawPoint(new Shaku.utils.Vector2(50,50), Shaku.utils.Color.random());\r\n     * @param {Vector2} point Point to draw.\r\n     * @param {Color} color Point color.\r\n     * @param {BlendMode=} blendMode Blend mode to draw point with (default to Opaque).\r\n     */\r\n    drawPoint(point, color, blendMode)\r\n    {\r\n        return this.drawPoints([point], [color], blendMode);\r\n    }\r\n\r\n    /**\r\n     * Draw a list of points from an array of vectors.\r\n     * @example\r\n     * let points = [new Shaku.utils.Vector2(50,50), new Shaku.utils.Vector2(150,50), new Shaku.utils.Vector2(150,150)];\r\n     * let colors = [Shaku.utils.Color.random(), Shaku.utils.Color.random(), Shaku.utils.Color.random()];\r\n     * Shaku.gfx.drawPoints(points, colors);\r\n     * @param {Array<Vector2>} points Points to draw.\r\n     * @param {Color|Array<Color>} colors Single color if you want one color for all points, or an array of colors per point.\r\n     * @param {BlendMode=} blendMode Blend mode to draw points with (default to Opaque).\r\n     */\r\n    drawPoints(points, colors, blendMode)\r\n    {\r\n        let gl = this._gl;\r\n        this._fillShapesBuffer(points, colors, blendMode, (verts) => {\r\n            gl.drawArrays(gl.POINTS, 0, verts.length);\r\n            this._drawCallsCount++;\r\n        }, false, 1);\r\n    }\r\n\r\n    /**\r\n     * Make the renderer canvas centered.\r\n     */\r\n    centerCanvas()\r\n    {\r\n        let canvas = this._canvas;\r\n        let parent = canvas.parentElement;\r\n        let pwidth = Math.min(parent.clientWidth, window.innerWidth);\r\n        let pheight = Math.min(parent.clientHeight, window.innerHeight);\r\n        canvas.style.left = Math.round(pwidth / 2 - canvas.clientWidth / 2) + 'px';\r\n        canvas.style.top = Math.round(pheight / 2 - canvas.clientHeight / 2) + 'px';\r\n        canvas.style.display = 'block';\r\n        canvas.style.position = 'relative';\r\n    }\r\n        \r\n    /**\r\n     * Check if a given shape is currently in screen bounds, not taking camera into consideration.\r\n     * @param {Circle|Vector|Rectangle|Line} shape Shape to check.\r\n     * @returns {Boolean} True if given shape is in visible region.\r\n     */\r\n    inScreen(shape)\r\n    {\r\n        let region = this.getRenderingRegion();\r\n\r\n        if (shape instanceof Circle) {\r\n            return region.collideCircle(shape);\r\n        }\r\n        else if (shape instanceof Vector2) {\r\n            return region.containsVector(shape);\r\n        }\r\n        else if (shape instanceof Rectangle) {\r\n            return region.collideRect(shape);\r\n        }\r\n        else if (shape instanceof Line) {\r\n            return region.collideLine(shape);\r\n        }\r\n        else {\r\n            throw new Error(\"Unknown shape type to check!\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Make a given vector the center of the camera.\r\n     * @param {Vector2} position Camera position.\r\n     * @param {Boolean} useCanvasSize If true, will always use cancas size when calculating center. If false and render target is set, will use render target's size.\r\n     */\r\n    centerCamera(position, useCanvasSize)\r\n    {\r\n        let renderSize = useCanvasSize ? this.getCanvasSize() : this.getRenderingSize();\r\n        let halfScreenSize = renderSize.mul(0.5);\r\n        let centeredPos = position.sub(halfScreenSize);\r\n        this.setCameraOrthographic(centeredPos);\r\n    }\r\n        \r\n    /**\r\n     * Prepare buffers, effect and blend mode for shape rendering.\r\n     * @private\r\n     */\r\n    _fillShapesBuffer(points, colors, blendMode, onReady, isStrip, groupsSize)\r\n    {\r\n        // finish whatever we were drawing before\r\n        this.presentBufferedData();\r\n\r\n        // some defaults\r\n        colors = colors || _whiteColor;\r\n        blendMode = blendMode || BlendModes.Opaque;\r\n\r\n        // sanity - make sure colors and vertices match\r\n        if (colors.length !== undefined && colors.length !== points.length) {\r\n            _logger.error(\"When drawing shapes with colors array, the colors array and points array must have the same length!\");\r\n            return;\r\n        }\r\n\r\n        // calculate actual max buffer size\r\n        let maxWithMargin = isStrip ? (this.maxLineSegments-1) : this.maxLineSegments;\r\n        if (groupsSize != 1) {\r\n            while (maxWithMargin % groupsSize !== 0) { maxWithMargin--; }\r\n        }\r\n\r\n        // if we have too many vertices, break to multiple calls\r\n        if (points.length > maxWithMargin) {\r\n            let sliceI = 0;\r\n            while (true) {\r\n                let start = sliceI * maxWithMargin;\r\n                let end = start + maxWithMargin;\r\n                if (isStrip && sliceI > 0) { start--; }\r\n                let subpoints = points.slice(start, end);\r\n                if (subpoints.length === 0) { break; }\r\n                let subcolors = (colors && colors.length) ? colors.slice(start, end) : colors;\r\n                this._fillShapesBuffer(subpoints, subcolors, blendMode, onReady, isStrip, groupsSize);\r\n                sliceI++;\r\n            }\r\n            return;\r\n        }\r\n\r\n       // basic params\r\n       let gl = this._gl;\r\n       let positionsBuff = this._dynamicBuffers.positionArray;\r\n       let colorsBuff = this._dynamicBuffers.colorsArray;\r\n\r\n       for (let i = 0; i < points.length; ++i) {\r\n\r\n           // set positions\r\n           positionsBuff[i*3 + 0] = points[i].x;\r\n           positionsBuff[i*3 + 1] = points[i].y;\r\n           positionsBuff[i*3 + 2] = points[i].z || 0;\r\n           \r\n           // set colors\r\n           let color = colors[i] || colors;\r\n           colorsBuff[i*4 + 0] = color.r;\r\n           colorsBuff[i*4 + 1] = color.g;\r\n           colorsBuff[i*4 + 2] = color.b;\r\n           colorsBuff[i*4 + 3] = color.a;\r\n       }\r\n\r\n       // set blend mode if needed\r\n       this._setBlendMode(blendMode);\r\n\r\n       // prepare effect and texture\r\n       let mesh = new Mesh(this._dynamicBuffers.positionBuffer, null, this._dynamicBuffers.colorsBuffer, this._dynamicBuffers.indexBuffer, points.length);\r\n       this._activeEffect.prepareToDrawBatch(mesh, Matrix.identity);\r\n       this._setActiveTexture(this.whiteTexture);\r\n\r\n       // should we slice the arrays to more optimal size?\r\n       let shouldSliceArrays = points.length <= 8;\r\n\r\n       // copy position buffer\r\n       this._gl.bindBuffer(this._gl.ARRAY_BUFFER, this._dynamicBuffers.positionBuffer);\r\n       this._gl.bufferData(this._gl.ARRAY_BUFFER, \r\n           shouldSliceArrays ? this._dynamicBuffers.positionArray.slice(0, points.length * 3) : this._dynamicBuffers.positionArray, \r\n           this._gl.DYNAMIC_DRAW);\r\n\r\n       // copy color buffer\r\n       this._gl.bindBuffer(this._gl.ARRAY_BUFFER, this._dynamicBuffers.colorsBuffer);\r\n       this._gl.bufferData(this._gl.ARRAY_BUFFER, \r\n           shouldSliceArrays ? this._dynamicBuffers.colorsArray.slice(0, points.length * 4) : this._dynamicBuffers.colorsArray, \r\n           this._gl.DYNAMIC_DRAW);\r\n\r\n       // set indices\r\n       gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this._dynamicBuffers.linesIndexBuffer);\r\n       this._currIndices = null;\r\n\r\n       // invoke the on-ready callback\r\n       onReady(points);\r\n    }\r\n\r\n    /**\r\n     * Draw sprites group as a batch.\r\n     * @private\r\n     * @param {SpritesGroup} group Group to draw.\r\n     * @param {Boolean} cullOutOfScreen If true will cull quads that are out of screen.\r\n     */\r\n    _drawBatch(group, cullOutOfScreen)\r\n    {\r\n        // skip if empty\r\n        if (group._sprites.length === 0) { return; }\r\n\r\n        // finish previous drawings\r\n        this.presentBufferedData();\r\n\r\n        // get transform\r\n        let transform = group.getTransform();\r\n\r\n        // draw batch\r\n        this.spritesBatch.begin(this._activeEffect, transform);\r\n        this.spritesBatch.draw(group._sprites, cullOutOfScreen);\r\n        this.spritesBatch.end();\r\n    }\r\n\r\n    /**\r\n     * Set the currently active texture.\r\n     * @private\r\n     * @param {TextureAsset} texture Texture to set.\r\n     */\r\n    _setActiveTexture(texture)\r\n    {\r\n        if (this._activeEffect.setTexture(texture)) {\r\n            this._setTextureFilter(texture.filter || this.defaultTextureFilter);\r\n            this._setTextureWrapMode(texture.wrapMode || this.defaultTextureWrapMode);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the blend modes enum.\r\n     * * AlphaBlend\r\n     * * Opaque\r\n     * * Additive\r\n     * * Multiply\r\n     * * Subtract\r\n     * * Screen\r\n     * * Overlay\r\n     * * Invert\r\n     * * DestIn\r\n     * * DestOut\r\n     * \r\n     * ![Blend Modes](resources/blend-modes.png)\r\n     * @see BlendModes\r\n     */\r\n    get BlendModes()\r\n    {\r\n        return BlendModes;\r\n    }\r\n \r\n    /**\r\n     * Get the wrap modes enum.\r\n     * * Clamp: when uv position exceed texture boundaries it will be clamped to the nearest border, ie repeat the edge pixels.\r\n     * * Repeat: when uv position exceed texture boundaries it will wrap back to the other side.\r\n     * * RepeatMirrored: when uv position exceed texture boundaries it will wrap back to the other side but also mirror the texture.\r\n     * \r\n     * ![Wrap Modes](resources/wrap-modes.png)\r\n     * @see TextureWrapModes\r\n     */\r\n    get TextureWrapModes()\r\n    {\r\n        return TextureWrapModes;\r\n    }\r\n\r\n    /**\r\n     * Get texture filter modes.\r\n     * * Nearest: no filtering, no mipmaps (pixelated).\r\n     * * Linear: simple filtering, no mipmaps (smooth).\r\n     * * NearestMipmapNearest: no filtering, sharp switching between mipmaps,\r\n     * * LinearMipmapNearest: filtering, sharp switching between mipmaps.\r\n     * * NearestMipmapLinear: no filtering, smooth transition between mipmaps.\r\n     * * LinearMipmapLinear: filtering, smooth transition between mipmaps.\r\n     * \r\n     * ![Filter Modes](resources/filter-modes.png)\r\n     * @see TextureFilterModes\r\n     */\r\n    get TextureFilterModes()\r\n    {\r\n        return TextureFilterModes;\r\n    }\r\n\r\n    /**\r\n     * Get number of actual WebGL draw calls we performed since the beginning of the frame.\r\n     * @returns {Number} Number of WebGL draw calls this frame.\r\n     */\r\n    get drawCallsCount()\r\n    {\r\n        return this._drawCallsCount;\r\n    }\r\n\r\n    /**\r\n     * Get number of textured / colored quads we drawn since the beginning of the frame.\r\n     * @returns {Number} Number of quads drawn in this frame..\r\n     */\r\n    get quadsDrawCount()\r\n    {\r\n        return this._drawQuadsCount;\r\n    }\r\n\r\n    /**\r\n     * Clear screen to a given color.\r\n     * @example\r\n     * Shaku.gfx.clear(Shaku.utils.Color.cornflowerblue);\r\n     * @param {Color=} color Color to clear screen to, or black if not set.\r\n     */\r\n    clear(color)\r\n    {\r\n        this.presentBufferedData();\r\n        color = color || Color.black;\r\n        this._gl.clearColor(color.r, color.g, color.b, color.a);\r\n        this._gl.clear(this._gl.COLOR_BUFFER_BIT | this._gl.DEPTH_BUFFER_BIT);\r\n    }\r\n    \r\n    /**\r\n     * Set texture mag and min filters.\r\n     * @private\r\n     * @param {TextureFilterMode} filter Texture filter to set.\r\n     */\r\n    _setTextureFilter(filter)\r\n    {\r\n        if (!TextureFilterModes._values.has(filter)) { throw new Error(\"Invalid texture filter mode! Please pick a value from 'TextureFilterModes'.\"); }\r\n        let glMode = this._gl[filter];\r\n        this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MIN_FILTER, glMode);\r\n        this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MAG_FILTER, glMode);\r\n    }\r\n\r\n    /**\r\n     * Set texture wrap mode on X and Y axis.\r\n     * @private\r\n     * @param {TextureWrapMode} wrapX Wrap mode on X axis.\r\n     * @param {TextureWrapMode} wrapY Wrap mode on Y axis.\r\n     */\r\n    _setTextureWrapMode(wrapX, wrapY)\r\n    {\r\n        if (wrapY === undefined) { wrapY = wrapX; }\r\n        if (!TextureWrapModes._values.has(wrapX)) { throw new Error(\"Invalid texture wrap mode! Please pick a value from 'TextureWrapModes'.\"); }\r\n        if (!TextureWrapModes._values.has(wrapY)) { throw new Error(\"Invalid texture wrap mode! Please pick a value from 'TextureWrapModes'.\"); }\r\n        this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_S, this._gl[wrapX]);\r\n        this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_T, this._gl[wrapY]);\r\n    }\r\n\r\n    /**\r\n     * Set blend mode before drawing.\r\n     * @private\r\n     * @param {BlendMode} blendMode New blend mode to set.\r\n     */\r\n    _setBlendMode(blendMode)\r\n    {\r\n        if (this._lastBlendMode !== blendMode) {\r\n\r\n            // get gl context and set defaults\r\n            var gl = this._gl;\r\n            switch (blendMode) \r\n            {\r\n                case BlendModes.AlphaBlend:\r\n                    gl.enable(gl.BLEND);\r\n                    gl.blendEquation(gl.FUNC_ADD);\r\n                    gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n                    break;\r\n\r\n                case BlendModes.Opaque:\r\n                    gl.disable(gl.BLEND);\r\n                    break;\r\n\r\n                case BlendModes.Additive:\r\n                    gl.enable(gl.BLEND);\r\n                    gl.blendEquation(gl.FUNC_ADD);\r\n                    gl.blendFunc(gl.ONE, gl.ONE);\r\n                    break;\r\n                    \r\n                case BlendModes.Multiply:\r\n                    gl.enable(gl.BLEND);\r\n                    gl.blendEquation(gl.FUNC_ADD);\r\n                    gl.blendFuncSeparate(gl.DST_COLOR, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n                    break;\r\n\r\n                case BlendModes.Screen:\r\n                    gl.enable(gl.BLEND);\r\n                    gl.blendEquation(gl.FUNC_ADD);\r\n                    gl.blendFuncSeparate(gl.ONE, gl.ONE_MINUS_SRC_COLOR, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n                    break;\r\n\r\n                case BlendModes.Subtract:\r\n                    gl.enable(gl.BLEND);\r\n                    gl.blendEquation(gl.FUNC_ADD);\r\n                    gl.blendFuncSeparate(gl.ONE, gl.ONE, gl.ONE, gl.ONE);\r\n                    gl.blendEquationSeparate(gl.FUNC_REVERSE_SUBTRACT, gl.FUNC_ADD);\r\n                    break;\r\n\r\n                case BlendModes.Invert:\r\n                    gl.enable(gl.BLEND);\r\n                    gl.blendEquation(gl.FUNC_ADD);\r\n                    gl.blendFunc(gl.ONE_MINUS_DST_COLOR, gl.ZERO);\r\n                    gl.blendFuncSeparate(gl.ONE_MINUS_DST_COLOR, gl.ZERO, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n                    break;\r\n\r\n                case BlendModes.Overlay:\r\n                    gl.enable(gl.BLEND);\r\n                    if (gl.MAX) {\r\n                        gl.blendEquation(gl.MAX);\r\n                        gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n                    } else {\r\n                        gl.blendEquation(gl.FUNC_ADD);\r\n                        gl.blendFunc(gl.ONE, gl.ONE);\r\n                    }\r\n                    break;\r\n\r\n                case BlendModes.Darken:\r\n                    gl.enable(gl.BLEND);\r\n                    gl.blendEquation(gl.MIN);\r\n                    gl.blendFuncSeparate(gl.DST_COLOR, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n                    break;\r\n\r\n                case BlendModes.DestIn:\r\n                    gl.enable(gl.BLEND);\r\n                    gl.blendEquation(gl.FUNC_ADD);\r\n                    gl.blendFunc(gl.ZERO, gl.SRC_ALPHA);\r\n                    break;\r\n\r\n                case BlendModes.DestOut:\r\n                    gl.enable(gl.BLEND);\r\n                    gl.blendEquation(gl.FUNC_ADD);\r\n                    gl.blendFunc(gl.ZERO, gl.ONE_MINUS_SRC_ALPHA);\r\n                    // can also use: gl.blendFunc(gl.ONE_MINUS_DST_COLOR, gl.ONE_MINUS_SRC_COLOR);\r\n                    break;\r\n\r\n                default:\r\n                    throw new Error(`Unknown blend mode '${blendMode}'!`);\r\n            }\r\n\r\n            // store last blend mode\r\n            this._lastBlendMode = blendMode;\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Present all currently buffered data.\r\n     */\r\n    presentBufferedData()\r\n    {\r\n        this.__finishDrawingSprites();\r\n    }\r\n\r\n    /**\r\n     * Called internally before drawing a sprite to prepare some internal stuff.\r\n     * @private\r\n     */\r\n    __startDrawingSprites(activeEffect, transform)\r\n    {\r\n        // check if should break due to effect or transform change\r\n        if (this.spritesBatch.drawing) {\r\n            if (this.spritesBatch._effect !== activeEffect || this.spritesBatch._transform !== transform) {\r\n                this.spritesBatch.end();\r\n            }\r\n        }\r\n\r\n        // start sprites batch\r\n        if (!this.spritesBatch.drawing) {\r\n            this.spritesBatch.begin(activeEffect, transform);\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Called internally to present sprites batch, if currently drawing sprites.\r\n     * @private\r\n     */\r\n    __finishDrawingSprites()\r\n    {\r\n        if (this.spritesBatch.drawing) {\r\n            this.spritesBatch.end();\r\n        }\r\n    }\r\n    \r\n    /** \r\n     * @inheritdoc\r\n     * @private\r\n     */\r\n    startFrame()\r\n    {\r\n        // reset some states\r\n        this._lastBlendMode = null;\r\n        this._drawCallsCount = 0;\r\n        this._drawQuadsCount = 0;\r\n    }\r\n\r\n    /** \r\n     * @inheritdoc\r\n     * @private\r\n     */\r\n    endFrame()\r\n    {\r\n        this.presentBufferedData();\r\n    }\r\n\r\n    /** \r\n     * @inheritdoc\r\n     * @private\r\n     */\r\n    destroy()\r\n    {\r\n        _logger.warn(\"Cleaning up WebGL is not supported yet!\");\r\n    }\r\n}\r\n\r\n// export main object\r\nmodule.exports = new Gfx();", "/**\r\n * Just an alias to main manager so we can require() this folder as a package.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\gfx\\index.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\n module.exports = require('./gfx');", "/**\r\n * Implement sound asset type.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\assets\\sound_asset.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst Asset = require(\"./asset\");\r\n\r\n \r\n/**\r\n * A loadable sound asset.\r\n * This is the asset type you use to play sounds.\r\n */\r\nclass SoundAsset extends Asset\r\n{\r\n    /** @inheritdoc */\r\n    constructor(url)\r\n    {\r\n        super(url);\r\n        this._valid = false;\r\n    }\r\n\r\n\r\n    /**\r\n     * Load the sound asset from its URL.\r\n     * Note that loading sounds isn't actually necessary to play sounds, this method merely pre-load the asset (so first time we play\r\n     * the sound would be immediate and not delayed) and validate the data is valid. \r\n     * @returns {Promise} Promise to resolve when fully loaded.\r\n     */\r\n    load()\r\n    {\r\n        // for audio files we force preload and validation of the audio file.\r\n        // note: we can't use the Audio object as it won't work without page interaction.\r\n        return new Promise((resolve, reject) => {\r\n\r\n            // create request to load audio file\r\n            let audioCtx = new (window.AudioContext || window.webkitAudioContext)();\r\n            var request = new XMLHttpRequest();\r\n            request.open('GET', this.url, true);\r\n            request.responseType = 'arraybuffer';     \r\n\r\n            // on load, validate audio content\r\n            request.onload = () => \r\n            {\r\n                var audioData = request.response;\r\n                this._valid = true; // <-- good enough for now, as decodeAudio won't work before user's input\r\n                this._notifyReady();\r\n                audioCtx.decodeAudioData(audioData, function(buffer) {\r\n                    resolve();\r\n                },\r\n                (e) => { \r\n                    reject(e.err); \r\n                });\r\n            }\r\n\r\n            // on load error, reject\r\n            request.onerror = (e) => {\r\n                reject(e);\r\n            }\r\n\r\n            // initiate request\r\n            request.send();\r\n        });\r\n    }\r\n\r\n    /** @inheritdoc */\r\n    get valid()\r\n    {\r\n        return this._valid;\r\n    }\r\n    \r\n    /** @inheritdoc */\r\n    destroy()\r\n    {\r\n        this._valid = false;\r\n    }\r\n}\r\n\r\n \r\n// export the asset type.\r\nmodule.exports = SoundAsset;", "/**\r\n * Implement a sound effect instance.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\sfx\\sound_instance.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst _logger = require('../logger.js').getLogger('sfx');\r\n\r\n\r\n/**\r\n * A sound effect instance you can play and stop.\r\n */\r\nclass SoundInstance\r\n{\r\n    /**\r\n    * Create a sound instance.\r\n    * @param {Sfx} sfxManager Sfx manager instance.\r\n    * @param {String} url Sound URL or source.\r\n    */\r\n    constructor(sfxManager, url)\r\n    {\r\n        if (!url) {\r\n            _logger.error(\"Sound type can't be null or invalid!\");\r\n            throw new Error(\"Invalid sound type to play in SoundInstance!\");\r\n        }\r\n        this._sfx = sfxManager;\r\n        this._audio = new Audio(url);\r\n        this._volume = 1;\r\n    }\r\n\r\n    /**\r\n     * Dispose the audio object when done playing the sound.\r\n     * This will call dispose() automatically when audio ends.\r\n     */\r\n    disposeWhenDone()\r\n    {\r\n        this._audio.onended = () => {\r\n            this.dispose();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Dispose the audio object and clear its resources.\r\n     * When playing lots of sounds its important to call dispose on sounds you no longer use, to avoid getting hit by\r\n     * \"Blocked attempt to create a WebMediaPlayer\" exception.\r\n     */\r\n    dispose()\r\n    {\r\n        this._audio.src = \"\";\r\n        this._audio.srcObject = null;\r\n        this._audio.remove();\r\n        this._audio = null;\r\n    }\r\n\r\n    /**\r\n    * Play sound.\r\n    * @returns {Promise} Promise to return when sound start playing.\r\n    */\r\n    play()\r\n    {\r\n        if (this.playing) { return; }\r\n        let promise = this._audio.play();\r\n        this._sfx._playingSounds.add(this);\r\n        return promise;\r\n    }\r\n\r\n    /**\r\n    * Get sound effect playback rate.\r\n    * @returns {Number} Playback rate.\r\n    */\r\n    get playbackRate()\r\n    {\r\n        return this._audio.playbackRate;\r\n    }\r\n\r\n    /**\r\n    * Set playback rate.\r\n    * @param {Number} val Playback value to set.\r\n    */\r\n    set playbackRate(val)\r\n    {\r\n        if (val < 0.1) { _logger.error(\"playbackRate value set is too low, value was capped to 0.1.\"); }\r\n        if (val > 10) { _logger.error(\"playbackRate value set is too high, value was capped to 10.\"); }\r\n        this._audio.playbackRate = val;\r\n    }\r\n    \r\n    /**\r\n    * Get if to preserve pitch while changing playback rate.\r\n    * @returns {Boolean} Preserve pitch state of the sound instance.\r\n    */\r\n    get preservesPitch()\r\n    {\r\n        return Boolean(this._audio.preservesPitch || this._audio.mozPreservesPitch);\r\n    }\r\n\r\n    /**\r\n    * Set if to preserve pitch while changing playback rate.\r\n    * @param {Boolean} val New preserve pitch value to set.\r\n    */\r\n    set preservesPitch(val)\r\n    {\r\n        return this._audio.preservesPitch = this._audio.mozPreservesPitch = Boolean(val);\r\n    }\r\n\r\n    /**\r\n    * Pause the sound.\r\n    */\r\n    pause()\r\n    {\r\n        this._audio.pause();\r\n    }\r\n\r\n    /**\r\n    * Replay sound from start.\r\n    * @returns {Promise} Promise to return when sound start playing.\r\n    */\r\n    replay()\r\n    {\r\n        this.stop();\r\n        return this.play();\r\n    }\r\n\r\n    /**\r\n    * Stop the sound and go back to start.\r\n    * @returns {Boolean} True if successfully stopped sound, false otherwise.\r\n    */\r\n    stop()\r\n    {\r\n        try {\r\n            this.pause();\r\n            this.currentTime = 0;\r\n            return true;\r\n        }\r\n        catch(e) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n    * Get if playing in loop.\r\n    * @returns {Boolean} If this sound should play in loop.\r\n    */\r\n    get loop()\r\n    {\r\n        return this._audio.loop;\r\n    }\r\n\r\n    /**\r\n    * Set if playing in loop.\r\n    * @param {Boolean} value If this sound should play in loop.\r\n    */\r\n    set loop(value)\r\n    {\r\n        this._audio.loop = value;\r\n        return this._audio.loop;\r\n    }\r\n\r\n    /**\r\n    * Get volume.\r\n    * @returns {Number} Sound effect volume.\r\n    */\r\n    get volume()\r\n    {\r\n        return this._volume;\r\n    }\r\n\r\n    /**\r\n    * Set volume.\r\n    * @param {Number} value Sound effect volume to set.\r\n    */\r\n    set volume(value)\r\n    {\r\n        this._volume = value;\r\n        var volume = (value * SoundInstance._masterVolume);\r\n        if (volume < 0) { volume = 0; }\r\n        if (volume > 1) { volume = 1; }\r\n        this._audio.volume = volume;\r\n        return this._volume;\r\n    }\r\n\r\n    /**\r\n    * Get current time in track.\r\n    * @returns {Number} Current time in playing sound.\r\n    */\r\n    get currentTime()\r\n    {\r\n        return this._audio.currentTime;\r\n    }\r\n\r\n    /**\r\n    * Set current time in track.\r\n    * @param {Number} value Set current playing time in sound track.\r\n    */\r\n    set currentTime(value)\r\n    {\r\n        return this._audio.currentTime = value;\r\n    }\r\n\r\n    /**\r\n    * Get track duration.\r\n    * @returns {Number} Sound duration in seconds.\r\n    */\r\n    get duration()\r\n    {\r\n        return this._audio.duration;\r\n    }\r\n\r\n    /**\r\n    * Get if sound is currently paused.\r\n    * @returns {Boolean} True if sound is currently paused.\r\n    */\r\n    get paused()\r\n    {\r\n        return this._audio.paused;\r\n    }\r\n\r\n    /**\r\n    * Get if sound is currently playing.\r\n    * @returns {Boolean} True if sound is currently playing.\r\n    */\r\n    get playing()\r\n    {\r\n        return !this.paused && !this.finished;\r\n    }\r\n\r\n    /**\r\n    * Get if finished playing.\r\n    * @returns {Boolean} True if sound reached the end and didn't loop.\r\n    */\r\n    get finished()\r\n    {\r\n        return this._audio.ended;\r\n    }\r\n}\r\n\r\n\r\n// master volume\r\nSoundInstance._masterVolume = 1;\r\n\r\n\r\n// export main object\r\nmodule.exports = SoundInstance;", "/**\r\n * Implement a sound mixer class.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\sfx\\sound_mixer.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst SoundInstance = require(\"./sound_instance.js\");\r\n\r\n\r\n/**\r\n * A utility class to mix between two sounds.\r\n */\r\nclass SoundMixer\r\n{\r\n    /**\r\n     * Create the sound mixer.\r\n     * @param {SoundInstance} sound1 Sound to mix from. Can be null to just fade in.\r\n     * @param {SoundInstance} sound2 Sound to mix to. Can be null to just fade out.\r\n     * @param {Boolean} allowOverlapping If true (default), will mix while overlapping sounds. \r\n     *                                   If false, will first finish first sound before begining next.\r\n     */\r\n    constructor(sound1, sound2, allowOverlapping)\r\n    {\r\n        this._sound1 = sound1;\r\n        this._sound2 = sound2;\r\n        this.fromSoundVolume = this._sound1 ? this._sound1.volume : 0;\r\n        this.toSoundVolume = this._sound2 ? this._sound2.volume : 0;\r\n        this.allowOverlapping = allowOverlapping;\r\n        this.update(0);\r\n    }\r\n\r\n    /**\r\n     * Stop both sounds.\r\n     */\r\n    stop()\r\n    {\r\n        if (this._sound1) { this._sound1.stop(); }\r\n        if (this._sound2) { this._sound2.stop(); }\r\n    }\r\n\r\n    /**\r\n     * Get first sound.\r\n     * @returns {SoundInstance} First sound instance.\r\n     */\r\n    get fromSound()\r\n    {\r\n        return this._sound1;\r\n    }\r\n\r\n    /**\r\n     * Get second sound.\r\n     * @returns {SoundInstance} Second sound instance.\r\n     */\r\n    get toSound()\r\n    {\r\n        return this._sound2;\r\n    }\r\n\r\n    /**\r\n     * Return current progress.\r\n     * @returns {Number} Mix progress from 0 to 1.\r\n     */\r\n    get progress()\r\n    {\r\n        return this._progress;\r\n    }\r\n\r\n    /**\r\n     * Update the mixer progress with time delta instead of absolute value.\r\n     * @param {Number} delta Progress delta, in seconds.\r\n     */\r\n    updateDelta(delta)\r\n    {\r\n        this.update(this._progress + delta);\r\n    }\r\n\r\n    /**\r\n     * Update the mixer progress.\r\n     * @param {Number} progress Transition progress from sound1 to sound2. Values must be between 0.0 to 1.0.\r\n     */\r\n    update(progress)\r\n    {\r\n        // special case - start\r\n        if (progress <= 0) {\r\n            if (this._sound1) { \r\n                this._sound1.volume = this.fromSoundVolume;\r\n            }\r\n            if (this._sound2) {\r\n                this._sound2.volume = 0;\r\n                this._sound2.stop();\r\n            }\r\n            this._progress = 0;\r\n        }\r\n        // special case - finish\r\n        if (progress >= 1) {\r\n            if (this._sound2) {\r\n                this._sound2.volume = this.toSoundVolume;\r\n            }\r\n            if (this._sound1) { \r\n                this._sound1.volume = 0;\r\n                this._sound1.stop();\r\n            }\r\n            this._progress = 1;\r\n        }\r\n        // transition\r\n        else\r\n        {\r\n            this._progress = progress;\r\n            if (this._sound1) { this._sound1.play(); }\r\n            if (this._sound2) { this._sound2.play(); }\r\n\r\n            if (this.allowOverlapping) {\r\n                if (this._sound1) { this._sound1.volume =  this.fromSoundVolume * (1 - progress); }  \r\n                if (this._sound2) { this._sound2.volume =  this.toSoundVolume * progress; }\r\n            }\r\n            else {\r\n                progress *= 2;\r\n                if (this._sound1) { this._sound1.volume =  Math.max(this.fromSoundVolume * (1 - progress), 0); }\r\n                if (this._sound2) { this._sound2.volume =  Math.max(this.toSoundVolume * (progress - 1), 0); }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// export the sound mixer\r\nmodule.exports = SoundMixer;", "/**\r\n * Implement the sfx manager.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\sfx\\sfx.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst SoundAsset = require('../assets/sound_asset.js');\r\nconst IManager = require('../manager.js');\r\nconst _logger = require('../logger.js').getLogger('sfx');\r\nconst SoundInstance = require('./sound_instance.js');\r\nconst SoundMixer = require('./sound_mixer.js');\r\n \r\n\r\n/**\r\n * Sfx manager. \r\n * Used to play sound effects and music.\r\n * \r\n * To access the Sfx manager use `Shaku.sfx`. \r\n */\r\nclass Sfx extends IManager\r\n{\r\n    /**\r\n     * Create the manager.\r\n     */\r\n    constructor()\r\n    {\r\n        super();\r\n        this._playingSounds = null;\r\n    }\r\n\r\n    /** \r\n     * @inheritdoc \r\n     * @private\r\n     **/\r\n    setup()\r\n    {        \r\n        return new Promise((resolve, reject) => {    \r\n            _logger.info(\"Setup sfx manager..\");\r\n            this._playingSounds = new Set();\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    /** \r\n     * @inheritdoc \r\n     * @private\r\n     **/\r\n    startFrame()\r\n    {\r\n        var playingSounds = Array.from(this._playingSounds);\r\n        for (var i = 0; i < playingSounds.length; ++i) {\r\n            var sound = playingSounds[i];\r\n            if (!sound.isPlaying) {\r\n                this._playingSounds.delete(sound);\r\n            }\r\n        }\r\n    }\r\n\r\n    /** \r\n     * @inheritdoc \r\n     * @private\r\n     **/\r\n    endFrame()\r\n    {\r\n        var playingSounds = Array.from(this._playingSounds);\r\n        for (var i = 0; i < playingSounds.length; ++i) {\r\n            var sound = playingSounds[i];\r\n            if (!sound.isPlaying) {\r\n                this._playingSounds.delete(sound);\r\n            }\r\n        }\r\n    }\r\n\r\n    /** \r\n     * @inheritdoc \r\n     * @private\r\n     **/\r\n    destroy()\r\n    {\r\n        this.stopAll();\r\n        this._playingSounds = new Set();\r\n    }\r\n\r\n    /**\r\n     * Get the SoundMixer class.\r\n     * @see SoundMixer\r\n     */\r\n    get SoundMixer()\r\n    {\r\n        return SoundMixer;\r\n    }\r\n\r\n    /**\r\n     * Play a sound once without any special properties and without returning a sound instance.\r\n     * Its a more convinient method to play sounds, but less efficient than 'createSound()' if you want to play multiple times.\r\n     * @example\r\n     * let sound = await Shaku.assets.loadSound(\"assets/my_sound.ogg\");\r\n     * Shaku.sfx.play(sound, 0.75);\r\n     * @param {SoundAsset} sound Sound asset to play.\r\n     * @param {Number} volume Volume to play sound (default to max).\r\n     * @param {Number} playbackRate Optional playback rate factor.\r\n     * @param {Boolean} preservesPitch Optional preserve pitch when changing rate factor.\r\n     * @returns {Promise} Promise to resolve when sound starts playing.\r\n     */\r\n    play(sound, volume, playbackRate, preservesPitch)\r\n    {\r\n        var sound = this.createSound(sound);\r\n        sound.volume = volume !== undefined ? volume : 1;\r\n        if (playbackRate !== undefined) { sound.playbackRate = playbackRate; }\r\n        if (preservesPitch !== undefined) { sound.preservesPitch = preservesPitch; }\r\n        let ret = sound.play();\r\n        sound.disposeWhenDone();\r\n        return ret;\r\n    }\r\n\r\n    /**\r\n     * Stop all playing sounds.\r\n     * @example\r\n     * Shaku.sfx.stopAll();\r\n     */\r\n    stopAll()\r\n    {\r\n        var playingSounds = Array.from(this._playingSounds);\r\n        for (var i = 0; i < playingSounds.length; ++i) {\r\n            var sound = playingSounds[i];\r\n            sound.stop();\r\n        }\r\n        this._playingSounds = new Set();\r\n    }\r\n\r\n    /**\r\n     * Get currently playing sounds count.\r\n     * @returns {Number} Number of sounds currently playing.\r\n     */\r\n    get playingSoundsCount()\r\n    {\r\n        return this._playingSounds.size;\r\n    }\r\n\r\n    /**\r\n     * Create and return a sound instance you can use to play multiple times.\r\n     * @example\r\n     * let sound = await Shaku.assets.loadSound(\"assets/my_sound.ogg\");\r\n     * let soundInstance = Shaku.sfx.createSound(sound);\r\n     * soundInstance.play();\r\n     * @param {SoundAsset} sound Sound asset to play.\r\n     * @returns {SoundInstance} Newly created sound instance.\r\n     */\r\n    createSound(sound)\r\n    {\r\n        if (!(sound instanceof SoundAsset)) { throw new Error(\"Sound type must be an instance of SoundAsset!\"); }\r\n        var ret = new SoundInstance(this, sound.url);\r\n        return ret;\r\n    }\r\n\r\n    /**\r\n     * Get master volume.\r\n     * This affect all sound effects volumes.\r\n     * @returns {Number} Current master volume value.\r\n     */\r\n    get masterVolume()\r\n    {\r\n        return SoundInstance._masterVolume;\r\n    }\r\n    \r\n    /**\r\n     * Set master volume.\r\n     * This affect all sound effects volumes.\r\n     * @param {Number} value Master volume to set.\r\n     */\r\n    set masterVolume(value)\r\n    {\r\n        SoundInstance._masterVolume = value;\r\n        return value;\r\n    }\r\n}\r\n\r\n// export main object\r\nmodule.exports = new Sfx();", "/**\r\n * Just an alias to main manager so we can require() this folder as a package.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\sfx\\index.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\n module.exports = require('./sfx');", "/**\r\n * Define keyboard and mouse key codes.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\input\\key_codes.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\n/** @typedef {Number} MouseButton */\r\n\r\n/**\r\n * Define mouse button codes.\r\n * @readonly\r\n * @enum {MouseButton}\r\n */\r\nconst MouseButtons = {\r\n    left: 0,\r\n    middle: 1,\r\n    right: 2,\r\n};\r\n\r\n/** @typedef {Number} KeyboardKey */\r\n\r\n/**\r\n * Define all keyboard key codes.\r\n * @readonly\r\n * @enum {KeyboardKey}\r\n */\r\nconst KeyboardKeys = {\r\n    backspace: 8,\r\n    tab: 9,\r\n    enter: 13,\r\n    shift: 16,\r\n    ctrl: 17,\r\n    alt: 18,\r\n    break: 19,\r\n    caps_lock: 20,\r\n    escape: 27,\r\n    page_up: 33,\r\n    page_down: 34,\r\n    end: 35,\r\n    home: 36,\r\n    left: 37,\r\n    up: 38,\r\n    right: 39,\r\n    down: 40,\r\n    insert: 45,\r\n    delete: 46,\r\n    space: 32,\r\n    n0: 48,\r\n    n1: 49,\r\n    n2: 50,\r\n    n3: 51,\r\n    n4: 52,\r\n    n5: 53,\r\n    n6: 54,\r\n    n7: 55,\r\n    n8: 56,\r\n    n9: 57,\r\n    a: 65,\r\n    b: 66,\r\n    c: 67,\r\n    d: 68,\r\n    e: 69,\r\n    f: 70,\r\n    g: 71,\r\n    h: 72,\r\n    i: 73,\r\n    j: 74,\r\n    k: 75,\r\n    l: 76,\r\n    m: 77,\r\n    n: 78,\r\n    o: 79,\r\n    p: 80,\r\n    q: 81,\r\n    r: 82,\r\n    s: 83,\r\n    t: 84,\r\n    u: 85,\r\n    v: 86,\r\n    w: 87,\r\n    x: 88,\r\n    y: 89,\r\n    z: 90,\r\n    left_window_key: 91,\r\n    right_window_key: 92,\r\n    select_key: 93,\r\n    numpad_0: 96,\r\n    numpad_1: 97,\r\n    numpad_2: 98,\r\n    numpad_3: 99,\r\n    numpad_4: 100,\r\n    numpad_5: 101,\r\n    numpad_6: 102,\r\n    numpad_7: 103,\r\n    numpad_8: 104,\r\n    numpad_9: 105,\r\n    multiply: 106,\r\n    add: 107,\r\n    subtract: 109,\r\n    decimal_point: 110,\r\n    divide: 111,\r\n    f1: 112,\r\n    f2: 113,\r\n    f3: 114,\r\n    f4: 115,\r\n    f5: 116,\r\n    f6: 117,\r\n    f7: 118,\r\n    f8: 119,\r\n    f9: 120,\r\n    f10: 121,\r\n    f11: 122,\r\n    f12: 123,\r\n    numlock: 144,\r\n    scroll_lock: 145,\r\n    semicolon: 186,\r\n    equal_sign: 187,\r\n    plus: 187,\r\n    comma: 188,\r\n    dash: 189,\r\n    minus: 189,\r\n    period: 190,\r\n    forward_slash: 191,\r\n    grave_accent: 192,\r\n    open_bracket: 219,\r\n    back_slash: 220,\r\n    close_braket: 221,\r\n    single_quote: 222,\r\n};\r\n\r\n// export keyboard keys and mouse buttons\r\nmodule.exports = { KeyboardKeys: KeyboardKeys, MouseButtons: MouseButtons };", "/**\r\n * Implement the input manager.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\input\\input.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst IManager = require('../manager.js');\r\nconst Vector2 = require('../utils/vector2.js');\r\nconst { MouseButton, MouseButtons, KeyboardKey, KeyboardKeys } = require('./key_codes.js');\r\nconst _logger = require('../logger.js').getLogger('input');\r\n\r\n\r\n/**\r\n * Input manager. \r\n * Used to recieve input from keyboard and mouse.\r\n * \r\n * To access the Input manager use `Shaku.input`. \r\n */\r\nclass Input extends IManager\r\n{\r\n    /**\r\n     * Create the manager.\r\n     */\r\n    constructor()\r\n    {\r\n        super();\r\n        \r\n        // callbacks and target we listen to input on\r\n        this._callbacks = null;\r\n        this._targetElement = window;\r\n\r\n        // export mouse and keyboard keys\r\n        this.MouseButtons = MouseButtons;\r\n        this.KeyboardKeys = KeyboardKeys;\r\n\r\n        // if true, will prevent default events by calling preventDefault()\r\n        this.preventDefaults = false;\r\n\r\n        // by default, when holding wheel button down browsers will turn into special page scroll mode and will not emit mouse move events.\r\n        // if this property is set to true, StInput will prevent this behavior, so we could still get mouse delta while mouse wheel is held down.\r\n        this.enableMouseDeltaWhileMouseWheelDown = true;\r\n\r\n        // if true, will disable the context menu (right click)\r\n        this.disableContextMenu = true;\r\n\r\n        // should we reset on focus lost?\r\n        this.resetOnFocusLoss = true;\r\n\r\n        // set base state members\r\n        this._resetAll();\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     * @private\r\n     **/\r\n    setup()\r\n    {        \r\n        return new Promise((resolve, reject) => {\r\n\r\n            _logger.info(\"Setup input manager..\");\r\n\r\n            // if target element is a method, invoke it\r\n            if (typeof this._targetElement === 'function') {\r\n                this._targetElement = this._targetElement();\r\n                if (!this._targetElement) {\r\n                    throw new Error(\"Input target element was set to be a method, but the returned value was invalid!\");\r\n                }\r\n            }\r\n\r\n            // get element to attach to\r\n            let element = this._targetElement;\r\n\r\n            // to make sure keyboard input would work if provided with canvas entity\r\n            if (element.tabIndex === -1 || element.tabIndex === undefined) {\r\n                element.tabIndex = 1000;\r\n            }\r\n\r\n            // focus on target element\r\n            window.setTimeout(() => element.focus(), 0);\r\n\r\n            // set all the events to listen to\r\n            var _this = this;\r\n            this._callbacks = {\r\n                'mousedown': function(event) {_this._onMouseDown(event); if (this.preventDefaults) event.preventDefault(); },\r\n                'mouseup': function(event) {_this._onMouseUp(event); if (this.preventDefaults) event.preventDefault(); },\r\n                'mousemove': function(event) {_this._onMouseMove(event); if (this.preventDefaults) event.preventDefault(); },\r\n                'keydown': function(event) {_this._onKeyDown(event); if (this.preventDefaults) event.preventDefault(); },\r\n                'keyup': function(event) {_this._onKeyUp(event); if (this.preventDefaults) event.preventDefault(); },\r\n                'blur': function(event) {_this._onBlur(event); if (this.preventDefaults) event.preventDefault(); },\r\n                'wheel': function(event) {_this._onMouseWheel(event); },\r\n                'touchstart': function(event) {_this._onTouchStart(event); if (this.preventDefaults) event.preventDefault(); },\r\n                'touchend': function(event) {_this._onMouseUp(event); if (this.preventDefaults) event.preventDefault(); },\r\n                'touchmove': function(event) {_this._onTouchMove(event); if (this.preventDefaults) event.preventDefault(); },\r\n                'contextmenu': function(event) { if (_this.disableContextMenu) { event.preventDefault(); } },\r\n            };\r\n\r\n            // reset all data to init initial state\r\n            this._resetAll();\r\n                    \r\n            // register all callbacks\r\n            for (var event in this._callbacks) {\r\n                element.addEventListener(event, this._callbacks[event], false);\r\n            }\r\n\r\n            // if we have a specific element, still capture mouse release outside of it\r\n            if (element !== window) {\r\n                window.addEventListener('mouseup', this._callbacks['mouseup'], false);\r\n                window.addEventListener('touchend', this._callbacks['touchend'], false);\r\n            }\r\n\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     * @private\r\n     **/\r\n    startFrame()\r\n    {\r\n\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     * @private\r\n     **/\r\n    destroy()\r\n    {\r\n        // unregister all callbacks\r\n        if (this._callbacks)\r\n        {\r\n            let element = this._targetElement;\r\n\r\n            for (var event in this._callbacks) {\r\n                element.removeEventListener(event, this._callbacks[event]);\r\n            }\r\n\r\n            if (element !== window) {\r\n                window.removeEventListener('mouseup', this._callbacks['mouseup'], false);\r\n                window.removeEventListener('touchend', this._callbacks['touchend'], false);\r\n            }\r\n            \r\n            this._callbacks = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @callback elementCallback\r\n     * @returns  {Element}\r\n     */\r\n\r\n    /**\r\n     * Set the target element to attach input to. If not called, will just use the entire document.\r\n     * Must be called *before* initializing Shaku. This can also be a method to invoke while initializing.\r\n     * @example\r\n     * // the following will use whatever canvas the gfx manager uses as input element.\r\n     * // this means mouse offset will also be relative to this element.\r\n     * Shaku.input.setTargetElement(() => Shaku.gfx.canvas);\r\n     * @param {Element | elementCallback} element Element to attach input to.\r\n     */\r\n    setTargetElement(element)\r\n    {\r\n        if (this._callbacks) { throw new Error(\"'setTargetElement() must be called before initializing the input manager!\"); }\r\n        this._targetElement = element;\r\n    }\r\n\r\n    /**\r\n     * Reset all internal data and states.\r\n     * @private\r\n     */\r\n    _resetAll()\r\n    {\r\n        // mouse states\r\n        this._mousePos = new Vector2();\r\n        this._mousePrevPos = new Vector2();\r\n        this._mouseState = {};\r\n        this._mousePrevState = {};\r\n        this._mouseWheel = 0;\r\n\r\n        // keyboard keys\r\n        this._keyboardState = {};\r\n        this._keyboardPrevState = {};\r\n\r\n        // reset touch started state\r\n        this._touchStarted = false;\r\n    }\r\n    \r\n    /**\r\n     * Get mouse position.\r\n     * @returns {Vector2} Mouse position.\r\n     */\r\n    get mousePosition()\r\n    {\r\n        return this._mousePos.clone();\r\n    }\r\n        \r\n    /**\r\n     * Get mouse previous position (before the last endFrame() call).\r\n     * @returns {Vector2} Mouse position in previous frame.\r\n     */\r\n    get prevMousePosition()\r\n    {\r\n        return (this._mousePrevPos || this._mousePos).clone();\r\n    }\r\n\r\n    /**\r\n     * Get mouse movement since last endFrame() call.\r\n     * @returns {Vector2} Mouse change since last frame.\r\n     */\r\n    get mouseDelta()\r\n    {\r\n        // no previous position? return 0,0.\r\n        if (!this._mousePrevPos) {\r\n            return Vector2.zero;\r\n        }\r\n\r\n        // return mouse delta\r\n        return new Vector2(this._mousePos.x - this._mousePrevPos.x, this._mousePos.y - this._mousePrevPos.y);\r\n    }\r\n\r\n    /**\r\n     * Get if mouse is currently moving.\r\n     * @returns {Boolean} True if mouse moved since last frame, false otherwise.\r\n     */\r\n    get mouseMoving()\r\n    {\r\n        return (this._mousePrevPos && !this._mousePrevPos.equals(this._mousePos));\r\n    }\r\n\r\n    /**\r\n     * Get if mouse button was pressed this frame.\r\n     * @param {MouseButton} button Button code (defults to MouseButtons.left).\r\n     * @returns {Boolean} True if mouse button is currently down, but was up in previous frame.\r\n     */\r\n    mousePressed(button = 0)\r\n    {\r\n        if (button === undefined) throw new Error(\"Invalid button code!\");\r\n        return Boolean(this._mouseState[button] && !this._mousePrevState[button]);\r\n    }\r\n\r\n    /**\r\n     * Get if mouse button is currently pressed.\r\n     * @param {MouseButton} button Button code (defults to MouseButtons.left).  \r\n     * @returns {Boolean} true if mouse button is currently down, false otherwise.\r\n     */\r\n    mouseDown(button = 0)\r\n    {\r\n        if (button === undefined) throw new Error(\"Invalid button code!\");\r\n        return Boolean(this._mouseState[button]);\r\n    }\r\n\r\n    /**\r\n     * Get if mouse button is currently not down.\r\n     * @param {MouseButton} button Button code (defults to MouseButtons.left).\r\n     * @returns {Boolean} true if mouse button is currently up, false otherwise.\r\n     */\r\n    mouseUp(button = 0)\r\n    {\r\n        if (button === undefined) throw new Error(\"Invalid button code!\");\r\n        return Boolean(!this.mouseDown(button));\r\n    }\r\n    \r\n    /**\r\n     * Get if mouse button was released in current frame.\r\n     * @param {MouseButton} button Button code (defults to MouseButtons.left).\r\n     * @returns {Boolean} True if mouse was down last frame, but released in current frame.\r\n     */\r\n    mouseReleased(button = 0)\r\n    {\r\n        if (button === undefined) throw new Error(\"Invalid button code!\");\r\n        return Boolean(!this._mouseState[button] && this._mousePrevState[button]);\r\n    }\r\n\r\n    /**\r\n     * Get if keyboard key is currently pressed down.\r\n     * @param {KeyboardKey} key Keyboard key code.\r\n     * @returns {boolean} True if keyboard key is currently down, false otherwise.\r\n     */\r\n    keyDown(key)\r\n    {\r\n        if (key === undefined) throw new Error(\"Invalid key code!\");\r\n        return Boolean(this._keyboardState[key]);\r\n    }\r\n\r\n    /**\r\n     * Get if keyboard key is currently not down.\r\n     * @param {KeyboardKey} key Keyboard key code.\r\n     * @returns {Boolean} True if keyboard key is currently up, false otherwise.\r\n     */\r\n    keyUp(key)\r\n    {\r\n        if (key === undefined) throw new Error(\"Invalid key code!\");\r\n        return Boolean(!this.keyDown(key));\r\n    }\r\n\r\n    /**\r\n     * Get if a keyboard button was released in current frame.\r\n     * @param {KeyboardKey} button Keyboard key code.\r\n     * @returns {Boolean} True if key was down last frame, but released in current frame.\r\n     */\r\n    keyReleased(key)\r\n    {\r\n        if (key === undefined) throw new Error(\"Invalid key code!\");\r\n        return Boolean(!this._keyboardState[key] && this._keyboardPrevState[key]);\r\n    }\r\n    \r\n    /**\r\n     * Get if keyboard key was pressed this frame.\r\n     * @param {KeyboardKey} key Keyboard key code.\r\n     * @returns {Boolean} True if key is currently down, but was up in previous frame.\r\n     */\r\n    keyPressed(key)\r\n    {\r\n        if (key === undefined) throw new Error(\"Invalid key code!\");\r\n        return Boolean(this._keyboardState[key] && !this._keyboardPrevState[key]);\r\n    }\r\n\r\n    /**\r\n     * Get if any of the shift keys are currently down.\r\n     * @returns {Boolean} True if there's a shift key pressed down.\r\n     */\r\n    get shiftDown()\r\n    {\r\n        return Boolean(this.keyDown(this.KeyboardKeys.shift));\r\n    }\r\n\r\n    /**\r\n     * Get if any of the Ctrl keys are currently down.\r\n     * @returns {Boolean} True if there's a Ctrl key pressed down.\r\n     */\r\n    get ctrlDown()\r\n    {\r\n        return Boolean(this.keyDown(this.KeyboardKeys.ctrl));\r\n    }\r\n\r\n    /**\r\n     * Get if any of the Alt keys are currently down.\r\n     * @returns {Boolean} True if there's an Alt key pressed down.\r\n     */\r\n    get altDown()\r\n    {\r\n        return Boolean(this.keyDown(this.KeyboardKeys.alt));\r\n    }\r\n\r\n    /**\r\n     * Get if any keyboard key was pressed this frame.\r\n     * @returns {Boolean} True if any key was pressed down this frame.\r\n     */\r\n    get anyKeyPressed()\r\n    {\r\n        for (var key in this._keyboardState) {\r\n            if (this._keyboardState[key] && !this._keyboardPrevState[key]) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Get if any keyboard key is currently down.\r\n     * @returns {Boolean} True if there's a key pressed down.\r\n     */\r\n    get anyKeyDown()\r\n    {\r\n        for (var key in this._keyboardState) {\r\n            if (this._keyboardState[key]) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Get if any mouse button was pressed this frame.\r\n     * @returns {Boolean} True if any of the mouse buttons were pressed this frame.\r\n     */\r\n     get anyMouseButtonPressed()\r\n     {\r\n         for (var key in this._mouseState) {\r\n             if (this._mouseState[key] && !this._mousePrevState[key]) {\r\n                 return true;\r\n             }\r\n         }\r\n         return false;\r\n     }\r\n\r\n    /**\r\n     * Get if any mouse button is down.\r\n     * @returns {Boolean} True if any of the mouse buttons are pressed.\r\n     */\r\n    get anyMouseButtonDown()\r\n    {\r\n        for (var key in this._mouseState) {\r\n            if (this._mouseState[key]) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Return if a mouse or keyboard state in a generic way, used internally.\r\n     * @private\r\n     * @param {string} code Keyboard or mouse code. \r\n     *                          For mouse buttons: mouse_left, mouse_right or mouse_middle.\r\n     *                          For keyboard buttons: use one of the keys of KeyboardKeys (for example 'a', 'alt', 'up_arrow', etc..)\r\n     *                          For numbers (0-9): you can use the number.\r\n     * @param {Function} mouseCheck Callback to use to return value if its a mouse button code.\r\n     * @param {Function} keyboardCheck Callback to use to return value if its a keyboard key code.\r\n     */\r\n    _getValueWithCode(code, mouseCheck, keyboardCheck)\r\n    {\r\n        // make sure code is string\r\n        code = String(code);\r\n\r\n        // if starts with 'mouse' its for mouse button events\r\n        if (code.indexOf('mouse_') === 0) {\r\n\r\n            // get mouse code name\r\n            var codename = code.split('_')[1];\r\n\r\n            // return if mouse down\r\n            return mouseCheck.call(this, this.MouseButtons[codename]);\r\n        }\r\n\r\n        // if its just a number, add the 'n' prefix\r\n        if (!isNaN(parseInt(code)) && code.length === 1) {\r\n            code = 'n' + code;\r\n        }\r\n\r\n        // if not start with 'mouse', treat it as a keyboard key\r\n        return keyboardCheck.call(this, this.KeyboardKeys[code]);\r\n    }\r\n\r\n    /**\r\n     * Return if a mouse or keyboard button is currently down.\r\n     * @param {string|Array<String>} code Keyboard or mouse code. Can be array of codes to test if any of them is down.\r\n     *                          For mouse buttons: mouse_left, mouse_right or mouse_middle.\r\n     *                          For keyboard buttons: use one of the keys of KeyboardKeys (for example 'a', 'alt', 'up_arrow', etc..)\r\n     *                          For numbers (0-9): you can use the number.\r\n     * @returns {Boolean} True if key or mouse button are down.\r\n     */\r\n    down(code)\r\n    {\r\n        if (!(code instanceof Array)) { code = [code]; }\r\n        for (let c of code) {\r\n            if (Boolean(this._getValueWithCode(c, this.mouseDown, this.keyDown))) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Return if a mouse or keyboard button was released in this frame.\r\n     * @param {string|Array<String>} code Keyboard or mouse code. Can be array of codes to test if any of them is released.\r\n     *                          For mouse buttons: mouse_left, mouse_right or mouse_middle.\r\n     *                          For keyboard buttons: use one of the keys of KeyboardKeys (for example 'a', 'alt', 'up_arrow', etc..)\r\n     *                          For numbers (0-9): you can use the number.\r\n     * @returns {Boolean} True if key or mouse button were down in previous frame, and released this frame.\r\n     */\r\n    released(code)\r\n    {\r\n        if (!(code instanceof Array)) { code = [code]; }\r\n        for (let c of code) {\r\n            if (Boolean(this._getValueWithCode(c, this.mouseReleased, this.keyReleased))) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Return if a mouse or keyboard button was pressed in this frame.\r\n     * @param {string|Array<String>} code Keyboard or mouse code. Can be array of codes to test if any of them is pressed.\r\n     *                          For mouse buttons: mouse_left, mouse_right or mouse_middle.\r\n     *                          For keyboard buttons: use one of the keys of KeyboardKeys (for example 'a', 'alt', 'up_arrow', etc..)\r\n     *                          For numbers (0-9): you can use the number.\r\n     * @returns {Boolean} True if key or mouse button where up in previous frame, and pressed this frame.\r\n     */\r\n    pressed(code)\r\n    {\r\n        if (!(code instanceof Array)) { code = [code]; }\r\n        for (let c of code) {\r\n            if (Boolean(this._getValueWithCode(c, this.mousePressed, this.keyPressed))) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Get mouse wheel sign.\r\n     * @returns {Number} Mouse wheel sign (-1 or 1) for wheel scrolling that happened during this frame.\r\n     * Will return 0 if mouse wheel is not currently being used.\r\n     */\r\n    get mouseWheelSign()\r\n    {\r\n        return Math.sign(this._mouseWheel);\r\n    }\r\n\r\n    /**\r\n     * Get mouse wheel value.\r\n     * @returns {Number} Mouse wheel value.\r\n     */\r\n    get mouseWheel()\r\n    {\r\n        return this._mouseWheel;\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     * @private\r\n     **/\r\n    endFrame()\r\n    {\r\n        // set mouse previous position and clear mouse move cache\r\n        this._mousePrevPos = this._mousePos.clone();\r\n\r\n        // set previous keyboard state\r\n        this._keyboardPrevState = {};\r\n        for (var key in this._keyboardState) {\r\n            this._keyboardPrevState[key] = this._keyboardState[key];\r\n        }\r\n\r\n        // set previous mouse state\r\n        this._mousePrevState = {};\r\n        for (var key in this._mouseState) {\r\n            this._mousePrevState[key] = this._mouseState[key];\r\n        }\r\n\r\n        // apply touch start event\r\n        if (this._touchStarted)\r\n        {\r\n            this._mouseState[this.MouseButtons.left] = true;\r\n            this._touchStarted = false;\r\n        }\r\n\r\n        // reset mouse wheel\r\n        this._mouseWheel = 0;\r\n    }\r\n\r\n    /**\r\n     * Get keyboard key code from event.\r\n     * @private\r\n     */\r\n    _getKeyboardKeyCode(event)\r\n    {\r\n        event = this._getEvent(event);\r\n        return event.keyCode !== undefined ? event.keyCode : event.key.charCodeAt(0);\r\n    }\r\n\r\n    /**\r\n     * Called when window loses focus - clear all input states to prevent keys getting stuck.\r\n     * @private\r\n     */\r\n    _onBlur(event)\r\n    {\r\n        if (this.resetOnFocusLoss) {\r\n            this._resetAll();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Handle mouse wheel events.\r\n     * @private\r\n     * @param {*} event Event data from browser.\r\n     */\r\n    _onMouseWheel(event)\r\n    {\r\n        this._mouseWheel = event.deltaY;\r\n    }\r\n\r\n    /**\r\n     * Handle keyboard down event.\r\n     * @private\r\n     * @param {*} event Event data from browser.\r\n     */\r\n    _onKeyDown(event)\r\n    {\r\n        var keycode = this._getKeyboardKeyCode(event);\r\n        this._keyboardState[keycode] = true;\r\n    }\r\n\r\n    /**\r\n     * Handle keyboard up event.\r\n     * @private\r\n     * @param {*} event Event data from browser.\r\n     */\r\n    _onKeyUp(event)\r\n    {\r\n        var keycode = this._getKeyboardKeyCode(event);\r\n        this._keyboardState[keycode || 0] = false;\r\n    }\r\n\r\n    /**\r\n     * Handle touch start event.\r\n     * @private\r\n     * @param {*} event Event data from browser.\r\n     */\r\n    _onTouchStart(event)\r\n    {\r\n        // also update mouse position - this is important for touch events on mobile, where touch move only works while touching,\r\n        // so we want to update mouse position on the moment touch starts\r\n        var touches = event.changedTouches;\r\n        if (touches && touches.length)\r\n        {\r\n            var touch = touches[0];\r\n            var x = touch.pageX || touch.offsetX || touch.clientX;\r\n            var y = touch.pageY || touch.offsetY || touch.clientY;\r\n            if (x !== undefined && y !== undefined) {\r\n                this._mousePos.x = x;\r\n                this._mousePos.y = y;\r\n                this._normalizeMousePos()\r\n            }\r\n        }\r\n\r\n        // mark that touch started - will update state next frame\r\n        this._touchStarted = true;\r\n    }\r\n\r\n    /**\r\n     * Handle mouse down event.\r\n     * @private\r\n     * @param {*} event Event data from browser.\r\n     */\r\n    _onMouseDown(event)\r\n    {\r\n        // update mouse down state\r\n        event = this._getEvent(event);\r\n        if (this.enableMouseDeltaWhileMouseWheelDown && (event.button === this.MouseButtons.middle))\r\n        { \r\n            event.preventDefault(); \r\n        }\r\n        this._mouseState[event.button || 0] = true;\r\n    }\r\n\r\n    /**\r\n     * Handle mouse up event.\r\n     * @private\r\n     * @param {*} event Event data from browser.\r\n     */\r\n    _onMouseUp(event)\r\n    {\r\n        event = this._getEvent(event);\r\n        this._mouseState[event.button || 0] = false;\r\n    }\r\n\r\n    /**\r\n     * Handle touch move event.\r\n     * @private\r\n     * @param {*} event Event data from browser.\r\n     */\r\n    _onTouchMove(event)\r\n    {\r\n        event = this._getEvent(event);\r\n        this._mousePos.x = event.touches[0].pageX;\r\n        this._mousePos.y = event.touches[0].pageY;\r\n        this._normalizeMousePos();\r\n    }\r\n\r\n    /**\r\n     * Handle mouse move event.\r\n     * @private\r\n     * @param {*} event Event data from browser.\r\n     */\r\n    _onMouseMove(event)\r\n    {\r\n        // get event in a cross-browser way\r\n        event = this._getEvent(event);\r\n\r\n        // try to get position from event with some fallbacks\r\n        var pageX = event.clientX; \r\n        if (pageX === undefined) { pageX = event.x; } \r\n        if (pageX === undefined) { pageX = event.offsetX; } \r\n        if (pageX === undefined) { pageX = event.pageX; }\r\n\r\n        var pageY = event.clientY; \r\n        if (pageY === undefined) { pageY = event.y; } \r\n        if (pageY === undefined) { pageY = event.offsetY; } \r\n        if (pageY === undefined) { pageY = event.pageY; }\r\n\r\n        // if pageX and pageY are not supported, use clientX and clientY instead\r\n        if (pageX === undefined) {\r\n            pageX = event.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\r\n            pageY = event.clientY + document.body.scrollTop + document.documentElement.scrollTop;\r\n        }\r\n\r\n        // set current mouse position\r\n        this._mousePos.x = pageX;\r\n        this._mousePos.y = pageY;\r\n        this._normalizeMousePos();\r\n    }\r\n\r\n    /**\r\n     * Normalize current _mousePos value to be relative to target element.\r\n     * @private\r\n     */\r\n    _normalizeMousePos()\r\n    {\r\n        if (this._targetElement && this._targetElement.getBoundingClientRect) {\r\n            var rect = this._targetElement.getBoundingClientRect();\r\n            this._mousePos.x -= rect.left;\r\n            this._mousePos.y -= rect.top;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get event either from event param or from window.event. \r\n     * This is for older browsers support.\r\n     * @private\r\n     */\r\n    _getEvent(event)\r\n    {\r\n        return event || window.event;\r\n    }\r\n}\r\n\r\n\r\n// export main object\r\nmodule.exports = new Input();", "/**\r\n * Just an alias to main manager so we can require() this folder as a package.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\input\\index.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\n module.exports = require('./input');", "/**\r\n * Implement binary data asset type.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\assets\\binary_asset.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst Asset = require(\"./asset\");\r\n\r\n\r\n/**\r\n * A loadable binary data asset.\r\n * This asset type loads array of bytes from a remote file.\r\n */\r\nclass BinaryAsset extends Asset\r\n{\r\n    /** @inheritdoc */\r\n    constructor(url)\r\n    {\r\n        super(url);\r\n        this._data = null;\r\n    }\r\n\r\n    /**\r\n     * Load the binary data from the asset URL.\r\n     * @returns {Promise} Promise to resolve when fully loaded.\r\n     */\r\n    load()\r\n    {\r\n        return new Promise((resolve, reject) => {\r\n\r\n            var request = new XMLHttpRequest();\r\n            request.open('GET', this.url, true);\r\n            request.responseType = 'arraybuffer';     \r\n\r\n            // on load, validate audio content\r\n            request.onload = () => \r\n            {\r\n                if (request.readyState == 4) {\r\n                    if (request.response) {\r\n                        this._data = new Uint8Array(request.response);\r\n                        this._notifyReady();\r\n                        resolve();\r\n                    }\r\n                    else {\r\n                        reject(request.statusText);\r\n                    }\r\n                }\r\n            }\r\n\r\n            // on load error, reject\r\n            request.onerror = (e) => {\r\n                reject(e);\r\n            }\r\n\r\n            // initiate request\r\n            request.send();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Create the binary data asset from array or Uint8Array.\r\n     * @param {Array<Number>|Uint8Array} source Data to create asset from.\r\n     * @returns {Promise} Promise to resolve when asset is ready.\r\n     */\r\n    create(source)\r\n    {\r\n        return new Promise((resolve, reject) => {\r\n            if (source instanceof Array) { source = new Uint8Array(source); }\r\n            if (!(source instanceof Uint8Array)) { return reject(\"Binary asset source must be of type 'Uint8Array'!\"); }\r\n            this._data = source;\r\n            this._notifyReady();\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    /** @inheritdoc */\r\n    get valid()\r\n    {\r\n        return Boolean(this._data);\r\n    }\r\n\r\n    /** @inheritdoc */\r\n    destroy()\r\n    {\r\n        this._data = null;\r\n    }\r\n\r\n    /**\r\n     * Get binary data.\r\n     * @returns {Uint8Array} Data as bytes array.\r\n     */\r\n    get data()\r\n    {\r\n        return this._data;\r\n    }\r\n\r\n    /**\r\n     * Convert and return data as string.\r\n     * @returns {String} Data converted to string.\r\n     */\r\n    string()\r\n    {\r\n        return (new TextDecoder()).decode(this._data);\r\n    }\r\n}\r\n\r\n\r\n// export the asset type.\r\nmodule.exports = BinaryAsset;", "/**\r\n * Implement the assets manager.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\assets\\assets.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst SoundAsset = require('../assets/sound_asset.js');\r\nconst IManager = require('../manager.js');\r\nconst BinaryAsset = require('./binary_asset.js');\r\nconst JsonAsset = require('./json_asset.js');\r\nconst TextureAsset = require('./texture_asset.js');\r\nconst FontTextureAsset = require('./font_texture_asset');\r\nconst MsdfFontTextureAsset = require('./msdf_font_texture_asset.js');\r\nconst Asset = require('./asset.js');\r\nconst _logger = require('../logger.js').getLogger('assets');\r\n\r\n\r\n/**\r\n * Assets manager class.\r\n * Used to create, load and cache game assets, which includes textures, audio files, JSON objects, etc.\r\n * As a rule of thumb, all methods to load or create assets are async and return a promise.\r\n * \r\n * To access the Assets manager you use `Shaku.assets`. \r\n */\r\nclass Assets extends IManager\r\n{\r\n    /**\r\n     * Create the manager.\r\n     */\r\n    constructor()\r\n    {\r\n        super();\r\n        this._loaded = null;\r\n        this._waitingAssets = new Set();\r\n\t\tthis._failedAssets = new Set();\r\n        this._successfulLoadedAssetsCount = 0;\r\n\r\n        /**\r\n         * Optional URL root to prepend to all loaded assets URLs.\r\n         * For example, if all your assets are under '/static/assets/', you can set this url as root and omit it when loading assets later.\r\n         */\r\n        this.root = '';\r\n\r\n        /**\r\n         * Optional suffix to add to all loaded assets URLs.\r\n         * You can use this for anti-cache mechanism if you want to reload all assets. For example, you can set this value to \"'?dt=' + Date.now()\".\r\n         */\r\n        this.suffix = '';\r\n    }\r\n\r\n    /**\r\n     * Wrap a URL with 'root' and 'suffix'.\r\n     * @param {String} url Url to wrap.\r\n     * @returns {String} Wrapped URL.\r\n     */\r\n    _wrapUrl(url)\r\n    {\r\n        if (!url) { return url; }\r\n        return this.root + url + this.suffix;\r\n    }\r\n\r\n    /**\r\n     * Get list of assets waiting to be loaded.\r\n     * This list will be reset if you call clearCache().\r\n     * @returns {Array<string>} URLs of assets waiting to be loaded.\r\n     */\r\n    get pendingAssets()\r\n    {\r\n        return Array.from(this._waitingAssets);\r\n    }\r\n\t\r\n    /**\r\n     * Get list of assets that failed to load.\r\n     * This list will be reset if you call clearCache().\r\n     * @returns {Array<string>} URLs of assets that had error loading.\r\n     */\t\r\n\tget failedAssets()\r\n\t{\r\n\t\treturn Array.from(this._failedAssets);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Return a promise that will be resolved only when all pending assets are loaded.\r\n\t * If an asset fails, will reject.\r\n     * @example\r\n     * await Shaku.assets.waitForAll();\r\n     * console.log(\"All assets are loaded!\");\r\n     * @returns {Promise} Promise to resolve when all assets are loaded, or reject if there are failed assets.\r\n\t */\r\n\twaitForAll()\r\n\t{\r\n\t\treturn new Promise((resolve, reject) => {\r\n            \r\n            _logger.debug(\"Waiting for all assets..\");\r\n\r\n            // check if all assets are loaded or if there are errors\r\n\t\t\tlet checkAssets = () => {\r\n\r\n                // got errors?\r\n                if (this._failedAssets.size !== 0) {\r\n                    _logger.warn(\"Done waiting for assets: had errors.\");\r\n                    return reject(this.failedAssets);\r\n                }\r\n\r\n                // all done?\r\n\t\t\t\tif (this._waitingAssets.size === 0) {\r\n                    _logger.debug(\"Done waiting for assets: everything loaded successfully.\");\r\n\t\t\t\t\treturn resolve();\r\n\t\t\t\t}\r\n\r\n                // try again in 1 ms\r\n\t\t\t\tsetTimeout(checkAssets, 1);\r\n\t\t\t};\r\n\r\n\t\t\tcheckAssets();\r\n\t\t});\r\n\t}\r\n\r\n    /** \r\n     * @inheritdoc\r\n     * @private\r\n     */\r\n    setup()\r\n    {        \r\n        return new Promise((resolve, reject) => {\r\n            _logger.info(\"Setup assets manager..\");\r\n            this._loaded = {};\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    /** \r\n     * @inheritdoc\r\n     * @private\r\n     */\r\n    startFrame()\r\n    {\r\n    }\r\n\r\n    /** \r\n     * @inheritdoc\r\n     * @private\r\n     */\r\n    endFrame()\r\n    {\r\n    }\r\n\r\n    /**\r\n     * Get already-loaded asset from cache.\r\n     * @private\r\n     * @param {String} url Asset URL.\r\n     * @param {type} type If provided will make sure asset is of this type. If asset found but have wrong type, will throw exception.\r\n     * @returns Loaded asset or null if not found.\r\n     */\r\n    _getFromCache(url, type)\r\n    {\r\n        let cached = this._loaded[url] || null;\r\n        if (cached && type) {\r\n            if (!(cached instanceof type)) { \r\n                throw new Error(`Asset with URL '${url}' is already loaded, but has unexpected type (expecting ${type})!`); \r\n            }\r\n        }\r\n        return cached;\r\n    }\r\n\r\n    /**\r\n     * Load an asset of a given type and add to cache when done.\r\n     * @private\r\n     * @param {Asset} newAsset Asset instance to load.\r\n     * @param {*} params Optional loading params.\r\n     */\r\n    async _loadAndCacheAsset(newAsset, params)\r\n    {\r\n        // extract url and typename, and add to cache\r\n        let url = newAsset.url;\r\n        let typeName = newAsset.constructor.name;\r\n        this._loaded[url] = newAsset;\r\n        this._waitingAssets.add(url);\r\n\r\n        // initiate loading\r\n        return new Promise(async (resolve, reject) => {\r\n\r\n            // load asset\r\n            _logger.debug(`Load asset [${typeName}] from URL '${url}'.`);\r\n            try {\r\n                await newAsset.load(params);\r\n            }\r\n            catch (e) {\r\n                _logger.warn(`Failed to load asset [${typeName}] from URL '${url}'.`);\r\n                this._failedAssets.add(url);\r\n                return reject(e);\r\n            }\r\n\r\n            // update waiting assets count\r\n            this._waitingAssets.delete(url);\r\n\r\n            // make sure valid\r\n            if (!newAsset.valid) {\r\n                _logger.warn(`Failed to load asset [${typeName}] from URL '${url}'.`);\r\n                this._failedAssets.add(url);\r\n                return reject(\"Loaded asset is not valid!\");\r\n            }\r\n\r\n            _logger.debug(`Successfully loaded asset [${typeName}] from URL '${url}'.`);\r\n\r\n            // resolve\r\n            this._successfulLoadedAssetsCount++;\r\n            resolve(newAsset);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Get asset directly from cache, synchronous and without a Promise.\r\n     * @param {String} url Asset URL or name. \r\n     * @returns {Asset} Asset or null if not loaded.\r\n     */\r\n    getCached(url)\r\n    {\r\n        url = this._wrapUrl(url);\r\n        return this._loaded[url] || null;\r\n    }\r\n\r\n    /**\r\n     * Get / load asset of given type, and return a promise to be resolved when ready.\r\n     * @private\r\n     */\r\n    _loadAssetType(url, typeClass, params)\r\n    {\r\n        // normalize URL\r\n        url = this._wrapUrl(url);\r\n\r\n        // try to get from cache\r\n        let _asset = this._getFromCache(url, typeClass);\r\n        \r\n        // check if need to create new and load\r\n        var needLoad = false;\r\n        if (!_asset) {\r\n            _asset = new typeClass(url);\r\n            needLoad = true;\r\n        }\r\n        \r\n        // create promise to load asset\r\n        let promise = new Promise(async (resolve, reject) => {\r\n            if (needLoad) {\r\n                await this._loadAndCacheAsset(_asset, params);\r\n            }\r\n            _asset.onReady(() => {\r\n                resolve(_asset);\r\n            });\r\n        });\r\n\r\n        // return promise with asset attached to it\r\n        promise.asset = _asset;\r\n        return promise;\r\n    }\r\n\r\n    /**\r\n     * Create and init asset of given class type.\r\n     * @private\r\n     */\r\n    _createAsset(name, classType, initMethod)\r\n    {\r\n        // create asset\r\n        name = this._wrapUrl(name);\r\n        var _asset = new classType(name || generateRandomAssetName());\r\n\r\n        // generate render target in async\r\n        let promise = new Promise(async (resolve, reject) => {\r\n\r\n            // make sure not in cache\r\n            if (name && this._loaded[name]) { return reject(`Asset of type '${classType.name}' to create with URL '${name}' already exist in cache!`); }\r\n\r\n            // create and return\r\n            initMethod(_asset);\r\n            if (name) { this._loaded[name] = _asset; }\r\n            resolve(_asset);\r\n        });\r\n\r\n        // attach asset to promise\r\n        promise.asset = _asset;\r\n        return promise;\r\n    }\r\n\r\n    /**\r\n     * Load a sound asset. If already loaded, will use cache.\r\n     * @example\r\n     * let sound = await Shaku.assets.loadSound(\"assets/my_sound.ogg\");\r\n     * @param {String} url Asset URL.\r\n     * @returns {Promise<SoundAsset>} promise to resolve with asset instance, when loaded. You can access the loading asset with `.asset` on the promise.\r\n     */\r\n    loadSound(url)\r\n    {\r\n        return this._loadAssetType(url, SoundAsset, undefined);\r\n    }\r\n\r\n    /**\r\n     * Load a texture asset. If already loaded, will use cache.\r\n     * @example\r\n     * let texture = await Shaku.assets.loadTexture(\"assets/my_texture.png\", {generateMipMaps: false});\r\n     * @param {String} url Asset URL.\r\n     * @param {*=} params Optional params dictionary. See TextureAsset.load() for more details.\r\n     * @returns {Promise<TextureAsset>} promise to resolve with asset instance, when loaded. You can access the loading asset with `.asset` on the promise.\r\n     */\r\n    loadTexture(url, params)\r\n    {\r\n        return this._loadAssetType(url, TextureAsset, params);\r\n    }\r\n\r\n    /**\r\n     * Create a render target texture asset. If already loaded, will use cache.\r\n     * @example\r\n     * let width = 512;\r\n     * let height = 512;\r\n     * let renderTarget = await Shaku.assets.createRenderTarget(\"optional_render_target_asset_id\", width, height);\r\n     * @param {String | null} name Asset name (matched to URLs when using cache). If null, will not add to cache.\r\n     * @param {Number} width Texture width.\r\n     * @param {Number} height Texture height.\r\n     * @param {Number=} channels Texture channels count. Defaults to 4 (RGBA).\r\n     * @returns {Promise<TextureAsset>} promise to resolve with asset instance, when loaded. You can access the loading asset with `.asset` on the promise.\r\n     */\r\n    createRenderTarget(name, width, height, channels)\r\n    {\r\n        // make sure we have valid size\r\n        if (!width || !height) {\r\n            throw new Error(\"Missing or invalid size!\");\r\n        }\r\n\r\n        // create asset and return promise\r\n        return this._createAsset(name, TextureAsset, (asset) => {\r\n            asset.createRenderTarget(width, height, channels);\r\n        });\r\n    }\r\n    \r\n    /**\r\n     * Load a font texture asset. If already loaded, will use cache.\r\n     * @example\r\n     * let fontTexture = await Shaku.assets.loadFontTexture('assets/DejaVuSansMono.ttf', {fontName: 'DejaVuSansMono'});\r\n     * @param {String} url Asset URL.\r\n     * @param {*} params Optional params dictionary. See FontTextureAsset.load() for more details.\r\n     * @returns {Promise<FontTextureAsset>} promise to resolve with asset instance, when loaded. You can access the loading asset with `.asset` on the promise.\r\n     */\r\n    loadFontTexture(url, params)\r\n    {\r\n        return this._loadAssetType(url, FontTextureAsset, params);\r\n    }\r\n    \r\n    /**\r\n     * Load a MSDF font texture asset. If already loaded, will use cache.\r\n     * @example\r\n     * let fontTexture = await Shaku.assets.loadMsdfFontTexture('DejaVuSansMono.font', {jsonUrl: 'assets/DejaVuSansMono.json', textureUrl: 'assets/DejaVuSansMono.png'});\r\n     * @param {String} url Asset URL.\r\n     * @param {*=} params Optional params dictionary. See MsdfFontTextureAsset.load() for more details.\r\n     * @returns {Promise<MsdfFontTextureAsset>} promise to resolve with asset instance, when loaded. You can access the loading asset with `.asset` on the promise.\r\n     */\r\n    loadMsdfFontTexture(url, params)\r\n    {\r\n        return this._loadAssetType(url, MsdfFontTextureAsset, params);\r\n    }\r\n    \r\n    /**\r\n     * Load a json asset. If already loaded, will use cache.\r\n     * @example\r\n     * let jsonData = await Shaku.assets.loadJson('assets/my_json_data.json');\r\n     * console.log(jsonData.data);\r\n     * @param {String} url Asset URL.\r\n     * @returns {Promise<JsonAsset>} promise to resolve with asset instance, when loaded. You can access the loading asset with `.asset` on the promise.\r\n     */\r\n    loadJson(url)\r\n    {\r\n        return this._loadAssetType(url, JsonAsset);\r\n    }\r\n \r\n    /**\r\n     * Create a new json asset. If already exist, will reject promise.\r\n     * @example\r\n     * let jsonData = await Shaku.assets.createJson('optional_json_data_id', {\"foo\": \"bar\"});\r\n     * // you can now load this asset from anywhere in your code using 'optional_json_data_id' as url\r\n     * @param {String} name Asset name (matched to URLs when using cache). If null, will not add to cache.\r\n     * @param {Object|String} data Optional starting data.\r\n     * @returns {Promise<JsonAsset>} promise to resolve with asset instance, when ready. You can access the loading asset with `.asset` on the promise.\r\n     */\r\n    createJson(name, data)\r\n    {\r\n        // make sure we have valid data\r\n        if (!data) {\r\n            return reject(\"Missing or invalid data!\");\r\n        }\r\n\r\n        // create asset and return promise\r\n        return this._createAsset(name, JsonAsset, (asset) => {\r\n            asset.create(data);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Load a binary data asset. If already loaded, will use cache.\r\n     * @example\r\n     * let binData = await Shaku.assets.loadBinary('assets/my_bin_data.dat');\r\n     * console.log(binData.data);\r\n     * @param {String} url Asset URL.\r\n     * @returns {Promise<BinaryAsset>} promise to resolve with asset instance, when loaded. You can access the loading asset with `.asset` on the promise.\r\n     */\r\n    loadBinary(url)\r\n    {\r\n        return this._loadAssetType(url, BinaryAsset);\r\n    }\r\n\r\n    /**\r\n     * Create a new binary asset. If already exist, will reject promise.\r\n     * @example\r\n     * let binData = await Shaku.assets.createBinary('optional_bin_data_id', [1,2,3,4]);\r\n     * // you can now load this asset from anywhere in your code using 'optional_bin_data_id' as url\r\n     * @param {String} name Asset name (matched to URLs when using cache). If null, will not add to cache.\r\n     * @param {Array<Number>|Uint8Array} data Binary data to set.\r\n     * @returns {Promise<BinaryAsset>} promise to resolve with asset instance, when ready. You can access the loading asset with `.asset` on the promise.\r\n     */\r\n    createBinary(name, data)\r\n    {\r\n        // make sure we have valid data\r\n        if (!data) {\r\n            return reject(\"Missing or invalid data!\");\r\n        }\r\n\r\n        // create asset and return promise\r\n        return this._createAsset(name, BinaryAsset, (asset) => {\r\n            asset.create(data);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Destroy and free asset from cache.\r\n     * @example\r\n     * Shaku.assets.free(\"my_asset_url\");\r\n     * @param {String} url Asset URL to free.\r\n     */\r\n    free(url)\r\n    {\r\n        url = this._wrapUrl(url);\r\n        let asset = this._loaded[url];\r\n        if (asset) {\r\n            asset.destroy();\r\n            delete this._loaded[url];\r\n        }\r\n    }\r\n\t\r\n\t/**\r\n\t * Free all loaded assets from cache.\r\n     * @example\r\n     * Shaku.assets.clearCache();\r\n\t */\r\n\tclearCache()\r\n\t{\r\n\t\tfor (let key in this._loaded) {\r\n            this._loaded[key].destroy();\r\n        }\r\n        this._loaded = {};\r\n        this._waitingAssets = new Set();\r\n\t\tthis._failedAssets = new Set();\r\n\t}\r\n\r\n    /** \r\n     * @inheritdoc\r\n     * @private\r\n     */\r\n    destroy()\r\n    {\r\n\t\tthis.clearCache();\r\n    }\r\n}\r\n\r\n// generate a random asset URL, for when creating assets that are outside of cache.\r\nvar _nextRandomAssetId = 0;\r\nfunction generateRandomAssetName()\r\n{\r\n    return \"_runtime_asset_\" + (_nextRandomAssetId++) + \"_\";\r\n}\r\n \r\n// export assets manager\r\nmodule.exports = new Assets();", "/**\r\n * Just an alias to main manager so we can require() this folder as a package.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\assets\\index.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\n module.exports = require('./assets');", "/**\r\n * Implement collision shape base class.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\collision\\shapes\\shape.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst Color = require(\"../../utils/color\");\r\nconst Rectangle = require(\"../../utils/rectangle\");\r\nconst Vector2 = require(\"../../utils/vector2\");\r\nconst CollisionWorld = require(\"../collision_world\");\r\n\r\n \r\n/**\r\n * Collision shape base class.\r\n */\r\nclass CollisionShape\r\n{\r\n    /**\r\n     * Create the collision shape.\r\n     */\r\n    constructor()\r\n    {\r\n        this._world = null;\r\n        this._worldRange = null;\r\n        this._debugColor = null;\r\n        this._forceDebugColor = null;\r\n        this._collisionFlags = Number.MAX_SAFE_INTEGER;\r\n    }\r\n\r\n    /**\r\n     * Get the collision shape's unique identifier.\r\n     * @returns {String} Shape's unique identifier\r\n     */\r\n    get shapeId()\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n\r\n    /**\r\n     * Get collision flags (matched against collision mask when checking collision).\r\n     */\r\n    get collisionFlags()\r\n    {\r\n        return this._collisionFlags;\r\n    }\r\n\r\n    /**\r\n     * Set collision flags (matched against collision mask when checking collision).\r\n     */\r\n    set collisionFlags(value)\r\n    {\r\n        this._debugColor = null;\r\n        this._collisionFlags = value;\r\n        return this._collisionFlags;\r\n    }\r\n\r\n    /**\r\n     * Set the debug color to use to draw this shape.\r\n     * @param {Color} color Color to set or null to use default.\r\n     */\r\n    setDebugColor(color)\r\n    {\r\n        this._forceDebugColor = color;\r\n    }\r\n\r\n    /**\r\n     * Debug draw this shape.\r\n     * @param {Number} opacity Shape opacity factor.\r\n     */\r\n    debugDraw(opacity)\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n    \r\n    /**\r\n     * Get shape center position.\r\n     * @returns {Vector2} Center position.\r\n     */\r\n    getCenter()\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n\r\n    /**\r\n     * Remove self from parent world object.\r\n     */\r\n    remove()\r\n    {\r\n        if (this._world) {\r\n            this._world.removeShape(this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get debug drawing color.\r\n     * @private\r\n     */\r\n    _getDebugColor()\r\n    {\r\n        // use forced debug color\r\n        if (this._forceDebugColor) {\r\n            return this._forceDebugColor.clone();\r\n        }\r\n\r\n        // calculate debug color\r\n        if (!this._debugColor) {\r\n            this._debugColor = this._getDefaultDebugColorFor(this.collisionFlags);\r\n        }\r\n\r\n        // return color\r\n        return this._debugColor.clone();\r\n    }\r\n\r\n    /**\r\n     * Get default debug colors for given collision flags.\r\n     * @private\r\n     */\r\n    _getDefaultDebugColorFor(flags)\r\n    {\r\n        return defaultDebugColors[flags % defaultDebugColors.length];\r\n    }\r\n\r\n    /**\r\n     * Get collision shape's estimated radius box.\r\n     * @private\r\n     * @returns {Number} Shape's radius\r\n     */\r\n    _getRadius()\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n\r\n    /**\r\n     * Get collision shape's bounding box.\r\n     * @private\r\n     * @returns {Rectangle} Shape's bounding box.\r\n     */\r\n    _getBoundingBox()\r\n    {\r\n        throw new Error(\"Not Implemented!\");\r\n    }\r\n    \r\n    /**\r\n     * Set the parent collision world this shape is currently in.\r\n     * @private\r\n     * @param {CollisionWorld} world New parent collision world or null to remove.\r\n     */\r\n    _setParent(world)\r\n    {\r\n        // same world? skip\r\n        if (world === this._world) {\r\n            return;\r\n        }\r\n\r\n        // we already have a world but try to set a new one? error\r\n        if (this._world && world) {\r\n            throw new Error(\"Cannot add collision shape to world while its already in another world!\");\r\n        }\r\n\r\n        // set new world\r\n        this._world = world;\r\n        this._worldRange = null;\r\n    }\r\n\r\n    /**\r\n     * Called when the collision shape changes and we need to update the parent world.\r\n     * @private\r\n     */\r\n    _shapeChanged()\r\n    {\r\n        if (this._world) {\r\n            this._world._queueUpdate(this);\r\n        }\r\n    }\r\n}\r\n\r\n// default debug colors to use\r\nconst defaultDebugColors = [Color.red, Color.blue, Color.green, Color.yellow, Color.purple, Color.teal, Color.brown, Color.orange, Color.khaki, Color.darkcyan, Color.cornflowerblue, Color.darkgray, Color.chocolate, Color.aquamarine, Color.cadetblue, Color.magenta, Color.seagreen, Color.pink, Color.olive, Color.violet];\r\n\r\n// export collision shape class\r\nmodule.exports = CollisionShape;", "/**\r\n * An object to store collision detection result.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\collision\\result.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst Vector2 = require(\"../utils/vector2\");\r\nconst CollisionShape = require(\"./shapes/shape\");\r\n\r\n \r\n/**\r\n * Collision detection result.\r\n */\r\nclass CollisionTestResult\r\n{\r\n    /**\r\n     * Create the collision result.\r\n     * @param {Vector2} position Optional collision position.\r\n     * @param {CollisionShape} first First shape in the collision check.\r\n     * @param {CollisionShape} second Second shape in the collision check.\r\n     */\r\n    constructor(position, first, second)\r\n    {\r\n        /**\r\n         * Collision position, only relevant when there's a single touching point.\r\n         * For shapes with multiple touching points, this will be null.\r\n         */\r\n        this.position = position;\r\n\r\n        /**\r\n         * First collided shape.\r\n         */\r\n        this.first = first;\r\n\r\n        /**\r\n         * Second collided shape.\r\n         */\r\n        this.second = second;\r\n    }\r\n}\r\n\r\n// export collision shape class\r\nmodule.exports = CollisionTestResult;", "/**\r\n * Implement the collision resolver class.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\collision\\resolver.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst Vector2 = require('../utils/vector2.js');\r\nconst CollisionTestResult = require('./result.js');\r\nconst CollisionShape = require('./shapes/shape.js');\r\nconst _logger = require('../logger.js').getLogger('collision');\r\n\r\n \r\n/**\r\n * The collision resolver is responsible to implement collision detection between pair of shapes of same or different types.\r\n */\r\nclass CollisionResolver\r\n{\r\n    /**\r\n     * Create the resolver.\r\n     */\r\n    constructor()\r\n    {\r\n        this._handlers = {};\r\n    }\r\n\r\n    /**\r\n     * Initialize the resolver.\r\n     * @private\r\n     */\r\n    _init()\r\n    {\r\n\r\n    }\r\n\r\n    /**\r\n     * Set the method used to test collision between two shapes.\r\n     * Note: you don't need to register the same handler twice for reverse order, its done automatically inside.\r\n     * @param {String} firstShapeId The shape identifier the handler recieves as first argument.\r\n     * @param {String} secondShapeId The shape identifier the handler recieves as second argument.\r\n     * @param {Function} handler Method to test collision between the shapes. Return false if don't collide, return either Vector2 with collision position or 'true' for collision.\r\n     */\r\n    setHandler(firstShapeId, secondShapeId, handler)\r\n    {\r\n        _logger.debug(`Register handler for shapes '${firstShapeId}' and '${secondShapeId}'.`);\r\n\r\n        // register handler\r\n        if (!this._handlers[firstShapeId]) { this._handlers[firstShapeId] = {}; }\r\n        this._handlers[firstShapeId][secondShapeId] = handler;\r\n\r\n        // register reverse order handler\r\n        if (firstShapeId !== secondShapeId) {\r\n            if (!this._handlers[secondShapeId]) { this._handlers[secondShapeId] = {}; }\r\n            this._handlers[secondShapeId][firstShapeId] = (f, s) => { return handler(s, f); };\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Check a collision between two shapes.\r\n     * @param {CollisionShape} first First collision shape to test.\r\n     * @param {CollisionShape} second Second collision shape to test.\r\n     * @returns {CollisionTestResult} collision detection result or null if they don't collide.\r\n     */\r\n    test(first, second)\r\n    {\r\n        let handler = this._getCollisionMethod(first, second);\r\n        return this.testWithHandler(first, second, handler);\r\n    }\r\n\r\n    /**\r\n     * Check a collision between two shapes.\r\n     * @param {CollisionShape} first First collision shape to test.\r\n     * @param {CollisionShape} second Second collision shape to test.\r\n     * @param {Function} handler Method to test collision between the shapes.\r\n     * @returns {CollisionTestResult} collision detection result or null if they don't collide.\r\n     */\r\n    testWithHandler(first, second, handler)\r\n    {\r\n        // missing handler?\r\n        if (!handler) {\r\n            _logger.warn(`Missing collision handler for shapes '${first.shapeId}' and '${second.shapeId}'.`);\r\n            return null;\r\n        }\r\n\r\n        // test collision\r\n        let result = handler(first, second);\r\n\r\n        // collision\r\n        if (result) {\r\n            let position = (result instanceof Vector2) ? result : null;\r\n            return new CollisionTestResult(position, first, second);\r\n        }\r\n\r\n        // no collision\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Get handlers dictionary for a given shape.\r\n     */\r\n    getHandlers(shape)\r\n    {\r\n        return this._handlers[shape.shapeId];\r\n    }\r\n    \r\n    /**\r\n     * Get the collision detection method for two given shapes.\r\n     * @private\r\n     * @param {CollisionShape} first First collision shape to test.\r\n     * @param {CollisionShape} second Second collision shape to test.\r\n     * @returns {Function} collision detection method or null if not found.\r\n     */\r\n    _getCollisionMethod(first, second)\r\n    {\r\n        let handlersFrom = this._handlers[first.shapeId];\r\n        if (handlersFrom) {\r\n            return handlersFrom[second.shapeId] || null;\r\n        }\r\n        return null;\r\n    }\r\n}\r\n\r\n// export the collision resolver\r\nmodule.exports = CollisionResolver;", "/**\r\n * Implement collision point.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\collision\\shapes\\point.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\nconst CollisionShape = require(\"./shape\");\r\nconst gfx = require('./../../gfx');\r\nconst Vector2 = require(\"../../utils/vector2\");\r\nconst Rectangle = require(\"../../utils/rectangle\");\r\nconst Circle = require(\"../../utils/circle\");\r\n\r\n\r\n/**\r\n * Collision point class.\r\n */\r\nclass PointShape extends CollisionShape\r\n{\r\n    /**\r\n     * Create the collision shape.\r\n     * @param {Vector2} position Point position.\r\n     */\r\n    constructor(position)\r\n    {\r\n        super();\r\n        this.setPosition(position);\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    get shapeId()\r\n    {\r\n        return \"point\";\r\n    }\r\n    \r\n    /**\r\n     * Set this collision shape from vector2.\r\n     * @param {Vector2} position Point position.\r\n     */\r\n    setPosition(position)\r\n    {\r\n        this._position = position.clone();\r\n        this._boundingBox = new Rectangle(position.x, position.y, 1, 1);\r\n        this._shapeChanged();\r\n    }\r\n\r\n    /**\r\n     * Get point position.\r\n     * @returns {Vector2} Point position.\r\n     */\r\n    getPosition()\r\n    {\r\n        return this._position.clone();\r\n    }\r\n    \r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    getCenter()\r\n    {\r\n        return this._position.clone();\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    _getRadius()\r\n    {\r\n        return 1;\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    _getBoundingBox()\r\n    {\r\n        return this._boundingBox;\r\n    }\r\n\r\n    /**\r\n     * Debug draw this shape.\r\n     * @param {Number} opacity Shape opacity factor.\r\n     */\r\n    debugDraw(opacity)\r\n    {\r\n        if (opacity === undefined) opacity = 1;\r\n        let color = this._getDebugColor();\r\n        color.a *= opacity;\r\n        gfx.outlineCircle(new Circle(this.getPosition(), 3), color, gfx.BlendModes.AlphaBlend, 4);\r\n    }\r\n}\r\n\r\n// export collision shape class\r\nmodule.exports = PointShape;", "/**\r\n * Implement collision circle.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\collision\\shapes\\circle.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\nconst CollisionShape = require(\"./shape\");\r\nconst gfx = require('./../../gfx');\r\nconst Circle = require(\"../../utils/circle\");\r\nconst Rectangle = require(\"../../utils/rectangle\");\r\n\r\n\r\n/**\r\n * Collision circle class.\r\n */\r\nclass CircleShape extends CollisionShape\r\n{\r\n    /**\r\n     * Create the collision shape.\r\n     * @param {Circle} circle the circle shape.\r\n     */\r\n    constructor(circle)\r\n    {\r\n        super();\r\n        this.setShape(circle);\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    get shapeId()\r\n    {\r\n        return \"circle\";\r\n    }\r\n\r\n    /**\r\n     * Set this collision shape from circle.\r\n     * @param {Circle} circle Circle shape.\r\n     */\r\n    setShape(circle)\r\n    {\r\n        this._circle = circle;\r\n        this._position = circle.center;\r\n        this._boundingBox = new Rectangle(circle.center.x - circle.radius, circle.center.y - circle.radius, circle.radius * 2, circle.radius * 2);\r\n        this._shapeChanged();\r\n    }\r\n \r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    _getRadius()\r\n    {\r\n        return this._circle.radius;\r\n    }\r\n    \r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    getCenter()\r\n    {\r\n        return this._position.clone();\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    _getBoundingBox()\r\n    {\r\n        return this._boundingBox;\r\n    }\r\n\r\n    /**\r\n     * Debug draw this shape.\r\n     * @param {Number} opacity Shape opacity factor.\r\n     */\r\n    debugDraw(opacity)\r\n    {\r\n        if (opacity === undefined) opacity = 1;\r\n        let color = this._getDebugColor();\r\n\r\n        color.a *= opacity;\r\n        gfx.outlineCircle(this._circle, color, gfx.BlendModes.AlphaBlend, 14);\r\n\r\n        color.a *= 0.25;\r\n        gfx.fillCircle(this._circle, color, gfx.BlendModes.AlphaBlend, 14);\r\n    }\r\n}\r\n\r\n// export collision shape class\r\nmodule.exports = CircleShape;", "/**\r\n * Implement the collision manager.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\collision\\collision_world.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst Color = require(\"../utils/color\");\r\nconst Vector2 = require(\"../utils/vector2\");\r\nconst Circle = require(\"../utils/circle\");\r\nconst CollisionTestResult = require(\"./result\");\r\nconst CollisionShape = require(\"./shapes/shape\");\r\nconst gfx = require('./../gfx');\r\nconst Rectangle = require(\"../utils/rectangle\");\r\nconst CollisionResolver = require(\"./resolver\");\r\nconst PointShape = require(\"./shapes/point\");\r\nconst CircleShape = require(\"./shapes/circle\");\r\nconst _logger = require('../logger.js').getLogger('collision');\r\n\r\n\r\n/**\r\n * A collision world is a set of collision shapes that interact with each other.\r\n * You can use different collision worlds to represent different levels or different parts of your game world.\r\n */\r\nclass CollisionWorld\r\n{\r\n    /**\r\n     * Create the collision world.\r\n     * @param {CollisionResolver} resolver Collision resolver to use for this world.\r\n     * @param {Number|Vector2} gridCellSize For optimize collision testing, the collision world is divided into a collision grid. This param determine the grid cell size.\r\n     */\r\n    constructor(resolver, gridCellSize)\r\n    {\r\n        /**\r\n         * Collision resolver used in this collision world.\r\n         * By default, will inherit the collision manager default resolver.\r\n         */\r\n        this.resolver = resolver;\r\n\r\n        // set grid cell size\r\n        if (typeof gridCellSize === 'undefined') { gridCellSize = new Vector2(512, 512); }\r\n        else if (typeof gridCellSize === 'number') { gridCellSize = new Vector2(gridCellSize, gridCellSize); }\r\n        else { gridCellSize = gridCellSize.clone(); }\r\n        this._gridCellSize = gridCellSize;\r\n\r\n        // create collision grid\r\n        this._grid = {};\r\n\r\n        // shapes that need updates and grid chunks to delete\r\n        this._shapesToUpdate = new Set();\r\n        this._cellsToDelete = new Set();\r\n    }\r\n\r\n    /**\r\n     * Do collision world updates, if we have any.\r\n     * @private\r\n     */\r\n    _performUpdates()\r\n    {\r\n        // delete empty grid cells\r\n        if (this._cellsToDelete.size > 0) {\r\n            for (let key of this._cellsToDelete) {\r\n                if (this._grid[key] && this._grid[key].size === 0) { \r\n                    delete this._grid[key];\r\n                }\r\n            }\r\n            this._cellsToDelete.clear();\r\n        }\r\n\r\n        // update all shapes\r\n        if (this._shapesToUpdate.size > 0) {\r\n            for (let shape of this._shapesToUpdate) {\r\n                this._updateShape(shape);\r\n            }\r\n            this._shapesToUpdate.clear();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Update a shape in collision world after it moved or changed.\r\n     * @private\r\n     */\r\n    _updateShape(shape)\r\n    {\r\n        // sanity - if no longer in this collision world, skip\r\n        if (shape._world !== this) {\r\n            return;\r\n        }\r\n\r\n        // get new range\r\n        let bb = shape._getBoundingBox();\r\n        let minx = Math.floor(bb.left / this._gridCellSize.x);\r\n        let miny = Math.floor(bb.top / this._gridCellSize.y);\r\n        let maxx = Math.ceil(bb.right / this._gridCellSize.x);\r\n        let maxy = Math.ceil(bb.bottom / this._gridCellSize.y);\r\n\r\n        // change existing grid cells\r\n        if (shape._worldRange)\r\n        {\r\n            // range is the same? skip\r\n            if (shape._worldRange[0] === minx && \r\n                shape._worldRange[1] === miny &&\r\n                shape._worldRange[2] === maxx && \r\n                shape._worldRange[3] === maxy) {\r\n                return;\r\n            }\r\n\r\n            // get old range\r\n            let ominx = shape._worldRange[0];\r\n            let ominy = shape._worldRange[1];\r\n            let omaxx = shape._worldRange[2];\r\n            let omaxy = shape._worldRange[3];\r\n\r\n            // first remove from old chunks we don't need\r\n            for (let i = ominx; i < omaxx; ++i) {\r\n                for (let j = ominy; j < omaxy; ++j) {\r\n\r\n                    // if also in new range, don't remove\r\n                    if (i >= minx && i < maxx && j >= miny && j < maxy) {\r\n                        continue;\r\n                    }\r\n\r\n                    // remove from cell\r\n                    let key = i + ',' + j;\r\n                    let currSet = this._grid[key];\r\n                    if (currSet) {\r\n                        currSet.delete(shape);\r\n                        if (currSet.size === 0) {\r\n                            this._cellsToDelete.add(key);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            \r\n            // now add to new cells\r\n            for (let i = minx; i < maxx; ++i) {\r\n                for (let j = miny; j < maxy; ++j) {\r\n\r\n                    // if was in old range, don't add\r\n                    if (i >= ominx && i < omaxx && j >= ominy && j < omaxy) {\r\n                        continue;\r\n                    }\r\n\r\n                    // add to new cell\r\n                    let key = i + ',' + j;\r\n                    let currSet = this._grid[key];\r\n                    if (!currSet) { \r\n                        this._grid[key] = currSet = new Set(); \r\n                    }\r\n                    currSet.add(shape);\r\n                }\r\n            }\r\n        }\r\n        // first-time adding to grid\r\n        else {\r\n            for (let i = minx; i < maxx; ++i) {\r\n                for (let j = miny; j < maxy; ++j) {\r\n                    let key = i + ',' + j;\r\n                    let currSet = this._grid[key];\r\n                    if (!currSet) { \r\n                        this._grid[key] = currSet = new Set(); \r\n                    }\r\n                    currSet.add(shape);\r\n                }\r\n            }\r\n        }\r\n\r\n        // update new range\r\n        shape._worldRange = [minx, miny, maxx, maxy];\r\n    }\r\n\r\n    /**\r\n     * Request update for this shape on next updates call.\r\n     * @private\r\n     */\r\n    _queueUpdate(shape)\r\n    {\r\n        this._shapesToUpdate.add(shape);\r\n    }\r\n\r\n    /**\r\n     * Iterate all shapes in world.\r\n     * @param {Function} callback Callback to invoke on all shapes. Return false to break iteration.\r\n     */\r\n    iterateShapes(callback)\r\n    {\r\n        for (let key in this._grid) {\r\n            let cell = this._grid[key];\r\n            if (cell) {\r\n                for (let shape of cell)\r\n                {\r\n                    if (callback(shape) === false) {\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Add a collision shape to this world.\r\n     * @param {CollisionShape} shape Shape to add.\r\n     */\r\n    addShape(shape)\r\n    {\r\n        // add shape\r\n        shape._setParent(this);\r\n\r\n        // add shape to grid\r\n        this._updateShape(shape);\r\n\r\n        // do general updates\r\n        this._performUpdates();\r\n    }\r\n\r\n    /**\r\n     * Remove a collision shape from this world.\r\n     * @param {CollisionShape} shape Shape to remove.\r\n     */\r\n    removeShape(shape)\r\n    {\r\n        // sanity\r\n        if (shape._world !== this) {\r\n            _logger.warn(\"Shape to remove is not in this collision world!\");\r\n            return;\r\n        }\r\n\r\n        // remove from grid\r\n        if (shape._worldRange) {\r\n            let minx = shape._worldRange[0];\r\n            let miny = shape._worldRange[1];\r\n            let maxx = shape._worldRange[2];\r\n            let maxy = shape._worldRange[3];\r\n            for (let i = minx; i < maxx; ++i) {\r\n                for (let j = miny; j < maxy; ++j) {\r\n                    let key = i + ',' + j;\r\n                    let currSet = this._grid[key];\r\n                    if (currSet) {\r\n                        currSet.delete(shape);\r\n                        if (currSet.size === 0) {\r\n                            this._cellsToDelete.add(key);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // remove shape\r\n        this._shapesToUpdate.delete(shape);\r\n        shape._setParent(null);\r\n\r\n        // do general updates\r\n        this._performUpdates();\r\n    }\r\n\r\n    /**\r\n     * Iterate shapes that match broad phase test.\r\n     * @private\r\n     * @param {CollisionShape} shape Shape to test.\r\n     * @param {Function} handler Method to run on all shapes in phase. Return true to continue iteration, false to break.\r\n     * @param {Number} mask Optional mask of bits to match against shapes collisionFlags. Will only return shapes that have at least one common bit.\r\n     * @param {Function} predicate Optional filter to run on any shape we're about to test collision with.\r\n     */\r\n    _iterateBroadPhase(shape, handler, mask, predicate)\r\n    {\r\n        // get grid range\r\n        let bb = shape._getBoundingBox();\r\n        let minx = Math.floor(bb.left / this._gridCellSize.x);\r\n        let miny = Math.floor(bb.top / this._gridCellSize.y);\r\n        let maxx = Math.ceil(bb.right / this._gridCellSize.x);\r\n        let maxy = Math.ceil(bb.bottom / this._gridCellSize.y);\r\n\r\n        // shapes we checked\r\n        let checked = new Set();\r\n\r\n        // iterate options\r\n        for (let i = minx; i < maxx; ++i) {\r\n            for (let j = miny; j < maxy; ++j) {\r\n\r\n                // get current grid chunk\r\n                let key = i + ',' + j;\r\n                let currSet = this._grid[key];\r\n\r\n                // iterate shapes in grid chunk\r\n                if (currSet) { \r\n                    for (let other of currSet) {\r\n\r\n                        // check collision flags\r\n                        if (mask && ((other.collisionFlags & mask) === 0)) {\r\n                            continue;\r\n                        }\r\n\r\n                        // skip if checked\r\n                        if (checked.has(other)) {\r\n                            continue;\r\n                        }\r\n                        checked.add(other);\r\n\r\n                        // skip self\r\n                        if (other === shape) {\r\n                            continue;\r\n                        }\r\n\r\n                        // use predicate\r\n                        if (predicate && !predicate(other)) {\r\n                            continue;\r\n                        }\r\n\r\n                        // invoke handler on shape\r\n                        let proceedLoop = Boolean(handler(other));\r\n\r\n                        // break loop\r\n                        if (!proceedLoop) {\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Test collision with shapes in world, and return just the first result found.\r\n     * @param {CollisionShape} sourceShape Source shape to check collision for. If shape is in world, it will not collide with itself.\r\n     * @param {Boolean} sortByDistance If true will return the nearest collision found (based on center of shapes).\r\n     * @param {Number} mask Optional mask of bits to match against shapes collisionFlags. Will only return shapes that have at least one common bit.\r\n     * @param {Function} predicate Optional filter to run on any shape we're about to test collision with. If the predicate returns false, we will skip this shape.\r\n     * @returns {CollisionTestResult} A collision test result, or null if not found.\r\n     */\r\n    testCollision(sourceShape, sortByDistance, mask, predicate)\r\n    {\r\n        // do updates before check\r\n        this._performUpdates();\r\n\r\n        // result to return\r\n        var result = null;\r\n\r\n        // hard case - single result, sorted by distance\r\n        if (sortByDistance)\r\n        {\r\n            // build options array\r\n            var options = [];\r\n            this._iterateBroadPhase(sourceShape, (other) => {\r\n                options.push(other);\r\n                return true;\r\n            }, mask, predicate);\r\n\r\n            // sort options\r\n            sortByDistanceShapes(sourceShape, options);\r\n\r\n            // check collision sorted\r\n            var handlers = this.resolver.getHandlers(sourceShape);\r\n            for (let other of options) {\r\n                result = this.resolver.testWithHandler(sourceShape, other, handlers[other.shapeId]);\r\n                if (result) {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        // easy case - single result, not sorted\r\n        else\r\n        {\r\n            // iterate possible shapes and test collision\r\n            var handlers = this.resolver.getHandlers(sourceShape);\r\n            this._iterateBroadPhase(sourceShape, (other) => {\r\n\r\n                // test collision and continue iterating if we don't have a result\r\n                result = this.resolver.testWithHandler(sourceShape, other, handlers[other.shapeId]);\r\n                return !result;\r\n\r\n            }, mask, predicate);\r\n        }\r\n\r\n        // return result\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Test collision with shapes in world, and return all results found.\r\n     * @param {CollisionShape} sourceShape Source shape to check collision for. If shape is in world, it will not collide with itself.\r\n     * @param {Boolean} sortByDistance If true will sort results by distance.\r\n     * @param {Number} mask Optional mask of bits to match against shapes collisionFlags. Will only return shapes that have at least one common bit.\r\n     * @param {Function} predicate Optional filter to run on any shape we're about to test collision with. If the predicate returns false, we will skip this shape.\r\n     * @param {Function} intermediateProcessor Optional method to run after each positive result with the collision result as param. Return false to stop and return results.\r\n     * @returns {Array<CollisionTestResult>} An array of collision test results, or empty array if none found.\r\n     */\r\n    testCollisionMany(sourceShape, sortByDistance, mask, predicate, intermediateProcessor)\r\n    {\r\n        // do updates before check\r\n        this._performUpdates();\r\n\r\n        // get collisions\r\n        var ret = [];\r\n        var handlers = this.resolver.getHandlers(sourceShape);\r\n        this._iterateBroadPhase(sourceShape, (other) => {\r\n            let result = this.resolver.testWithHandler(sourceShape, other, handlers[other.shapeId]);\r\n            if (result) {\r\n                ret.push(result);\r\n                if (intermediateProcessor && intermediateProcessor(result) === false) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        }, mask, predicate);\r\n\r\n        // sort by distance\r\n        if (sortByDistance) {\r\n            sortByDistanceResults(sourceShape, ret);\r\n        }\r\n\r\n        // return results\r\n        return ret;\r\n    }\r\n\r\n    /**\r\n     * Return array of shapes that touch a given position, with optional radius.\r\n     * @example\r\n     * let shapes = world.pick(Shaku.input.mousePosition);\r\n     * @param {*} position Position to pick.\r\n     * @param {*} radius Optional picking radius to use a circle instead of a point.\r\n     * @param {*} sortByDistance If true, will sort results by distance from point.\r\n     * @param {*} mask Collision mask to filter by.\r\n     * @param {*} predicate Optional predicate method to filter by.\r\n     * @returns {Array<CollisionShape>} Array with collision shapes we picked.\r\n     */\r\n    pick(position, radius, sortByDistance, mask, predicate)\r\n    {\r\n        let shape = ((radius || 0) <= 1) ? new PointShape(position) : new CircleShape(new Circle(position, radius));\r\n        let ret = this.testCollisionMany(shape, sortByDistance, mask, predicate);\r\n        return ret.map(x => x.second);\r\n    }\r\n\r\n    /**\r\n     * Debug-draw the current collision world.\r\n     * @param {Color} gridColor Optional grid color (default to black).\r\n     * @param {Color} gridHighlitColor Optional grid color for cells with shapes in them (default to red).\r\n     * @param {Number} opacity Optional opacity factor (default to 0.5).\r\n     * @param {Camera} camera Optional camera for offset and viewport.\r\n     */\r\n    debugDraw(gridColor, gridHighlitColor, opacity, camera)\r\n    {\r\n        // do updates before check\r\n        this._performUpdates();\r\n        \r\n        // default grid colors\r\n        if (!gridColor) {\r\n            gridColor = Color.black;\r\n            gridColor.a *= 0.75;\r\n        }\r\n        if (!gridHighlitColor) {\r\n            gridHighlitColor = Color.red;\r\n            gridHighlitColor.a *= 0.75;\r\n        }\r\n\r\n        // default opacity\r\n        if (opacity === undefined) { \r\n            opacity = 0.5;\r\n        }\r\n\r\n        // set grid color opacity\r\n        gridColor.a *= opacity;\r\n        gridHighlitColor.a *= opacity;\r\n\r\n        // all shapes we rendered\r\n        let renderedShapes = new Set();\r\n\r\n        // get visible grid cells\r\n        let bb = camera ? camera.getRegion() : gfx.getRenderingRegion(false);\r\n        let minx = Math.floor(bb.left / this._gridCellSize.x);\r\n        let miny = Math.floor(bb.top / this._gridCellSize.y);\r\n        let maxx = minx + Math.ceil(bb.width / this._gridCellSize.x);\r\n        let maxy = miny + Math.ceil(bb.height / this._gridCellSize.y);\r\n        for (let i = minx; i <= maxx; ++i) {\r\n            for (let j = miny; j <= maxy; ++j) {\r\n\r\n                // get current cell\r\n                let cell = this._grid[i + ',' + j];\r\n\r\n                // draw grid cell\r\n                let color = (cell && cell.size) ? gridHighlitColor : gridColor;\r\n                let cellRect = new Rectangle(i * this._gridCellSize.x, j * this._gridCellSize.y, this._gridCellSize.x-1, this._gridCellSize.y-1);\r\n                gfx.outlineRect(cellRect, color, gfx.BlendModes.AlphaBlend, 0);\r\n\r\n                // draw shapes in grid\r\n                if (cell) {\r\n                    for (let shape of cell)\r\n                    {\r\n                        if (renderedShapes.has(shape)) {\r\n                            continue;\r\n                        }\r\n                        renderedShapes.add(shape);\r\n                        shape.debugDraw(opacity);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Sort array by distance from source shape.\r\n * @private\r\n */\r\nfunction sortByDistanceShapes(sourceShape, options)\r\n{\r\n    let sourceCenter = sourceShape.getCenter();\r\n    options.sort((a, b) => \r\n        (a.getCenter().distanceTo(sourceCenter) - a._getRadius()) - \r\n        (b.getCenter().distanceTo(sourceCenter) - b._getRadius()));\r\n}\r\n\r\n/**\r\n * Sort array by distance from source shape.\r\n * @private\r\n */\r\n function sortByDistanceResults(sourceShape, options)\r\n {\r\n     let sourceCenter = sourceShape.getCenter();\r\n     options.sort((a, b) => \r\n        (a.second.getCenter().distanceTo(sourceCenter) - a.second._getRadius()) - \r\n        (b.second.getCenter().distanceTo(sourceCenter) - b.second._getRadius()));\r\n }\r\n\r\n// export collision world\r\nmodule.exports = CollisionWorld;", "/**\r\n * Implement collision rectangle.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\collision\\shapes\\rectangle.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\nconst Rectangle = require(\"../../utils/rectangle\");\r\nconst CollisionShape = require(\"./shape\");\r\nconst gfx = require('./../../gfx');\r\n\r\n\r\n/**\r\n * Collision rectangle class.\r\n */\r\nclass RectangleShape extends CollisionShape\r\n{\r\n    /**\r\n     * Create the collision shape.\r\n     * @param {Rectangle} rectangle the rectangle shape.\r\n     */\r\n    constructor(rectangle)\r\n    {\r\n        super();\r\n        this.setShape(rectangle);\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    get shapeId()\r\n    {\r\n        return \"rect\";\r\n    }\r\n\r\n    /**\r\n     * Set this collision shape from rectangle.\r\n     * @param {Rectangle} rectangle Rectangle shape.\r\n     */\r\n    setShape(rectangle)\r\n    {\r\n        this._rect = rectangle;\r\n        this._center = rectangle.getCenter();\r\n        this._radius = this._rect.getBoundingCircle().radius;\r\n        this._shapeChanged();\r\n    }\r\n       \r\n    /**\r\n     * @inheritdoc\r\n     */ \r\n    _getRadius()\r\n    {\r\n        return this._radius;\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    _getBoundingBox()\r\n    {\r\n        return this._rect;\r\n    }\r\n    \r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    getCenter()\r\n    {\r\n        return this._center.clone();\r\n    }\r\n    \r\n    /**\r\n     * Debug draw this shape.\r\n     * @param {Number} opacity Shape opacity factor.\r\n     */\r\n    debugDraw(opacity)\r\n    {\r\n        if (opacity === undefined) opacity = 1;\r\n        let color = this._getDebugColor();\r\n\r\n        color.a *= opacity;\r\n        gfx.outlineRect(this._rect, color, gfx.BlendModes.AlphaBlend);\r\n                \r\n        color.a *= 0.25;\r\n        gfx.fillRect(this._rect, color, gfx.BlendModes.AlphaBlend);\r\n    }\r\n}\r\n\r\n// export collision shape class\r\nmodule.exports = RectangleShape;", "/**\r\n * All default collision detection implementations.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\collision\\resolvers_imp.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\n\r\n \r\n// export the main methods\r\nconst CollisionsImp = {\r\n    \r\n    /**\r\n     * Test collision between two points.\r\n     */\r\n    pointPoint: function(v1, v2) {\r\n        return v1._position.approximate(v2._position) ? v1._position : false;\r\n    },\r\n\r\n    /**\r\n     * Test collision between point and circle.\r\n     */\r\n    pointCircle: function(v1, c1) {\r\n        return (v1._position.distanceTo(c1._circle.center) <= c1._circle.radius) ? v1._position : false;\r\n    },\r\n\r\n    /**\r\n     * Test collision between point and rectangle.\r\n     */\r\n    pointRectangle: function(v1, r1) {\r\n        return r1._rect.containsVector(v1._position) ? v1._position : false;\r\n    },\r\n\r\n    /**\r\n     * Test collision between point and line.\r\n     */\r\n    pointLine: function(v1, l1) {\r\n        for (let i = 0; i < l1._lines.length; ++i) {\r\n            if (l1._lines[i].containsVector(v1._position)) {\r\n                return v1._position;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Test collision between a point and a tilemap.\r\n     */\r\n    pointTilemap: function(v1, tm) {\r\n        if (tm._intBoundingRect.containsVector(v1._position)) {\r\n            let tile = tm.getTileAt(v1._position);\r\n            return tile ? CollisionsImp.pointRectangle(v1, tile) : false;\r\n        }\r\n        if (tm._borderThickness && tm._boundingRect.containsVector(v1._position)) {\r\n            return v1._position;\r\n        }\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Test collision between circle and circle.\r\n     */\r\n    circleCircle: function(c1, c2) {\r\n        return c1._circle.center.distanceTo(c2._circle.center) <= (c1._circle.radius + c2._circle.radius);\r\n    },\r\n\r\n    /**\r\n     * Test collision between circle and rectangle.\r\n     */\r\n    circleRectangle: function(c1, r1) {\r\n        return r1._rect.collideCircle(c1._circle);\r\n    },\r\n\r\n    /**\r\n     * Test collision between circle and lines.\r\n     */\r\n    circleLine: function(c1, l1) {     \r\n        for (let i = 0; i < l1._lines.length; ++i) {\r\n            if (l1._lines[i].distanceToVector(c1._circle.center) <= c1._circle.radius) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n        \r\n    /**\r\n     * Test collision between circle and tilemap.\r\n     */\r\n    circleTilemap: function(c1, tm) {     \r\n        let collide = false;\r\n        tm.iterateTilesAtRegion(c1._getBoundingBox(), (tile) => {\r\n            if (CollisionsImp.circleRectangle(c1, tile)) {\r\n                collide = true;\r\n                return false;\r\n            }\r\n        });\r\n        return collide;\r\n    },\r\n\r\n    /**\r\n     * Test collision between rectangle and rectangle.\r\n     */\r\n    rectangleRectangle: function(r1, r2) {\r\n        return r1._rect.collideRect(r2._rect);\r\n    },\r\n    \r\n    /**\r\n     * Test collision between rectangle and line.\r\n     */\r\n    rectangleLine: function(r1, l1) {\r\n        for (let i = 0; i < l1._lines.length; ++i) {\r\n            if (r1._rect.collideLine(l1._lines[i])) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    \r\n    /**\r\n     * Test collision between rectangle and tilemap.\r\n     */\r\n    rectangleTilemap: function(r1, tm) {     \r\n        let collide = false;\r\n        tm.iterateTilesAtRegion(r1._getBoundingBox(), (tile) => {\r\n            collide = true;\r\n            return false;\r\n        });\r\n        return collide;\r\n    },\r\n\r\n    /**\r\n     * Test collision between line and line.\r\n     */\r\n    lineLine: function(l1, l2) {\r\n        for (let i = 0; i < l1._lines.length; ++i) {\r\n            for (let j = 0; j < l2._lines.length; ++j) {\r\n                if (l1._lines[i].collideLine(l2._lines[j])) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Test collision between line and tilemap.\r\n     */\r\n    lineTilemap: function(l1, tm) {     \r\n        let collide = false;\r\n        tm.iterateTilesAtRegion(l1._getBoundingBox(), (tile) => {\r\n            if (CollisionsImp.rectangleLine(tile, l1)) {\r\n                collide = true;\r\n                return false;\r\n            }\r\n        });\r\n        return collide;\r\n    },\r\n}\r\n\r\n\r\n// export the collisions implementation\r\nmodule.exports = CollisionsImp;", "/**\r\n * Implement collision lines.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\collision\\shapes\\lines.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\nconst CollisionShape = require(\"./shape\");\r\nconst gfx = require('./../../gfx');\r\nconst Line = require(\"../../utils/line\");\r\nconst Rectangle = require(\"../../utils/rectangle\");\r\nconst Circle = require(\"../../utils/circle\");\r\n\r\n\r\n/**\r\n * Collision lines class.\r\n * This shape is made of one line or more.\r\n */\r\nclass LinesShape extends CollisionShape\r\n{\r\n    /**\r\n     * Create the collision shape.\r\n     * @param {Array<Line>|Line} lines Starting line / lines.\r\n     */\r\n    constructor(lines)\r\n    {\r\n        super();\r\n        this._lines = [];\r\n        this.addLines(lines);\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    get shapeId()\r\n    {\r\n        return \"lines\";\r\n    }\r\n    \r\n    /**\r\n     * Add line or lines to this collision shape.\r\n     * @param {Array<Line>|Line} lines Line / lines to add.\r\n     */\r\n    addLines(lines)\r\n    {\r\n        // convert to array\r\n        if (!Array.isArray(lines)) {\r\n            lines = [lines];\r\n        }\r\n\r\n        // add lines\r\n        for (let i = 0; i < lines.length; ++i)\r\n        {\r\n            this._lines.push(lines[i]);\r\n        }\r\n\r\n        // get all points\r\n        let points = [];\r\n        for (let i = 0; i < this._lines.length; ++i) {\r\n            points.push(this._lines[i].from);\r\n            points.push(this._lines[i].to);\r\n        }\r\n\r\n        // reset bounding box and circle\r\n        this._boundingBox = Rectangle.fromPoints(points);\r\n        this._circle = new Circle(this._boundingBox.getCenter(), Math.max(this._boundingBox.width, this._boundingBox.height));\r\n        this._shapeChanged();\r\n    }\r\n\r\n    /**\r\n     * Set this shape from line or lines array.\r\n     * @param {Array<Line>|Line} lines Line / lines to set.\r\n     */\r\n    setLines(lines)\r\n    {\r\n        this._lines = [];\r\n        this.addLines(lines);\r\n    }\r\n \r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    _getRadius()\r\n    {\r\n        return this._circle.radius;\r\n    }\r\n    \r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    getCenter()\r\n    {\r\n        return this._circle.center.clone();\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    _getBoundingBox()\r\n    {\r\n        return this._boundingBox;\r\n    }\r\n\r\n    /**\r\n     * Debug draw this shape.\r\n     * @param {Number} opacity Shape opacity factor.\r\n     */\r\n    debugDraw(opacity)\r\n    {\r\n        if (opacity === undefined) opacity = 1;\r\n        let color = this._getDebugColor();\r\n\r\n        color.a *= opacity;\r\n        for (let i = 0; i < this._lines.length; ++i) {\r\n            gfx.drawLine(this._lines[i].from, this._lines[i].to, color, gfx.BlendModes.AlphaBlend);\r\n        }\r\n    }\r\n}\r\n\r\n// export collision lines class\r\nmodule.exports = LinesShape;", "/**\r\n * Implement collision tilemap.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\collision\\shapes\\tilemap.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst CollisionShape = require(\"./shape\");\r\nconst Rectangle = require(\"../../utils/rectangle\");\r\nconst Vector2 = require(\"../../utils/vector2\");\r\nconst gfx = require('./../../gfx');\r\nconst RectangleShape = require(\"./rectangle\");\r\n\r\n\r\n/**\r\n * Collision tilemap class.\r\n * A collision tilemap shape is a grid of equal-sized cells that can either block or not (+ have collision flags).\r\n * Its the most efficient (both memory and CPU) way to implement grid based / tilemap collision.\r\n */\r\nclass TilemapShape extends CollisionShape\r\n{\r\n    /**\r\n     * Create the collision tilemap.\r\n     * @param {Vector2} offset Tilemap top-left corner.\r\n     * @param {Vector2} gridSize Number of tiles on X and Y axis.\r\n     * @param {Vector2} tileSize The size of a single tile.\r\n     * @param {Number} borderThickness Set a border collider with this thickness.\r\n     */\r\n    constructor(offset, gridSize, tileSize, borderThickness)\r\n    {\r\n        super();\r\n        borderThickness = borderThickness || 0;\r\n        this._offset = offset.clone();\r\n        this._intBoundingRect = new Rectangle(offset.x, offset.y, gridSize.x * tileSize.x, gridSize.y * tileSize.y);\r\n        this._boundingRect = this._intBoundingRect.resize(borderThickness * 2);\r\n        this._center = this._boundingRect.getCenter();\r\n        this._radius = this._boundingRect.getBoundingCircle().radius;\r\n        this._borderThickness = borderThickness;\r\n        this._gridSize =  gridSize.clone();\r\n        this._tileSize = tileSize.clone();\r\n        this._tiles = {};\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    get shapeId()\r\n    {\r\n        return \"tilemap\";\r\n    }\r\n\r\n    /**\r\n     * Get tile key from vector index.\r\n     * Also validate range.\r\n     * @private\r\n     * @param {Vector2} index Index to get key for.\r\n     * @returns {String} tile key.\r\n     */\r\n    _indexToKey(index)\r\n    {\r\n        if (index.x < 0 || index.y < 0 || index.x >= this._gridSize.x || index.y >= this._gridSize.y) {\r\n            throw new Error(`Collision tile with index ${index.x},${index.y} is out of bounds!`);\r\n        }\r\n        return index.x +',' + index.y;\r\n    }\r\n\r\n    /**\r\n     * Set the state of a tile.\r\n     * @param {Vector2} index Tile index.\r\n     * @param {Boolean} haveCollision Does this tile have collision?\r\n     * @param {Number} collisionFlags Optional collision flag to set for this tile.\r\n     */\r\n    setTile(index, haveCollision, collisionFlags)\r\n    {\r\n        let key = this._indexToKey(index);\r\n        if (haveCollision) {\r\n            let rect = this._tiles[key] || new RectangleShape(\r\n                new Rectangle(\r\n                    this._offset.x + index.x * this._tileSize.x, \r\n                    this._offset.y + index.y * this._tileSize.y, \r\n                    this._tileSize.x, \r\n                    this._tileSize.y)\r\n                );\r\n            if (collisionFlags !== undefined) {\r\n                rect.collisionFlags = collisionFlags;\r\n            }\r\n            this._tiles[key] = rect;\r\n        }\r\n        else {\r\n            delete this._tiles[key];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the collision shape of a tile at a given position.\r\n     * @param {Vector2} position Position to get tile at.\r\n     * @returns {RectangleShape} Collision shape at this position, or null if not set.\r\n     */\r\n    getTileAt(position)\r\n    {\r\n        let index = new Vector2(Math.floor(position.x / this._tileSize.x), Math.floor(position.y / this._tileSize.y));\r\n        let key = index.x + ',' + index.y;\r\n        return this._tiles[key] || null;\r\n    }\r\n    \r\n    /**\r\n     * Iterate all tiles in given region, represented by a rectangle.\r\n     * @param {Rectangle} region Rectangle to get tiles for.\r\n     * @param {Function} callback Method to invoke for every tile. Return false to break iteration.\r\n     */\r\n    iterateTilesAtRegion(region, callback)\r\n    {\r\n        let topLeft = region.getTopLeft();\r\n        let bottomRight = region.getBottomRight();\r\n        let startIndex = new Vector2(Math.floor(topLeft.x / this._tileSize.x), Math.floor(topLeft.y / this._tileSize.y));\r\n        let endIndex = new Vector2(Math.floor(bottomRight.x / this._tileSize.x), Math.floor(bottomRight.y / this._tileSize.y));\r\n        for (let i = startIndex.x; i <= endIndex.x; ++i) {\r\n            for (let j = startIndex.y; j <= endIndex.y; ++j) {\r\n                let key = i + ',' + j;\r\n                let tile = this._tiles[key];\r\n                if (tile && (callback(tile) === false)) { \r\n                    return; \r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Get all tiles in given region, represented by a rectangle.\r\n     * @param {Rectangle} region Rectangle to get tiles for.\r\n     * @returns {Array<RectangleShape>} Array with rectangle shapes or empty if none found.\r\n     */\r\n    getTilesAtRegion(region)\r\n    {\r\n        let ret = [];\r\n        this.iterateTilesAtRegion(region, (tile) => { ret.push(tile); });\r\n        return ret;\r\n    }\r\n    \r\n    /**\r\n     * @inheritdoc\r\n     */ \r\n    _getRadius()\r\n    {\r\n        return this._radius;\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    _getBoundingBox()\r\n    {\r\n        return this._boundingRect;\r\n    }\r\n    \r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    getCenter()\r\n    {\r\n        return this._center.clone();\r\n    }\r\n    \r\n    /**\r\n     * Debug draw this shape.\r\n     * @param {Number} opacity Shape opacity factor.\r\n     */\r\n    debugDraw(opacity)\r\n    {\r\n        if (opacity === undefined) opacity = 1;\r\n        let color = this._getDebugColor();\r\n        color.a *= opacity;\r\n\r\n        // draw borders\r\n        if (this._haveBorders) {\r\n            gfx.outlineRect(this._intBoundingRect, color, gfx.BlendModes.AlphaBlend);\r\n            gfx.outlineRect(this._boundingRect, color, gfx.BlendModes.AlphaBlend);\r\n        }\r\n\r\n        // draw tiles\r\n        for (let key in this._tiles) {\r\n            let tile = this._tiles[key];\r\n            tile.setDebugColor(this._forceDebugColor);\r\n            tile.debugDraw(opacity);\r\n        }\r\n    }\r\n}\r\n\r\n// export collision shape class\r\nmodule.exports = TilemapShape;", "/**\r\n * Implement the collision manager.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\collision\\collision.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst IManager = require('../manager.js');\r\nconst Vector2 = require('../utils/vector2.js');\r\nconst CollisionWorld = require('./collision_world.js');\r\nconst CollisionResolver = require('./resolver');\r\nconst CircleShape = require('./shapes/circle.js');\r\nconst PointShape = require('./shapes/point.js');\r\nconst RectangleShape = require('./shapes/rectangle.js');\r\nconst ResolverImp = require('./resolvers_imp');\r\nconst LinesShape = require('./shapes/lines.js');\r\nconst TilemapShape = require('./shapes/tilemap.js');\r\nconst _logger = require('../logger.js').getLogger('collision');\r\n\r\n\r\n/**\r\n * Collision is the collision manager. \r\n * It provides basic 2d collision detection functionality.\r\n * Note: this is *not* a physics engine, its only for detection and objects picking.\r\n * \r\n * To access the Collision manager you use `Shaku.collision`. \r\n */\r\nclass Collision extends IManager\r\n{\r\n    /**\r\n     * Create the manager.\r\n     */\r\n    constructor()\r\n    {\r\n        super();\r\n\r\n        /**\r\n         * The collision resolver we use to detect collision between different shapes. \r\n         * You can use this object directly without creating a collision world, if you just need to test collision between shapes.\r\n         */\r\n        this.resolver = new CollisionResolver();\r\n    }\r\n\r\n    /** \r\n     * @inheritdoc \r\n     * @private\r\n     **/\r\n    setup()\r\n    {        \r\n        return new Promise((resolve, reject) => {    \r\n            _logger.info(\"Setup collision manager..\");\r\n\r\n            this.resolver._init();\r\n            this.resolver.setHandler(\"point\", \"point\", ResolverImp.pointPoint);\r\n            this.resolver.setHandler(\"point\", \"circle\", ResolverImp.pointCircle);\r\n            this.resolver.setHandler(\"point\", \"rect\", ResolverImp.pointRectangle);\r\n            this.resolver.setHandler(\"point\", \"lines\", ResolverImp.pointLine);\r\n            this.resolver.setHandler(\"point\", \"tilemap\", ResolverImp.pointTilemap);\r\n\r\n            this.resolver.setHandler(\"circle\", \"circle\", ResolverImp.circleCircle);\r\n            this.resolver.setHandler(\"circle\", \"rect\", ResolverImp.circleRectangle);\r\n            this.resolver.setHandler(\"circle\", \"lines\", ResolverImp.circleLine);\r\n            this.resolver.setHandler(\"circle\", \"tilemap\", ResolverImp.circleTilemap);\r\n\r\n            this.resolver.setHandler(\"rect\", \"rect\", ResolverImp.rectangleRectangle);\r\n            this.resolver.setHandler(\"rect\", \"lines\", ResolverImp.rectangleLine);\r\n            this.resolver.setHandler(\"rect\", \"tilemap\", ResolverImp.rectangleTilemap);\r\n\r\n            this.resolver.setHandler(\"lines\", \"lines\", ResolverImp.lineLine);\r\n            this.resolver.setHandler(\"lines\", \"tilemap\", ResolverImp.lineTilemap);\r\n\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Create a new collision world object.\r\n     * @param {Number|Vector2} gridCellSize Collision world grid cell size.\r\n     * @returns {CollisionWorld} Newly created collision world.\r\n     */\r\n    createWorld(gridCellSize)\r\n    {\r\n        return new CollisionWorld(this.resolver, gridCellSize);\r\n    }\r\n\r\n    /**\r\n     * Get the collision reactanle shape class.\r\n     */\r\n    get RectangleShape()\r\n    {\r\n        return RectangleShape\r\n    }\r\n\r\n    /**\r\n     * Get the collision point shape class.\r\n     */\r\n    get PointShape()\r\n    {\r\n        return PointShape;\r\n    }\r\n\r\n    /**\r\n     * Get the collision circle shape class.\r\n     */\r\n    get CircleShape()\r\n    {\r\n        return CircleShape;\r\n    }\r\n\r\n    /**\r\n     * Get the collision lines shape class.\r\n     */\r\n    get LinesShape()\r\n    {\r\n        return LinesShape;\r\n    }\r\n\r\n    /**\r\n     * Get the tilemap collision shape class.\r\n     */\r\n    get TilemapShape()\r\n    {\r\n        return TilemapShape;\r\n    }\r\n\r\n    /** \r\n     * @inheritdoc \r\n     * @private\r\n     **/\r\n    startFrame()\r\n    {\r\n    }\r\n\r\n    /** \r\n     * @inheritdoc \r\n     * @private\r\n     **/\r\n    endFrame()\r\n    {\r\n    }\r\n\r\n    /** \r\n     * @inheritdoc \r\n     * @private\r\n     **/\r\n    destroy()\r\n    {\r\n    }    \r\n}\r\n\r\n// export main object\r\nmodule.exports = new Collision();", "/**\r\n * Just an alias to main manager so we can require() this folder as a package.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\collision\\index.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n 'use strict';\r\n module.exports = require('./collision');", "/**\r\n * Shaku Main.\r\n * \r\n * |-- copyright and license --|\r\n * @package    Shaku\r\n * @file       shaku\\lib\\shaku.js\r\n * @author     Ronen Ness (ronenness@gmail.com | http://ronenness.com)\r\n * @copyright  (c) 2021 Ronen Ness\r\n * @license    MIT\r\n * |-- end copyright and license --|\r\n * \r\n */\r\n'use strict';\r\nconst isBrowser = typeof window !== 'undefined';\r\nconst IManager = require(\"./manager\");\r\nconst logger = require('./logger');\r\nconst sfx = isBrowser ? require('./sfx') : null;\r\nconst gfx = isBrowser ? require('./gfx') : null;\r\nconst input = isBrowser ? require('./input') : null;\r\nconst assets = require('./assets');\r\nconst collision = require('./collision');\r\nconst utils = require('./utils');\r\nconst GameTime = require(\"./utils/game_time\");\r\nconst _logger = logger.getLogger('shaku');\r\n\r\n// manager state and gametime\r\nlet _usedManagers = null;\r\nlet _prevUpdateTime = null;\r\n\r\n// to measure fps\r\nlet _currFpsCounter = 0;\r\nlet _countSecond = 0;\r\nlet _currFps = 0;\r\n\r\n// to measure time it takes for frames to finish\r\nlet _startFrameTime = 0;\r\nlet _frameTimeMeasuresCount = 0;\r\nlet _totalFrameTimes = 0;\r\n\r\n\r\n// current version\r\nconst version = \"1.6.1\";\r\n\r\n\r\n/**\r\n * Shaku's main object.\r\n * This object wraps the entire lib namespace, and this is what you use to access all managers and manage your main loop.\r\n*/\r\nclass Shaku \r\n{\r\n    /**\r\n     * Create the Shaku main object.\r\n     */\r\n    constructor()\r\n    {\r\n        /**\r\n         * Different utilities and framework objects, like vectors, rectangles, colors, etc.\r\n         */\r\n        this.utils = utils;\r\n\r\n        /**\r\n         * Sound effects and music manager.\r\n         */\r\n        this.sfx = sfx;\r\n\r\n        /**\r\n         * Graphics manager.\r\n         */\r\n        this.gfx = gfx;\r\n\r\n        /**\r\n         * Input manager.\r\n         */\r\n        this.input = input;\r\n\r\n        /**\r\n         * Assets manager.\r\n         */\r\n        this.assets = assets;\r\n\r\n        /**\r\n         * Collision detection manager.\r\n         */\r\n        this.collision = collision;\r\n\r\n        /**\r\n         * If true, will pause the updates and drawing calls when window is not focused.\r\n         * Will also not update elapsed time.\r\n         */\r\n        this.pauseWhenNotFocused = false;\r\n\r\n        /**\r\n         * Set to true to completely pause Shaku (will skip updates, drawing, and time counting).\r\n         */\r\n        this.paused = false;\r\n\r\n        /**\r\n         * Set to true to pause just the game time.\r\n         * This will not pause real-life time. If you need real-life time stop please use the Python package.\r\n         */\r\n        this.pauseTime = false;\r\n\r\n        // are managers currently in 'started' mode?\r\n        this._managersStarted = false;\r\n\r\n        // were we previously paused?\r\n        this._wasPaused = false;\r\n    }\r\n\r\n    /**\r\n     * Method to select managers to use + initialize them.\r\n     * @param {Array<IManager>=} managers Array with list of managers to use or null to use all.\r\n     * @returns {Promise} promise to resolve when finish initialization.\r\n     */\r\n    async init(managers)\r\n    {\r\n        return new Promise(async (resolve, reject) => {\r\n\r\n            // sanity & log\r\n            if (_usedManagers) { throw new Error(\"Already initialized!\"); }\r\n            _logger.info(`Initialize Shaku v${version}.`);\r\n            \r\n            // reset game start time\r\n            GameTime.reset();\r\n\r\n            // setup used managers\r\n            _usedManagers = managers || (isBrowser ? [assets, sfx, gfx, input, collision] : [assets, collision]);\r\n\r\n            // init all managers\r\n            for (let i = 0; i < _usedManagers.length; ++i) {\r\n                await _usedManagers[i].setup();\r\n            }\r\n\r\n            // set starting time\r\n            _prevUpdateTime = new GameTime();\r\n\r\n            // done!\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Destroy all managers\r\n     */\r\n    destroy()\r\n    {\r\n        // sanity\r\n        if (!_usedManagers) { throw new Error(\"Not initialized!\"); }\r\n        \r\n        // destroy all managers\r\n        for (let i = 0; i < _usedManagers.length; ++i) {\r\n            _usedManagers[i].destroy();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get if the Shaku is currently paused.\r\n     */\r\n    get isPaused()\r\n    {\r\n        return this.paused || (this.pauseWhenNotFocused && !document.hasFocus());\r\n    }\r\n\r\n    /**\r\n     * Start frame (update all managers).\r\n     */\r\n    startFrame()\r\n    {\r\n        // if paused, skip\r\n        if (this.isPaused) { \r\n            this._wasPaused = true;\r\n            return; \r\n        }\r\n\r\n        // returning from pause\r\n        if (this._wasPaused) {\r\n            this._wasPaused = false;\r\n            GameTime.resetDelta();\r\n        }\r\n\r\n        // update times\r\n        if (this.pauseTime) {\r\n            GameTime.resetDelta();\r\n        }\r\n        else {\r\n            GameTime.update();\r\n        }\r\n\r\n        // get frame start time\r\n        _startFrameTime = GameTime.rawTimestamp();\r\n\r\n        // create new gameTime object\r\n        this._gameTime = new GameTime();\r\n\r\n        // update animators\r\n        utils.Animator.updateAutos(this._gameTime.delta);\r\n\r\n        // update managers\r\n        for (let i = 0; i < _usedManagers.length; ++i) {\r\n            _usedManagers[i].startFrame();\r\n        }\r\n        this._managersStarted = true;\r\n    }\r\n\r\n    /**\r\n     * End frame (update all managers).\r\n     */\r\n    endFrame()\r\n    {\r\n        // update managers\r\n        if (this._managersStarted) {\r\n            for (let i = 0; i < _usedManagers.length; ++i) {\r\n                _usedManagers[i].endFrame();\r\n            }\r\n            this._managersStarted = false;\r\n        }\r\n\r\n        // if paused, skip\r\n        if (this.isPaused) { return; }\r\n\r\n        // store previous gameTime object\r\n        _prevUpdateTime = this._gameTime;\r\n\r\n        // count fps and time stats\r\n        if (this._gameTime) {\r\n            this._updateFpsAndTimeStats();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Measure FPS and averege update times.\r\n     * @private\r\n     */\r\n    _updateFpsAndTimeStats()\r\n    {\r\n        // update fps count and second counter\r\n        _currFpsCounter++;\r\n        _countSecond += this._gameTime.delta;\r\n\r\n        // a second passed:\r\n        if (_countSecond >= 1) {\r\n\r\n            // reset second count and set current fps value\r\n            _countSecond = 0;\r\n            _currFps = _currFpsCounter;\r\n            _currFpsCounter = 0;\r\n\r\n            // trim the frames avg time, so we won't drag peaks for too long\r\n            _totalFrameTimes = this.getAverageFrameTime();\r\n            _frameTimeMeasuresCount = 1;\r\n        }\r\n\r\n        // get frame end time and update average frames time\r\n        let _endFrameTime = GameTime.rawTimestamp();\r\n        _frameTimeMeasuresCount++;\r\n        _totalFrameTimes += (_endFrameTime - _startFrameTime);\r\n    }\r\n\r\n    /**\r\n     * Make Shaku run in silent mode, without logs.\r\n     * You can call this before init.\r\n     */\r\n    silent()\r\n    {\r\n        logger.silent();\r\n    }\r\n\r\n    /**\r\n     * Set logger to throw an error every time a log message with severity higher than warning is written.\r\n     * You can call this before init.\r\n     * @param {Boolean} enable Set to true to throw error on warnings.\r\n     */\r\n    throwErrorOnWarnings(enable)\r\n    {\r\n        if (enable === undefined) { throw Error(\"Must provide a value!\"); }\r\n        logger.throwErrorOnWarnings(enable);\r\n    }\r\n\r\n    /**\r\n     * Get current frame game time.\r\n     * Only valid between startFrame() and endFrame().\r\n     * @returns {GameTime} Current frame's gametime.\r\n     */\r\n    get gameTime()\r\n    {\r\n        return this._gameTime;\r\n    }\r\n\r\n    /**\r\n     * Get Shaku's version.\r\n     * @returns {String} Shaku's version.\r\n     */\r\n    get version() { return version; }\r\n\r\n    /**\r\n     * Return current FPS count.\r\n     * Note: will return 0 until at least one second have passed.\r\n     * @returns {Number} FPS count.\r\n     */\r\n    getFpsCount()\r\n    {\r\n        return _currFps;\r\n    }\r\n\r\n    /**\r\n     * Get how long on average it takes to complete a game frame.\r\n     * @returns {Number} Average time, in milliseconds, it takes to complete a game frame.\r\n     */\r\n    getAverageFrameTime()\r\n    {\r\n        if (_frameTimeMeasuresCount === 0) { return 0; }\r\n        return _totalFrameTimes / _frameTimeMeasuresCount;\r\n    }\r\n\r\n    /**\r\n     * Request animation frame with fallbacks.\r\n     * @param {Function} callback Method to invoke in next animation frame.\r\n     * @returns {Number} Handle for cancellation.\r\n     */\r\n    requestAnimationFrame(callback) \r\n    { \r\n        if (window.requestAnimationFrame) return window.requestAnimationFrame(callback);\r\n        else if (window.mozRequestAnimationFrame) return window.mozRequestAnimationFrame(callback);\r\n        else if (window.webkitRequestAnimationFrame) return window.webkitRequestAnimationFrame(callback);\r\n        else if (window.msRequestAnimationFrame) return window.msRequestAnimationFrame(callback);\r\n        else return setTimeout(callback, 1000/60);\r\n    }\r\n \r\n    /**\r\n     * Cancel animation frame with fallbacks.\r\n     * @param {Number} id Request handle.\r\n     */\r\n    cancelAnimationFrame(id) {\r\n        if (window.cancelAnimationFrame) return window.cancelAnimationFrame(id);\r\n        else if (window.mozCancelAnimationFrame) return window.mozCancelAnimationFrame(id);\r\n        else clearTimeout(id);\r\n    }\r\n\r\n    /**\r\n     * Set the logger writer class (will replace the default console output).\r\n     * @param {*} loggerHandler New logger handler (must implement trace, debug, info, warn, error methods).\r\n     */\r\n    setLogger(loggerHandler)\r\n    {\r\n        logger.setDrivers(loggerHandler);\r\n    }\r\n\r\n    /**\r\n     * Get / create a custom logger.\r\n     */\r\n    getLogger(name)\r\n    {\r\n        return logger.getLogger(name);\r\n    }\r\n};\r\n\r\n\r\n// return the main Shaku object.\r\nmodule.exports = new Shaku();", "import { BlendModes } from \"shaku/lib/gfx\";\r\nimport Shaku from \"shaku/lib/shaku\";\r\nimport TextureAsset from \"shaku/lib/assets/texture_asset\";\r\nimport * as dat from 'dat.gui';\r\nimport Color from \"shaku/lib/utils/color\";\r\n\r\nconst CONFIG = {\r\n    value_1: 100,\r\n    value_2: 0.6,\r\n};\r\nlet gui = new dat.GUI({});\r\ngui.remember(CONFIG);\r\ngui.add(CONFIG, \"value_1\", 0, 200);\r\ngui.add(CONFIG, \"value_2\", -1, 1);\r\n\r\n// init shaku\r\nawait Shaku.init();\r\n\r\n// add shaku's canvas to document and set resolution to 800x600\r\ndocument.body.appendChild(Shaku!.gfx!.canvas);\r\nShaku.gfx!.setResolution(800, 600, true);\r\n// Shaku.gfx!.centerCanvas();\r\n// Shaku.gfx!.maximizeCanvasSize(false, false);\r\n\r\nconsole.log(CONFIG.value_1);\r\nconsole.log(CONFIG.value_2);\r\n\r\n// Loading Screen\r\nShaku.startFrame();\r\nShaku.gfx!.clear(Shaku.utils.Color.cornflowerblue);\r\nShaku.endFrame();\r\n\r\n// TODO: INIT STUFF AND LOAD ASSETS HERE\r\nlet soundAsset = await Shaku.assets.loadSound('sounds/example_sound.wav');\r\nlet soundInstance = Shaku.sfx!.createSound(soundAsset);\r\n\r\nlet texture = await Shaku.assets.loadTexture('imgs/example_image.png', null);\r\nlet sprite = new Shaku.gfx!.Sprite(texture);\r\nsprite.position.set(Shaku.gfx!.canvas.width / 2, Shaku.gfx!.canvas.height / 2);\r\n\r\nlet texture2 = await loadAsciiTexture(`\r\n        .000.\r\n        .111.\r\n        22222\r\n        .333.\r\n        .3.3.\r\n    `, [Shaku.utils.Color.black,\r\nShaku.utils.Color.orange,\r\nShaku.utils.Color.white,\r\nShaku.utils.Color.blue\r\n]);\r\nlet sprite2 = new Shaku.gfx!.Sprite(texture2);\r\nsprite2.position.set(Shaku.gfx!.canvas.width / 2, Shaku.gfx!.canvas.height / 2);\r\nsprite2.size.mulSelf(30);\r\n\r\n\r\n// do a single main loop step and request the next step\r\nfunction step() {\r\n    // start a new frame and clear screen\r\n    Shaku.startFrame();\r\n    Shaku.gfx!.clear(Shaku.utils.Color.cornflowerblue);\r\n\r\n    // TODO: PUT YOUR GAME UPDATES / RENDERING HERE\r\n    Shaku.gfx!.drawSprite(sprite);\r\n    if (Shaku.input!.pressed(\"a\")) {\r\n        soundInstance.play();\r\n    }\r\n\r\n    Shaku.gfx!.drawSprite(sprite2);\r\n\r\n    // end frame and request next step\r\n    Shaku.endFrame();\r\n    Shaku.requestAnimationFrame(step);\r\n}\r\n\r\n// start main loop\r\nstep();\r\n\r\n\r\nasync function loadAsciiTexture(ascii: string, colors: (string | Color)[]): Promise<TextureAsset> {\r\n\r\n    let rows = ascii.trim().split(\"\\n\").map(x => x.trim())\r\n    console.log(rows)\r\n    let height = rows.length\r\n    let width = rows[0].length\r\n\r\n    // create render target\r\n    // @ts-ignore\r\n    let renderTarget = await Shaku.assets.createRenderTarget(null, width, height, 4);\r\n\r\n    // use render target\r\n    Shaku.gfx!.setRenderTarget(renderTarget, false);\r\n\r\n    for (let j = 0; j < height; j++) {\r\n        for (let i = 0; i < width; i++) {\r\n            let val = rows[j][i];\r\n            if (val === '.' || val === ' ') continue;\r\n            let n = parseInt(val);\r\n\r\n            let col = colors[n];\r\n            if (typeof col === 'string') {\r\n                col = Shaku.utils.Color.fromHex(col);\r\n            }\r\n            Shaku.gfx!.fillRect(\r\n                new Shaku.utils.Rectangle(i, height - j - 1, 1, 1),\r\n                col,\r\n                BlendModes.Opaque, 0\r\n            );\r\n        }\r\n    }\r\n\r\n    // reset render target\r\n    // @ts-ignore\r\n    Shaku.gfx!.setRenderTarget(null, false);\r\n\r\n    return renderTarget;\r\n}\r\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nexport default function(color, forceCSSHex) {\n  const colorFormat = color.__state.conversionName.toString();\n\n  const r = Math.round(color.r);\n  const g = Math.round(color.g);\n  const b = Math.round(color.b);\n  const a = color.a;\n  const h = Math.round(color.h);\n  const s = color.s.toFixed(1);\n  const v = color.v.toFixed(1);\n\n  if (forceCSSHex || (colorFormat === 'THREE_CHAR_HEX') || (colorFormat === 'SIX_CHAR_HEX')) {\n    let str = color.hex.toString(16);\n    while (str.length < 6) {\n      str = '0' + str;\n    }\n    return '#' + str;\n  } else if (colorFormat === 'CSS_RGB') {\n    return 'rgb(' + r + ',' + g + ',' + b + ')';\n  } else if (colorFormat === 'CSS_RGBA') {\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\n  } else if (colorFormat === 'HEX') {\n    return '0x' + color.hex.toString(16);\n  } else if (colorFormat === 'RGB_ARRAY') {\n    return '[' + r + ',' + g + ',' + b + ']';\n  } else if (colorFormat === 'RGBA_ARRAY') {\n    return '[' + r + ',' + g + ',' + b + ',' + a + ']';\n  } else if (colorFormat === 'RGB_OBJ') {\n    return '{r:' + r + ',g:' + g + ',b:' + b + '}';\n  } else if (colorFormat === 'RGBA_OBJ') {\n    return '{r:' + r + ',g:' + g + ',b:' + b + ',a:' + a + '}';\n  } else if (colorFormat === 'HSV_OBJ') {\n    return '{h:' + h + ',s:' + s + ',v:' + v + '}';\n  } else if (colorFormat === 'HSVA_OBJ') {\n    return '{h:' + h + ',s:' + s + ',v:' + v + ',a:' + a + '}';\n  }\n\n  return 'unknown format';\n}\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nconst ARR_EACH = Array.prototype.forEach;\nconst ARR_SLICE = Array.prototype.slice;\n\n/**\n * Band-aid methods for things that should be a lot easier in JavaScript.\n * Implementation and structure inspired by underscore.js\n * http://documentcloud.github.com/underscore/\n */\n\nconst Common = {\n  BREAK: {},\n\n  extend: function(target) {\n    this.each(ARR_SLICE.call(arguments, 1), function(obj) {\n      const keys = this.isObject(obj) ? Object.keys(obj) : [];\n      keys.forEach(function(key) {\n        if (!this.isUndefined(obj[key])) {\n          target[key] = obj[key];\n        }\n      }.bind(this));\n    }, this);\n\n    return target;\n  },\n\n  defaults: function(target) {\n    this.each(ARR_SLICE.call(arguments, 1), function(obj) {\n      const keys = this.isObject(obj) ? Object.keys(obj) : [];\n      keys.forEach(function(key) {\n        if (this.isUndefined(target[key])) {\n          target[key] = obj[key];\n        }\n      }.bind(this));\n    }, this);\n\n    return target;\n  },\n\n  compose: function() {\n    const toCall = ARR_SLICE.call(arguments);\n    return function() {\n      let args = ARR_SLICE.call(arguments);\n      for (let i = toCall.length - 1; i >= 0; i--) {\n        args = [toCall[i].apply(this, args)];\n      }\n      return args[0];\n    };\n  },\n\n  each: function(obj, itr, scope) {\n    if (!obj) {\n      return;\n    }\n\n    if (ARR_EACH && obj.forEach && obj.forEach === ARR_EACH) {\n      obj.forEach(itr, scope);\n    } else if (obj.length === obj.length + 0) { // Is number but not NaN\n      let key;\n      let l;\n      for (key = 0, l = obj.length; key < l; key++) {\n        if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) {\n          return;\n        }\n      }\n    } else {\n      for (const key in obj) {\n        if (itr.call(scope, obj[key], key) === this.BREAK) {\n          return;\n        }\n      }\n    }\n  },\n\n  defer: function(fnc) {\n    setTimeout(fnc, 0);\n  },\n\n  // if the function is called repeatedly, wait until threshold passes until we execute the function\n  debounce: function(func, threshold, callImmediately) {\n    let timeout;\n\n    return function() {\n      const obj = this;\n      const args = arguments;\n      function delayed() {\n        timeout = null;\n        if (!callImmediately) func.apply(obj, args);\n      }\n\n      const callNow = callImmediately || !timeout;\n\n      clearTimeout(timeout);\n      timeout = setTimeout(delayed, threshold);\n\n      if (callNow) {\n        func.apply(obj, args);\n      }\n    };\n  },\n\n  toArray: function(obj) {\n    if (obj.toArray) return obj.toArray();\n    return ARR_SLICE.call(obj);\n  },\n\n  isUndefined: function(obj) {\n    return obj === undefined;\n  },\n\n  isNull: function(obj) {\n    return obj === null;\n  },\n\n  isNaN: function(obj) {\n    return isNaN(obj);\n  },\n\n  isArray: Array.isArray || function(obj) {\n    return obj.constructor === Array;\n  },\n\n  isObject: function(obj) {\n    return obj === Object(obj);\n  },\n\n  isNumber: function(obj) {\n    return obj === obj + 0;\n  },\n\n  isString: function(obj) {\n    return obj === obj + '';\n  },\n\n  isBoolean: function(obj) {\n    return obj === false || obj === true;\n  },\n\n  isFunction: function(obj) {\n    return obj instanceof Function;\n  }\n\n};\n\nexport default Common;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nimport toString from './toString';\nimport common from '../utils/common';\n\nconst INTERPRETATIONS = [\n  // Strings\n  {\n    litmus: common.isString,\n    conversions: {\n      THREE_CHAR_HEX: {\n        read: function(original) {\n          const test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\n          if (test === null) {\n            return false;\n          }\n\n          return {\n            space: 'HEX',\n            hex: parseInt(\n              '0x' +\n              test[1].toString() + test[1].toString() +\n              test[2].toString() + test[2].toString() +\n              test[3].toString() + test[3].toString(), 0\n            )\n          };\n        },\n\n        write: toString\n      },\n\n      SIX_CHAR_HEX: {\n        read: function(original) {\n          const test = original.match(/^#([A-F0-9]{6})$/i);\n          if (test === null) {\n            return false;\n          }\n\n          return {\n            space: 'HEX',\n            hex: parseInt('0x' + test[1].toString(), 0)\n          };\n        },\n\n        write: toString\n      },\n\n      CSS_RGB: {\n        read: function(original) {\n          const test = original.match(/^rgb\\(\\s*(\\S+)\\s*,\\s*(\\S+)\\s*,\\s*(\\S+)\\s*\\)/);\n          if (test === null) {\n            return false;\n          }\n\n          return {\n            space: 'RGB',\n            r: parseFloat(test[1]),\n            g: parseFloat(test[2]),\n            b: parseFloat(test[3])\n          };\n        },\n\n        write: toString\n      },\n\n      CSS_RGBA: {\n        read: function(original) {\n          const test = original.match(/^rgba\\(\\s*(\\S+)\\s*,\\s*(\\S+)\\s*,\\s*(\\S+)\\s*,\\s*(\\S+)\\s*\\)/);\n          if (test === null) {\n            return false;\n          }\n\n          return {\n            space: 'RGB',\n            r: parseFloat(test[1]),\n            g: parseFloat(test[2]),\n            b: parseFloat(test[3]),\n            a: parseFloat(test[4])\n          };\n        },\n\n        write: toString\n      }\n    }\n  },\n\n  // Numbers\n  {\n    litmus: common.isNumber,\n\n    conversions: {\n\n      HEX: {\n        read: function(original) {\n          return {\n            space: 'HEX',\n            hex: original,\n            conversionName: 'HEX'\n          };\n        },\n\n        write: function(color) {\n          return color.hex;\n        }\n      }\n\n    }\n\n  },\n\n  // Arrays\n  {\n    litmus: common.isArray,\n    conversions: {\n      RGB_ARRAY: {\n        read: function(original) {\n          if (original.length !== 3) {\n            return false;\n          }\n\n          return {\n            space: 'RGB',\n            r: original[0],\n            g: original[1],\n            b: original[2]\n          };\n        },\n\n        write: function(color) {\n          return [color.r, color.g, color.b];\n        }\n      },\n\n      RGBA_ARRAY: {\n        read: function(original) {\n          if (original.length !== 4) return false;\n          return {\n            space: 'RGB',\n            r: original[0],\n            g: original[1],\n            b: original[2],\n            a: original[3]\n          };\n        },\n\n        write: function(color) {\n          return [color.r, color.g, color.b, color.a];\n        }\n      }\n    }\n  },\n\n  // Objects\n  {\n    litmus: common.isObject,\n    conversions: {\n\n      RGBA_OBJ: {\n        read: function(original) {\n          if (common.isNumber(original.r) &&\n            common.isNumber(original.g) &&\n            common.isNumber(original.b) &&\n            common.isNumber(original.a)) {\n            return {\n              space: 'RGB',\n              r: original.r,\n              g: original.g,\n              b: original.b,\n              a: original.a\n            };\n          }\n          return false;\n        },\n\n        write: function(color) {\n          return {\n            r: color.r,\n            g: color.g,\n            b: color.b,\n            a: color.a\n          };\n        }\n      },\n\n      RGB_OBJ: {\n        read: function(original) {\n          if (common.isNumber(original.r) &&\n            common.isNumber(original.g) &&\n            common.isNumber(original.b)) {\n            return {\n              space: 'RGB',\n              r: original.r,\n              g: original.g,\n              b: original.b\n            };\n          }\n          return false;\n        },\n\n        write: function(color) {\n          return {\n            r: color.r,\n            g: color.g,\n            b: color.b\n          };\n        }\n      },\n\n      HSVA_OBJ: {\n        read: function(original) {\n          if (common.isNumber(original.h) &&\n            common.isNumber(original.s) &&\n            common.isNumber(original.v) &&\n            common.isNumber(original.a)) {\n            return {\n              space: 'HSV',\n              h: original.h,\n              s: original.s,\n              v: original.v,\n              a: original.a\n            };\n          }\n          return false;\n        },\n\n        write: function(color) {\n          return {\n            h: color.h,\n            s: color.s,\n            v: color.v,\n            a: color.a\n          };\n        }\n      },\n\n      HSV_OBJ: {\n        read: function(original) {\n          if (common.isNumber(original.h) &&\n            common.isNumber(original.s) &&\n            common.isNumber(original.v)) {\n            return {\n              space: 'HSV',\n              h: original.h,\n              s: original.s,\n              v: original.v\n            };\n          }\n          return false;\n        },\n\n        write: function(color) {\n          return {\n            h: color.h,\n            s: color.s,\n            v: color.v\n          };\n        }\n      }\n    }\n  }\n];\n\nlet result;\nlet toReturn;\n\nconst interpret = function() {\n  toReturn = false;\n\n  const original = arguments.length > 1 ? common.toArray(arguments) : arguments[0];\n  common.each(INTERPRETATIONS, function(family) {\n    if (family.litmus(original)) {\n      common.each(family.conversions, function(conversion, conversionName) {\n        result = conversion.read(original);\n\n        if (toReturn === false && result !== false) {\n          toReturn = result;\n          result.conversionName = conversionName;\n          result.conversion = conversion;\n          return common.BREAK;\n        }\n      });\n\n      return common.BREAK;\n    }\n  });\n\n  return toReturn;\n};\n\nexport default interpret;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nlet tmpComponent;\n\nconst ColorMath = {\n  hsv_to_rgb: function(h, s, v) {\n    const hi = Math.floor(h / 60) % 6;\n\n    const f = h / 60 - Math.floor(h / 60);\n    const p = v * (1.0 - s);\n    const q = v * (1.0 - (f * s));\n    const t = v * (1.0 - ((1.0 - f) * s));\n\n    const c = [\n      [v, t, p],\n      [q, v, p],\n      [p, v, t],\n      [p, q, v],\n      [t, p, v],\n      [v, p, q]\n    ][hi];\n\n    return {\n      r: c[0] * 255,\n      g: c[1] * 255,\n      b: c[2] * 255\n    };\n  },\n\n  rgb_to_hsv: function(r, g, b) {\n    const min = Math.min(r, g, b);\n    const max = Math.max(r, g, b);\n    const delta = max - min;\n    let h;\n    let s;\n\n    if (max !== 0) {\n      s = delta / max;\n    } else {\n      return {\n        h: NaN,\n        s: 0,\n        v: 0\n      };\n    }\n\n    if (r === max) {\n      h = (g - b) / delta;\n    } else if (g === max) {\n      h = 2 + (b - r) / delta;\n    } else {\n      h = 4 + (r - g) / delta;\n    }\n    h /= 6;\n    if (h < 0) {\n      h += 1;\n    }\n\n    return {\n      h: h * 360,\n      s: s,\n      v: max / 255\n    };\n  },\n\n  rgb_to_hex: function(r, g, b) {\n    let hex = this.hex_with_component(0, 2, r);\n    hex = this.hex_with_component(hex, 1, g);\n    hex = this.hex_with_component(hex, 0, b);\n    return hex;\n  },\n\n  component_from_hex: function(hex, componentIndex) {\n    return (hex >> (componentIndex * 8)) & 0xFF;\n  },\n\n  hex_with_component: function(hex, componentIndex, value) {\n    return value << (tmpComponent = componentIndex * 8) | (hex & ~(0xFF << tmpComponent));\n  }\n};\n\nexport default ColorMath;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nimport interpret from './interpret';\nimport math from './math';\nimport colorToString from './toString';\nimport common from '../utils/common';\n\nclass Color {\n  constructor() {\n    this.__state = interpret.apply(this, arguments);\n\n    if (this.__state === false) {\n      throw new Error('Failed to interpret color arguments');\n    }\n\n    this.__state.a = this.__state.a || 1;\n  }\n\n  toString() {\n    return colorToString(this);\n  }\n\n  toHexString() {\n    return colorToString(this, true);\n  }\n\n  toOriginal() {\n    return this.__state.conversion.write(this);\n  }\n}\n\nfunction defineRGBComponent(target, component, componentHexIndex) {\n  Object.defineProperty(target, component, {\n    get: function() {\n      if (this.__state.space === 'RGB') {\n        return this.__state[component];\n      }\n\n      Color.recalculateRGB(this, component, componentHexIndex);\n\n      return this.__state[component];\n    },\n\n    set: function(v) {\n      if (this.__state.space !== 'RGB') {\n        Color.recalculateRGB(this, component, componentHexIndex);\n        this.__state.space = 'RGB';\n      }\n\n      this.__state[component] = v;\n    }\n  });\n}\n\nfunction defineHSVComponent(target, component) {\n  Object.defineProperty(target, component, {\n    get: function() {\n      if (this.__state.space === 'HSV') {\n        return this.__state[component];\n      }\n\n      Color.recalculateHSV(this);\n\n      return this.__state[component];\n    },\n\n    set: function(v) {\n      if (this.__state.space !== 'HSV') {\n        Color.recalculateHSV(this);\n        this.__state.space = 'HSV';\n      }\n\n      this.__state[component] = v;\n    }\n  });\n}\n\n\nColor.recalculateRGB = function(color, component, componentHexIndex) {\n  if (color.__state.space === 'HEX') {\n    color.__state[component] = math.component_from_hex(color.__state.hex, componentHexIndex);\n  } else if (color.__state.space === 'HSV') {\n    common.extend(color.__state, math.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\n  } else {\n    throw new Error('Corrupted color state');\n  }\n};\n\nColor.recalculateHSV = function(color) {\n  const result = math.rgb_to_hsv(color.r, color.g, color.b);\n\n  common.extend(color.__state,\n    {\n      s: result.s,\n      v: result.v\n    });\n\n  if (!common.isNaN(result.h)) {\n    color.__state.h = result.h;\n  } else if (common.isUndefined(color.__state.h)) {\n    color.__state.h = 0;\n  }\n};\n\nColor.COMPONENTS = ['r', 'g', 'b', 'h', 's', 'v', 'hex', 'a'];\n\ndefineRGBComponent(Color.prototype, 'r', 2);\ndefineRGBComponent(Color.prototype, 'g', 1);\ndefineRGBComponent(Color.prototype, 'b', 0);\n\ndefineHSVComponent(Color.prototype, 'h');\ndefineHSVComponent(Color.prototype, 's');\ndefineHSVComponent(Color.prototype, 'v');\n\nObject.defineProperty(Color.prototype, 'a', {\n  get: function() {\n    return this.__state.a;\n  },\n\n  set: function(v) {\n    this.__state.a = v;\n  }\n});\n\nObject.defineProperty(Color.prototype, 'hex', {\n  get: function() {\n    if (this.__state.space !== 'HEX') {\n      this.__state.hex = math.rgb_to_hex(this.r, this.g, this.b);\n      this.__state.space = 'HEX';\n    }\n\n    return this.__state.hex;\n  },\n\n  set: function(v) {\n    this.__state.space = 'HEX';\n    this.__state.hex = v;\n  }\n});\n\nexport default Color;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\n/**\n * @class An \"abstract\" class that represents a given property of an object.\n *\n * @param {Object} object The object to be manipulated\n * @param {string} property The name of the property to be manipulated\n */\nclass Controller {\n  constructor(object, property) {\n    this.initialValue = object[property];\n\n    /**\n     * Those who extend this class will put their DOM elements in here.\n     * @type {DOMElement}\n     */\n    this.domElement = document.createElement('div');\n\n    /**\n     * The object to manipulate\n     * @type {Object}\n     */\n    this.object = object;\n\n    /**\n     * The name of the property to manipulate\n     * @type {String}\n     */\n    this.property = property;\n\n    /**\n     * The function to be called on change.\n     * @type {Function}\n     * @ignore\n     */\n    this.__onChange = undefined;\n\n    /**\n     * The function to be called on finishing change.\n     * @type {Function}\n     * @ignore\n     */\n    this.__onFinishChange = undefined;\n  }\n\n  /**\n   * Specify that a function fire every time someone changes the value with\n   * this Controller.\n   *\n   * @param {Function} fnc This function will be called whenever the value\n   * is modified via this Controller.\n   * @returns {Controller} this\n   */\n  onChange(fnc) {\n    this.__onChange = fnc;\n    return this;\n  }\n\n  /**\n   * Specify that a function fire every time someone \"finishes\" changing\n   * the value wih this Controller. Useful for values that change\n   * incrementally like numbers or strings.\n   *\n   * @param {Function} fnc This function will be called whenever\n   * someone \"finishes\" changing the value via this Controller.\n   * @returns {Controller} this\n   */\n  onFinishChange(fnc) {\n    this.__onFinishChange = fnc;\n    return this;\n  }\n\n  /**\n   * Change the value of <code>object[property]</code>\n   *\n   * @param {Object} newValue The new value of <code>object[property]</code>\n   */\n  setValue(newValue) {\n    this.object[this.property] = newValue;\n    if (this.__onChange) {\n      this.__onChange.call(this, newValue);\n    }\n\n    this.updateDisplay();\n    return this;\n  }\n\n  /**\n   * Gets the value of <code>object[property]</code>\n   *\n   * @returns {Object} The current value of <code>object[property]</code>\n   */\n  getValue() {\n    return this.object[this.property];\n  }\n\n  /**\n   * Refreshes the visual display of a Controller in order to keep sync\n   * with the object's current value.\n   * @returns {Controller} this\n   */\n  updateDisplay() {\n    return this;\n  }\n\n  /**\n   * @returns {boolean} true if the value has deviated from initialValue\n   */\n  isModified() {\n    return this.initialValue !== this.getValue();\n  }\n}\n\nexport default Controller;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nimport common from '../utils/common';\n\nconst EVENT_MAP = {\n  HTMLEvents: ['change'],\n  MouseEvents: ['click', 'mousemove', 'mousedown', 'mouseup', 'mouseover'],\n  KeyboardEvents: ['keydown']\n};\n\nconst EVENT_MAP_INV = {};\ncommon.each(EVENT_MAP, function(v, k) {\n  common.each(v, function(e) {\n    EVENT_MAP_INV[e] = k;\n  });\n});\n\nconst CSS_VALUE_PIXELS = /(\\d+(\\.\\d+)?)px/;\n\nfunction cssValueToPixels(val) {\n  if (val === '0' || common.isUndefined(val)) {\n    return 0;\n  }\n\n  const match = val.match(CSS_VALUE_PIXELS);\n\n  if (!common.isNull(match)) {\n    return parseFloat(match[1]);\n  }\n\n  // TODO ...ems? %?\n\n  return 0;\n}\n\n/**\n * @namespace\n * @member dat.dom\n */\nconst dom = {\n\n  /**\n   *\n   * @param elem\n   * @param selectable\n   */\n  makeSelectable: function(elem, selectable) {\n    if (elem === undefined || elem.style === undefined) return;\n\n    elem.onselectstart = selectable ? function() {\n      return false;\n    } : function() {\n    };\n\n    elem.style.MozUserSelect = selectable ? 'auto' : 'none';\n    elem.style.KhtmlUserSelect = selectable ? 'auto' : 'none';\n    elem.unselectable = selectable ? 'on' : 'off';\n  },\n\n  /**\n   *\n   * @param elem\n   * @param horizontal\n   * @param vert\n   */\n  makeFullscreen: function(elem, hor, vert) {\n    let vertical = vert;\n    let horizontal = hor;\n\n    if (common.isUndefined(horizontal)) {\n      horizontal = true;\n    }\n\n    if (common.isUndefined(vertical)) {\n      vertical = true;\n    }\n\n    elem.style.position = 'absolute';\n\n    if (horizontal) {\n      elem.style.left = 0;\n      elem.style.right = 0;\n    }\n    if (vertical) {\n      elem.style.top = 0;\n      elem.style.bottom = 0;\n    }\n  },\n\n  /**\n   *\n   * @param elem\n   * @param eventType\n   * @param params\n   */\n  fakeEvent: function(elem, eventType, pars, aux) {\n    const params = pars || {};\n    const className = EVENT_MAP_INV[eventType];\n    if (!className) {\n      throw new Error('Event type ' + eventType + ' not supported.');\n    }\n    const evt = document.createEvent(className);\n    switch (className) {\n      case 'MouseEvents':\n      {\n        const clientX = params.x || params.clientX || 0;\n        const clientY = params.y || params.clientY || 0;\n        evt.initMouseEvent(eventType, params.bubbles || false,\n          params.cancelable || true, window, params.clickCount || 1,\n          0, // screen X\n          0, // screen Y\n          clientX, // client X\n          clientY, // client Y\n          false, false, false, false, 0, null);\n        break;\n      }\n      case 'KeyboardEvents':\n      {\n        const init = evt.initKeyboardEvent || evt.initKeyEvent; // webkit || moz\n        common.defaults(params, {\n          cancelable: true,\n          ctrlKey: false,\n          altKey: false,\n          shiftKey: false,\n          metaKey: false,\n          keyCode: undefined,\n          charCode: undefined\n        });\n        init(eventType, params.bubbles || false,\n          params.cancelable, window,\n          params.ctrlKey, params.altKey,\n          params.shiftKey, params.metaKey,\n          params.keyCode, params.charCode);\n        break;\n      }\n      default:\n      {\n        evt.initEvent(eventType, params.bubbles || false, params.cancelable || true);\n        break;\n      }\n    }\n    common.defaults(evt, aux);\n    elem.dispatchEvent(evt);\n  },\n\n  /**\n   *\n   * @param elem\n   * @param event\n   * @param func\n   * @param bool\n   */\n  bind: function(elem, event, func, newBool) {\n    const bool = newBool || false;\n    if (elem.addEventListener) {\n      elem.addEventListener(event, func, bool);\n    } else if (elem.attachEvent) {\n      elem.attachEvent('on' + event, func);\n    }\n    return dom;\n  },\n\n  /**\n   *\n   * @param elem\n   * @param event\n   * @param func\n   * @param bool\n   */\n  unbind: function(elem, event, func, newBool) {\n    const bool = newBool || false;\n    if (elem.removeEventListener) {\n      elem.removeEventListener(event, func, bool);\n    } else if (elem.detachEvent) {\n      elem.detachEvent('on' + event, func);\n    }\n    return dom;\n  },\n\n  /**\n   *\n   * @param elem\n   * @param className\n   */\n  addClass: function(elem, className) {\n    if (elem.className === undefined) {\n      elem.className = className;\n    } else if (elem.className !== className) {\n      const classes = elem.className.split(/ +/);\n      if (classes.indexOf(className) === -1) {\n        classes.push(className);\n        elem.className = classes.join(' ').replace(/^\\s+/, '').replace(/\\s+$/, '');\n      }\n    }\n    return dom;\n  },\n\n  /**\n   *\n   * @param elem\n   * @param className\n   */\n  removeClass: function(elem, className) {\n    if (className) {\n      if (elem.className === className) {\n        elem.removeAttribute('class');\n      } else {\n        const classes = elem.className.split(/ +/);\n        const index = classes.indexOf(className);\n        if (index !== -1) {\n          classes.splice(index, 1);\n          elem.className = classes.join(' ');\n        }\n      }\n    } else {\n      elem.className = undefined;\n    }\n    return dom;\n  },\n\n  hasClass: function(elem, className) {\n    return new RegExp('(?:^|\\\\s+)' + className + '(?:\\\\s+|$)').test(elem.className) || false;\n  },\n\n  /**\n   *\n   * @param elem\n   */\n  getWidth: function(elem) {\n    const style = getComputedStyle(elem);\n\n    return cssValueToPixels(style['border-left-width']) +\n      cssValueToPixels(style['border-right-width']) +\n      cssValueToPixels(style['padding-left']) +\n      cssValueToPixels(style['padding-right']) +\n      cssValueToPixels(style.width);\n  },\n\n  /**\n   *\n   * @param elem\n   */\n  getHeight: function(elem) {\n    const style = getComputedStyle(elem);\n\n    return cssValueToPixels(style['border-top-width']) +\n      cssValueToPixels(style['border-bottom-width']) +\n      cssValueToPixels(style['padding-top']) +\n      cssValueToPixels(style['padding-bottom']) +\n      cssValueToPixels(style.height);\n  },\n\n  /**\n   *\n   * @param el\n   */\n  getOffset: function(el) {\n    let elem = el;\n    const offset = { left: 0, top: 0 };\n    if (elem.offsetParent) {\n      do {\n        offset.left += elem.offsetLeft;\n        offset.top += elem.offsetTop;\n        elem = elem.offsetParent;\n      } while (elem);\n    }\n    return offset;\n  },\n\n  // http://stackoverflow.com/posts/2684561/revisions\n  /**\n   *\n   * @param elem\n   */\n  isActive: function(elem) {\n    return elem === document.activeElement && (elem.type || elem.href);\n  }\n\n};\n\nexport default dom;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nimport Controller from './Controller';\nimport dom from '../dom/dom';\n\n/**\n * @class Provides a checkbox input to alter the boolean property of an object.\n *\n * @extends dat.controllers.Controller\n *\n * @param {Object} object The object to be manipulated\n * @param {string} property The name of the property to be manipulated\n */\nclass BooleanController extends Controller {\n  constructor(object, property) {\n    super(object, property);\n\n    const _this = this;\n    this.__prev = this.getValue();\n\n    this.__checkbox = document.createElement('input');\n    this.__checkbox.setAttribute('type', 'checkbox');\n\n    function onChange() {\n      _this.setValue(!_this.__prev);\n    }\n\n    dom.bind(this.__checkbox, 'change', onChange, false);\n\n    this.domElement.appendChild(this.__checkbox);\n\n    // Match original value\n    this.updateDisplay();\n  }\n\n  setValue(v) {\n    const toReturn = super.setValue(v);\n    if (this.__onFinishChange) {\n      this.__onFinishChange.call(this, this.getValue());\n    }\n    this.__prev = this.getValue();\n    return toReturn;\n  }\n\n  updateDisplay() {\n    if (this.getValue() === true) {\n      this.__checkbox.setAttribute('checked', 'checked');\n      this.__checkbox.checked = true;\n      this.__prev = true;\n    } else {\n      this.__checkbox.checked = false;\n      this.__prev = false;\n    }\n\n    return super.updateDisplay();\n  }\n}\n\nexport default BooleanController;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nimport Controller from './Controller';\nimport dom from '../dom/dom';\nimport common from '../utils/common';\n\n/**\n * @class Provides a select input to alter the property of an object, using a\n * list of accepted values.\n *\n * @extends dat.controllers.Controller\n *\n * @param {Object} object The object to be manipulated\n * @param {string} property The name of the property to be manipulated\n * @param {Object|string[]} options A map of labels to acceptable values, or\n * a list of acceptable string values.\n */\nclass OptionController extends Controller {\n  constructor(object, property, opts) {\n    super(object, property);\n\n    let options = opts;\n\n    const _this = this;\n\n    /**\n     * The drop down menu\n     * @ignore\n     */\n    this.__select = document.createElement('select');\n\n    if (common.isArray(options)) {\n      const map = {};\n      common.each(options, function(element) {\n        map[element] = element;\n      });\n      options = map;\n    }\n\n    common.each(options, function(value, key) {\n      const opt = document.createElement('option');\n      opt.innerHTML = key;\n      opt.setAttribute('value', value);\n      _this.__select.appendChild(opt);\n    });\n\n    // Acknowledge original value\n    this.updateDisplay();\n\n    dom.bind(this.__select, 'change', function() {\n      const desiredValue = this.options[this.selectedIndex].value;\n      _this.setValue(desiredValue);\n    });\n\n    this.domElement.appendChild(this.__select);\n  }\n\n  setValue(v) {\n    const toReturn = super.setValue(v);\n\n    if (this.__onFinishChange) {\n      this.__onFinishChange.call(this, this.getValue());\n    }\n    return toReturn;\n  }\n\n  updateDisplay() {\n    if (dom.isActive(this.__select)) return this; // prevent number from updating if user is trying to manually update\n    this.__select.value = this.getValue();\n    return super.updateDisplay();\n  }\n}\n\nexport default OptionController;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nimport Controller from './Controller';\nimport dom from '../dom/dom';\n\n/**\n * @class Provides a text input to alter the string property of an object.\n *\n * @extends dat.controllers.Controller\n *\n * @param {Object} object The object to be manipulated\n * @param {string} property The name of the property to be manipulated\n */\nclass StringController extends Controller {\n  constructor(object, property) {\n    super(object, property);\n\n    const _this = this;\n\n    function onChange() {\n      _this.setValue(_this.__input.value);\n    }\n\n    function onBlur() {\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    this.__input = document.createElement('input');\n    this.__input.setAttribute('type', 'text');\n\n    dom.bind(this.__input, 'keyup', onChange);\n    dom.bind(this.__input, 'change', onChange);\n    dom.bind(this.__input, 'blur', onBlur);\n    dom.bind(this.__input, 'keydown', function(e) {\n      if (e.keyCode === 13) {\n        this.blur();\n      }\n    });\n\n    this.updateDisplay();\n\n    this.domElement.appendChild(this.__input);\n  }\n\n  updateDisplay() {\n    // Stops the caret from moving on account of:\n    // keyup -> setValue -> updateDisplay\n    if (!dom.isActive(this.__input)) {\n      this.__input.value = this.getValue();\n    }\n    return super.updateDisplay();\n  }\n}\n\nexport default StringController;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nimport Controller from './Controller';\nimport common from '../utils/common';\n\nfunction numDecimals(x) {\n  const _x = x.toString();\n  if (_x.indexOf('.') > -1) {\n    return _x.length - _x.indexOf('.') - 1;\n  }\n\n  return 0;\n}\n\n/**\n * @class Represents a given property of an object that is a number.\n *\n * @extends dat.controllers.Controller\n *\n * @param {Object} object The object to be manipulated\n * @param {string} property The name of the property to be manipulated\n * @param {Object} [params] Optional parameters\n * @param {Number} [params.min] Minimum allowed value\n * @param {Number} [params.max] Maximum allowed value\n * @param {Number} [params.step] Increment by which to change value\n */\nclass NumberController extends Controller {\n  constructor(object, property, params) {\n    super(object, property);\n\n    const _params = params || {};\n\n    this.__min = _params.min;\n    this.__max = _params.max;\n    this.__step = _params.step;\n\n    if (common.isUndefined(this.__step)) {\n      if (this.initialValue === 0) {\n        this.__impliedStep = 1; // What are we, psychics?\n      } else {\n        // Hey Doug, check this out.\n        this.__impliedStep = Math.pow(10, Math.floor(Math.log(Math.abs(this.initialValue)) / Math.LN10)) / 10;\n      }\n    } else {\n      this.__impliedStep = this.__step;\n    }\n\n    this.__precision = numDecimals(this.__impliedStep);\n  }\n\n  setValue(v) {\n    let _v = v;\n\n    if (this.__min !== undefined && _v < this.__min) {\n      _v = this.__min;\n    } else if (this.__max !== undefined && _v > this.__max) {\n      _v = this.__max;\n    }\n\n    if (this.__step !== undefined && _v % this.__step !== 0) {\n      _v = Math.round(_v / this.__step) * this.__step;\n    }\n\n    return super.setValue(_v);\n  }\n\n  /**\n   * Specify a minimum value for <code>object[property]</code>.\n   *\n   * @param {Number} minValue The minimum value for\n   * <code>object[property]</code>\n   * @returns {dat.controllers.NumberController} this\n   */\n  min(minValue) {\n    this.__min = minValue;\n    return this;\n  }\n\n  /**\n   * Specify a maximum value for <code>object[property]</code>.\n   *\n   * @param {Number} maxValue The maximum value for\n   * <code>object[property]</code>\n   * @returns {dat.controllers.NumberController} this\n   */\n  max(maxValue) {\n    this.__max = maxValue;\n    return this;\n  }\n\n  /**\n   * Specify a step value that dat.controllers.NumberController\n   * increments by.\n   *\n   * @param {Number} stepValue The step value for\n   * dat.controllers.NumberController\n   * @default if minimum and maximum specified increment is 1% of the\n   * difference otherwise stepValue is 1\n   * @returns {dat.controllers.NumberController} this\n   */\n  step(stepValue) {\n    this.__step = stepValue;\n    this.__impliedStep = stepValue;\n    this.__precision = numDecimals(stepValue);\n    return this;\n  }\n}\n\nexport default NumberController;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nimport NumberController from './NumberController';\nimport dom from '../dom/dom';\nimport common from '../utils/common';\n\nfunction roundToDecimal(value, decimals) {\n  const tenTo = Math.pow(10, decimals);\n  return Math.round(value * tenTo) / tenTo;\n}\n\n/**\n * @class Represents a given property of an object that is a number and\n * provides an input element with which to manipulate it.\n *\n * @extends dat.controllers.Controller\n * @extends dat.controllers.NumberController\n *\n * @param {Object} object The object to be manipulated\n * @param {string} property The name of the property to be manipulated\n * @param {Object} [params] Optional parameters\n * @param {Number} [params.min] Minimum allowed value\n * @param {Number} [params.max] Maximum allowed value\n * @param {Number} [params.step] Increment by which to change value\n */\nclass NumberControllerBox extends NumberController {\n  constructor(object, property, params) {\n    super(object, property, params);\n\n    this.__truncationSuspended = false;\n\n    const _this = this;\n\n    /**\n     * {Number} Previous mouse y position\n     * @ignore\n     */\n    let prevY;\n\n    function onChange() {\n      const attempted = parseFloat(_this.__input.value);\n      if (!common.isNaN(attempted)) {\n        _this.setValue(attempted);\n      }\n    }\n\n    function onFinish() {\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    function onBlur() {\n      onFinish();\n    }\n\n    function onMouseDrag(e) {\n      const diff = prevY - e.clientY;\n      _this.setValue(_this.getValue() + diff * _this.__impliedStep);\n\n      prevY = e.clientY;\n    }\n\n    function onMouseUp() {\n      dom.unbind(window, 'mousemove', onMouseDrag);\n      dom.unbind(window, 'mouseup', onMouseUp);\n      onFinish();\n    }\n\n    function onMouseDown(e) {\n      dom.bind(window, 'mousemove', onMouseDrag);\n      dom.bind(window, 'mouseup', onMouseUp);\n      prevY = e.clientY;\n    }\n\n    this.__input = document.createElement('input');\n    this.__input.setAttribute('type', 'text');\n\n    // Makes it so manually specified values are not truncated.\n\n    dom.bind(this.__input, 'change', onChange);\n    dom.bind(this.__input, 'blur', onBlur);\n    dom.bind(this.__input, 'mousedown', onMouseDown);\n    dom.bind(this.__input, 'keydown', function(e) {\n      // When pressing enter, you can be as precise as you want.\n      if (e.keyCode === 13) {\n        _this.__truncationSuspended = true;\n        this.blur();\n        _this.__truncationSuspended = false;\n        onFinish();\n      }\n    });\n\n    this.updateDisplay();\n\n    this.domElement.appendChild(this.__input);\n  }\n\n  updateDisplay() {\n    this.__input.value = this.__truncationSuspended ? this.getValue() : roundToDecimal(this.getValue(), this.__precision);\n    return super.updateDisplay();\n  }\n}\n\nexport default NumberControllerBox;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nimport NumberController from './NumberController';\nimport dom from '../dom/dom';\n\nfunction map(v, i1, i2, o1, o2) {\n  return o1 + (o2 - o1) * ((v - i1) / (i2 - i1));\n}\n\n/**\n * @class Represents a given property of an object that is a number, contains\n * a minimum and maximum, and provides a slider element with which to\n * manipulate it. It should be noted that the slider element is made up of\n * <code>&lt;div&gt;</code> tags, <strong>not</strong> the html5\n * <code>&lt;slider&gt;</code> element.\n *\n * @extends dat.controllers.Controller\n * @extends dat.controllers.NumberController\n *\n * @param {Object} object The object to be manipulated\n * @param {string} property The name of the property to be manipulated\n * @param {Number} minValue Minimum allowed value\n * @param {Number} maxValue Maximum allowed value\n * @param {Number} stepValue Increment by which to change value\n */\nclass NumberControllerSlider extends NumberController {\n  constructor(object, property, min, max, step) {\n    super(object, property, { min: min, max: max, step: step });\n\n    const _this = this;\n\n    this.__background = document.createElement('div');\n    this.__foreground = document.createElement('div');\n\n    dom.bind(this.__background, 'mousedown', onMouseDown);\n    dom.bind(this.__background, 'touchstart', onTouchStart);\n\n    dom.addClass(this.__background, 'slider');\n    dom.addClass(this.__foreground, 'slider-fg');\n\n    function onMouseDown(e) {\n      document.activeElement.blur();\n\n      dom.bind(window, 'mousemove', onMouseDrag);\n      dom.bind(window, 'mouseup', onMouseUp);\n\n      onMouseDrag(e);\n    }\n\n    function onMouseDrag(e) {\n      e.preventDefault();\n\n      const bgRect = _this.__background.getBoundingClientRect();\n\n      _this.setValue(\n        map(e.clientX, bgRect.left, bgRect.right, _this.__min, _this.__max)\n      );\n\n      return false;\n    }\n\n    function onMouseUp() {\n      dom.unbind(window, 'mousemove', onMouseDrag);\n      dom.unbind(window, 'mouseup', onMouseUp);\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    function onTouchStart(e) {\n      if (e.touches.length !== 1) { return; }\n      dom.bind(window, 'touchmove', onTouchMove);\n      dom.bind(window, 'touchend', onTouchEnd);\n      onTouchMove(e);\n    }\n\n    function onTouchMove(e) {\n      const clientX = e.touches[0].clientX;\n      const bgRect = _this.__background.getBoundingClientRect();\n\n      _this.setValue(\n        map(clientX, bgRect.left, bgRect.right, _this.__min, _this.__max)\n      );\n    }\n\n    function onTouchEnd() {\n      dom.unbind(window, 'touchmove', onTouchMove);\n      dom.unbind(window, 'touchend', onTouchEnd);\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    this.updateDisplay();\n\n    this.__background.appendChild(this.__foreground);\n    this.domElement.appendChild(this.__background);\n  }\n\n  updateDisplay() {\n    const pct = (this.getValue() - this.__min) / (this.__max - this.__min);\n    this.__foreground.style.width = pct * 100 + '%';\n    return super.updateDisplay();\n  }\n}\n\nexport default NumberControllerSlider;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nimport Controller from './Controller';\nimport dom from '../dom/dom';\n\n/**\n * @class Provides a GUI interface to fire a specified method, a property of an object.\n *\n * @extends dat.controllers.Controller\n *\n * @param {Object} object The object to be manipulated\n * @param {string} property The name of the property to be manipulated\n */\nclass FunctionController extends Controller {\n  constructor(object, property, text) {\n    super(object, property);\n\n    const _this = this;\n\n    this.__button = document.createElement('div');\n    this.__button.innerHTML = text === undefined ? 'Fire' : text;\n\n    dom.bind(this.__button, 'click', function(e) {\n      e.preventDefault();\n      _this.fire();\n      return false;\n    });\n\n    dom.addClass(this.__button, 'button');\n\n    this.domElement.appendChild(this.__button);\n  }\n\n  fire() {\n    if (this.__onChange) {\n      this.__onChange.call(this);\n    }\n    this.getValue().call(this.object);\n    if (this.__onFinishChange) {\n      this.__onFinishChange.call(this, this.getValue());\n    }\n  }\n}\n\nexport default FunctionController;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nimport Controller from './Controller';\nimport dom from '../dom/dom';\nimport Color from '../color/Color';\nimport interpret from '../color/interpret';\nimport common from '../utils/common';\n\n/**\n * @class Represents a given property of an object that is a color.\n * @param {Object} object\n * @param {string} property\n */\nclass ColorController extends Controller {\n  constructor(object, property) {\n    super(object, property);\n\n    this.__color = new Color(this.getValue());\n    this.__temp = new Color(0);\n\n    const _this = this;\n\n    this.domElement = document.createElement('div');\n\n    dom.makeSelectable(this.domElement, false);\n\n    this.__selector = document.createElement('div');\n    this.__selector.className = 'selector';\n\n    this.__saturation_field = document.createElement('div');\n    this.__saturation_field.className = 'saturation-field';\n\n    this.__field_knob = document.createElement('div');\n    this.__field_knob.className = 'field-knob';\n    this.__field_knob_border = '2px solid ';\n\n    this.__hue_knob = document.createElement('div');\n    this.__hue_knob.className = 'hue-knob';\n\n    this.__hue_field = document.createElement('div');\n    this.__hue_field.className = 'hue-field';\n\n    this.__input = document.createElement('input');\n    this.__input.type = 'text';\n    this.__input_textShadow = '0 1px 1px ';\n\n    dom.bind(this.__input, 'keydown', function(e) {\n      if (e.keyCode === 13) { // on enter\n        onBlur.call(this);\n      }\n    });\n\n    dom.bind(this.__input, 'blur', onBlur);\n\n    dom.bind(this.__selector, 'mousedown', function(/* e */) {\n      dom\n        .addClass(this, 'drag')\n        .bind(window, 'mouseup', function(/* e */) {\n          dom.removeClass(_this.__selector, 'drag');\n        });\n    });\n\n    dom.bind(this.__selector, 'touchstart', function(/* e */) {\n      dom\n        .addClass(this, 'drag')\n        .bind(window, 'touchend', function(/* e */) {\n          dom.removeClass(_this.__selector, 'drag');\n        });\n    });\n\n    const valueField = document.createElement('div');\n\n    common.extend(this.__selector.style, {\n      width: '122px',\n      height: '102px',\n      padding: '3px',\n      backgroundColor: '#222',\n      boxShadow: '0px 1px 3px rgba(0,0,0,0.3)'\n    });\n\n    common.extend(this.__field_knob.style, {\n      position: 'absolute',\n      width: '12px',\n      height: '12px',\n      border: this.__field_knob_border + (this.__color.v < 0.5 ? '#fff' : '#000'),\n      boxShadow: '0px 1px 3px rgba(0,0,0,0.5)',\n      borderRadius: '12px',\n      zIndex: 1\n    });\n\n    common.extend(this.__hue_knob.style, {\n      position: 'absolute',\n      width: '15px',\n      height: '2px',\n      borderRight: '4px solid #fff',\n      zIndex: 1\n    });\n\n    common.extend(this.__saturation_field.style, {\n      width: '100px',\n      height: '100px',\n      border: '1px solid #555',\n      marginRight: '3px',\n      display: 'inline-block',\n      cursor: 'pointer'\n    });\n\n    common.extend(valueField.style, {\n      width: '100%',\n      height: '100%',\n      background: 'none'\n    });\n\n    linearGradient(valueField, 'top', 'rgba(0,0,0,0)', '#000');\n\n    common.extend(this.__hue_field.style, {\n      width: '15px',\n      height: '100px',\n      border: '1px solid #555',\n      cursor: 'ns-resize',\n      position: 'absolute',\n      top: '3px',\n      right: '3px'\n    });\n\n    hueGradient(this.__hue_field);\n\n    common.extend(this.__input.style, {\n      outline: 'none',\n      //      width: '120px',\n      textAlign: 'center',\n      //      padding: '4px',\n      //      marginBottom: '6px',\n      color: '#fff',\n      border: 0,\n      fontWeight: 'bold',\n      textShadow: this.__input_textShadow + 'rgba(0,0,0,0.7)'\n    });\n\n    dom.bind(this.__saturation_field, 'mousedown', fieldDown);\n    dom.bind(this.__saturation_field, 'touchstart', fieldDown);\n\n    dom.bind(this.__field_knob, 'mousedown', fieldDown);\n    dom.bind(this.__field_knob, 'touchstart', fieldDown);\n\n    dom.bind(this.__hue_field, 'mousedown', fieldDownH);\n    dom.bind(this.__hue_field, 'touchstart', fieldDownH);\n\n    function fieldDown(e) {\n      setSV(e);\n      dom.bind(window, 'mousemove', setSV);\n      dom.bind(window, 'touchmove', setSV);\n      dom.bind(window, 'mouseup', fieldUpSV);\n      dom.bind(window, 'touchend', fieldUpSV);\n    }\n\n    function fieldDownH(e) {\n      setH(e);\n      dom.bind(window, 'mousemove', setH);\n      dom.bind(window, 'touchmove', setH);\n      dom.bind(window, 'mouseup', fieldUpH);\n      dom.bind(window, 'touchend', fieldUpH);\n    }\n\n    function fieldUpSV() {\n      dom.unbind(window, 'mousemove', setSV);\n      dom.unbind(window, 'touchmove', setSV);\n      dom.unbind(window, 'mouseup', fieldUpSV);\n      dom.unbind(window, 'touchend', fieldUpSV);\n      onFinish();\n    }\n\n    function fieldUpH() {\n      dom.unbind(window, 'mousemove', setH);\n      dom.unbind(window, 'touchmove', setH);\n      dom.unbind(window, 'mouseup', fieldUpH);\n      dom.unbind(window, 'touchend', fieldUpH);\n      onFinish();\n    }\n\n    function onBlur() {\n      const i = interpret(this.value);\n      if (i !== false) {\n        _this.__color.__state = i;\n        _this.setValue(_this.__color.toOriginal());\n      } else {\n        this.value = _this.__color.toString();\n      }\n    }\n\n    function onFinish() {\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.__color.toOriginal());\n      }\n    }\n\n    this.__saturation_field.appendChild(valueField);\n    this.__selector.appendChild(this.__field_knob);\n    this.__selector.appendChild(this.__saturation_field);\n    this.__selector.appendChild(this.__hue_field);\n    this.__hue_field.appendChild(this.__hue_knob);\n\n    this.domElement.appendChild(this.__input);\n    this.domElement.appendChild(this.__selector);\n\n    this.updateDisplay();\n\n    function setSV(e) {\n      if (e.type.indexOf('touch') === -1) { e.preventDefault(); }\n\n      const fieldRect = _this.__saturation_field.getBoundingClientRect();\n      const { clientX, clientY } = (e.touches && e.touches[0]) || e;\n      let s = (clientX - fieldRect.left) / (fieldRect.right - fieldRect.left);\n      let v = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\n\n      if (v > 1) {\n        v = 1;\n      } else if (v < 0) {\n        v = 0;\n      }\n\n      if (s > 1) {\n        s = 1;\n      } else if (s < 0) {\n        s = 0;\n      }\n\n      _this.__color.v = v;\n      _this.__color.s = s;\n\n      _this.setValue(_this.__color.toOriginal());\n\n\n      return false;\n    }\n\n    function setH(e) {\n      if (e.type.indexOf('touch') === -1) { e.preventDefault(); }\n\n      const fieldRect = _this.__hue_field.getBoundingClientRect();\n      const { clientY } = (e.touches && e.touches[0]) || e;\n      let h = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\n\n      if (h > 1) {\n        h = 1;\n      } else if (h < 0) {\n        h = 0;\n      }\n\n      _this.__color.h = h * 360;\n\n      _this.setValue(_this.__color.toOriginal());\n\n      return false;\n    }\n  }\n\n  updateDisplay() {\n    const i = interpret(this.getValue());\n\n    if (i !== false) {\n      let mismatch = false;\n\n      // Check for mismatch on the interpreted value.\n\n      common.each(Color.COMPONENTS, function(component) {\n        if (!common.isUndefined(i[component]) && !common.isUndefined(this.__color.__state[component]) &&\n          i[component] !== this.__color.__state[component]) {\n          mismatch = true;\n          return {}; // break\n        }\n      }, this);\n\n      // If nothing diverges, we keep our previous values\n      // for statefulness, otherwise we recalculate fresh\n      if (mismatch) {\n        common.extend(this.__color.__state, i);\n      }\n    }\n\n    common.extend(this.__temp.__state, this.__color.__state);\n\n    this.__temp.a = 1;\n\n    const flip = (this.__color.v < 0.5 || this.__color.s > 0.5) ? 255 : 0;\n    const _flip = 255 - flip;\n\n    common.extend(this.__field_knob.style, {\n      marginLeft: 100 * this.__color.s - 7 + 'px',\n      marginTop: 100 * (1 - this.__color.v) - 7 + 'px',\n      backgroundColor: this.__temp.toHexString(),\n      border: this.__field_knob_border + 'rgb(' + flip + ',' + flip + ',' + flip + ')'\n    });\n\n    this.__hue_knob.style.marginTop = (1 - this.__color.h / 360) * 100 + 'px';\n\n    this.__temp.s = 1;\n    this.__temp.v = 1;\n\n    linearGradient(this.__saturation_field, 'left', '#fff', this.__temp.toHexString());\n\n    this.__input.value = this.__color.toString();\n\n    common.extend(this.__input.style, {\n      backgroundColor: this.__color.toHexString(),\n      color: 'rgb(' + flip + ',' + flip + ',' + flip + ')',\n      textShadow: this.__input_textShadow + 'rgba(' + _flip + ',' + _flip + ',' + _flip + ',.7)'\n    });\n  }\n}\n\nconst vendors = ['-moz-', '-o-', '-webkit-', '-ms-', ''];\n\nfunction linearGradient(elem, x, a, b) {\n  elem.style.background = '';\n  common.each(vendors, function(vendor) {\n    elem.style.cssText += 'background: ' + vendor + 'linear-gradient(' + x + ', ' + a + ' 0%, ' + b + ' 100%); ';\n  });\n}\n\nfunction hueGradient(elem) {\n  elem.style.background = '';\n  elem.style.cssText += 'background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);';\n  elem.style.cssText += 'background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n  elem.style.cssText += 'background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n  elem.style.cssText += 'background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n  elem.style.cssText += 'background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n}\n\nexport default ColorController;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nconst css = {\n  load: function(url, indoc) {\n    const doc = indoc || document;\n    const link = doc.createElement('link');\n    link.type = 'text/css';\n    link.rel = 'stylesheet';\n    link.href = url;\n    doc.getElementsByTagName('head')[0].appendChild(link);\n  },\n\n  inject: function(cssContent, indoc) {\n    const doc = indoc || document;\n    const injected = document.createElement('style');\n    injected.type = 'text/css';\n    injected.innerHTML = cssContent;\n    const head = doc.getElementsByTagName('head')[0];\n    try {\n      head.appendChild(injected);\n    } catch (e) { // Unable to inject CSS, probably because of a Content Security Policy\n    }\n  }\n};\n\nexport default css;\n", "const saveDialogContents = `<div id=\"dg-save\" class=\"dg dialogue\">\n\n  Here's the new load parameter for your <code>GUI</code>'s constructor:\n\n  <textarea id=\"dg-new-constructor\"></textarea>\n\n  <div id=\"dg-save-locally\">\n\n    <input id=\"dg-local-storage\" type=\"checkbox\"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id=\"dg-local-explain\">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>`;\n\nexport default saveDialogContents;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nimport OptionController from './OptionController';\nimport NumberControllerBox from './NumberControllerBox';\nimport NumberControllerSlider from './NumberControllerSlider';\nimport StringController from './StringController';\nimport FunctionController from './FunctionController';\nimport BooleanController from './BooleanController';\nimport common from '../utils/common';\n\nconst ControllerFactory = function(object, property) {\n  const initialValue = object[property];\n\n  // Providing options?\n  if (common.isArray(arguments[2]) || common.isObject(arguments[2])) {\n    return new OptionController(object, property, arguments[2]);\n  }\n\n  // Providing a map?\n  if (common.isNumber(initialValue)) {\n    // Has min and max? (slider)\n    if (common.isNumber(arguments[2]) && common.isNumber(arguments[3])) {\n      // has step?\n      if (common.isNumber(arguments[4])) {\n        return new NumberControllerSlider(object, property,\n          arguments[2], arguments[3], arguments[4]);\n      }\n\n      return new NumberControllerSlider(object, property, arguments[2], arguments[3]);\n    }\n\n    // number box\n    if (common.isNumber(arguments[4])) { // has step\n      return new NumberControllerBox(object, property,\n        { min: arguments[2], max: arguments[3], step: arguments[4] });\n    }\n    return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3] });\n  }\n\n  if (common.isString(initialValue)) {\n    return new StringController(object, property);\n  }\n\n  if (common.isFunction(initialValue)) {\n    return new FunctionController(object, property, '');\n  }\n\n  if (common.isBoolean(initialValue)) {\n    return new BooleanController(object, property);\n  }\n\n  return null;\n};\n\nexport default ControllerFactory;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nfunction requestAnimationFrame(callback) {\n  setTimeout(callback, 1000 / 60);\n}\n\nexport default window.requestAnimationFrame ||\n    window.webkitRequestAnimationFrame ||\n    window.mozRequestAnimationFrame ||\n    window.oRequestAnimationFrame ||\n    window.msRequestAnimationFrame ||\n    requestAnimationFrame;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nimport dom from './dom';\nimport common from '../utils/common';\n\nclass CenteredDiv {\n  constructor() {\n    this.backgroundElement = document.createElement('div');\n    common.extend(this.backgroundElement.style, {\n      backgroundColor: 'rgba(0,0,0,0.8)',\n      top: 0,\n      left: 0,\n      display: 'none',\n      zIndex: '1000',\n      opacity: 0,\n      WebkitTransition: 'opacity 0.2s linear',\n      transition: 'opacity 0.2s linear'\n    });\n\n    dom.makeFullscreen(this.backgroundElement);\n    this.backgroundElement.style.position = 'fixed';\n\n    this.domElement = document.createElement('div');\n    common.extend(this.domElement.style, {\n      position: 'fixed',\n      display: 'none',\n      zIndex: '1001',\n      opacity: 0,\n      WebkitTransition: '-webkit-transform 0.2s ease-out, opacity 0.2s linear',\n      transition: 'transform 0.2s ease-out, opacity 0.2s linear'\n    });\n\n\n    document.body.appendChild(this.backgroundElement);\n    document.body.appendChild(this.domElement);\n\n    const _this = this;\n    dom.bind(this.backgroundElement, 'click', function() {\n      _this.hide();\n    });\n  }\n\n  show() {\n    const _this = this;\n\n    this.backgroundElement.style.display = 'block';\n\n    this.domElement.style.display = 'block';\n    this.domElement.style.opacity = 0;\n    //    this.domElement.style.top = '52%';\n    this.domElement.style.webkitTransform = 'scale(1.1)';\n\n    this.layout();\n\n    common.defer(function() {\n      _this.backgroundElement.style.opacity = 1;\n      _this.domElement.style.opacity = 1;\n      _this.domElement.style.webkitTransform = 'scale(1)';\n    });\n  }\n\n  /**\n   * Hide centered div\n   */\n  hide() {\n    const _this = this;\n\n    const hide = function() {\n      _this.domElement.style.display = 'none';\n      _this.backgroundElement.style.display = 'none';\n\n      dom.unbind(_this.domElement, 'webkitTransitionEnd', hide);\n      dom.unbind(_this.domElement, 'transitionend', hide);\n      dom.unbind(_this.domElement, 'oTransitionEnd', hide);\n    };\n\n    dom.bind(this.domElement, 'webkitTransitionEnd', hide);\n    dom.bind(this.domElement, 'transitionend', hide);\n    dom.bind(this.domElement, 'oTransitionEnd', hide);\n\n    this.backgroundElement.style.opacity = 0;\n    //    this.domElement.style.top = '48%';\n    this.domElement.style.opacity = 0;\n    this.domElement.style.webkitTransform = 'scale(1.1)';\n  }\n\n  layout() {\n    this.domElement.style.left = window.innerWidth / 2 - dom.getWidth(this.domElement) / 2 + 'px';\n    this.domElement.style.top = window.innerHeight / 2 - dom.getHeight(this.domElement) / 2 + 'px';\n  }\n}\n\nexport default CenteredDiv;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nimport css from '../utils/css';\nimport saveDialogueContents from './saveDialogue.html';\nimport ControllerFactory from '../controllers/ControllerFactory';\nimport Controller from '../controllers/Controller';\nimport BooleanController from '../controllers/BooleanController';\nimport FunctionController from '../controllers/FunctionController';\nimport NumberControllerBox from '../controllers/NumberControllerBox';\nimport NumberControllerSlider from '../controllers/NumberControllerSlider';\nimport ColorController from '../controllers/ColorController';\nimport requestAnimationFrame from '../utils/requestAnimationFrame';\nimport CenteredDiv from '../dom/CenteredDiv';\nimport dom from '../dom/dom';\nimport common from '../utils/common';\n\nimport styleSheet from './style.scss'; // CSS to embed in build\n\ncss.inject(styleSheet);\n\n/** @ignore Outer-most className for GUI's */\nconst CSS_NAMESPACE = 'dg';\n\nconst HIDE_KEY_CODE = 72;\n\n/** @ignore The only value shared between the JS and SCSS. Use caution. */\nconst CLOSE_BUTTON_HEIGHT = 20;\n\nconst DEFAULT_DEFAULT_PRESET_NAME = 'Default';\n\nconst SUPPORTS_LOCAL_STORAGE = (function() {\n  try {\n    return !!window.localStorage;\n  } catch (e) {\n    return false;\n  }\n}());\n\nlet SAVE_DIALOGUE;\n\n/** @ignore Have we yet to create an autoPlace GUI? */\nlet autoPlaceVirgin = true;\n\n/** @ignore Fixed position div that auto place GUI's go inside */\nlet autoPlaceContainer;\n\n/** @ignore Are we hiding the GUI's ? */\nlet hide = false;\n\n/** @private GUI's which should be hidden */\nconst hideableGuis = [];\n\n/**\n * @class A lightweight controller library for JavaScript. It allows you to easily\n * manipulate variables and fire functions on the fly.\n *\n * @typicalname gui\n *\n * @example\n * // Creating a GUI with options.\n * var gui = new dat.GUI({name: 'My GUI'});\n *\n * @example\n * // Creating a GUI and a subfolder.\n * var gui = new dat.GUI();\n * var folder1 = gui.addFolder('Flow Field');\n *\n * @param {Object} [params]\n * @param {String} [params.name] The name of this GUI.\n * @param {Object} [params.load] JSON object representing the saved state of\n * this GUI.\n * @param {dat.gui.GUI} [params.parent] The GUI I'm nested in.\n * @param {Boolean} [params.autoPlace=true]\n * @param {Boolean} [params.hideable=true] If true, GUI is shown/hidden by <kbd>h</kbd> keypress.\n * @param {Boolean} [params.closed=false] If true, starts closed\n * @param {Boolean} [params.closeOnTop=false] If true, close/open button shows on top of the GUI\n */\nconst GUI = function(pars) {\n  const _this = this;\n\n  let params = pars || {};\n\n  /**\n   * Outermost DOM Element\n   * @type {DOMElement}\n   */\n  this.domElement = document.createElement('div');\n  this.__ul = document.createElement('ul');\n  this.domElement.appendChild(this.__ul);\n\n  dom.addClass(this.domElement, CSS_NAMESPACE);\n\n  /**\n   * Nested GUI's by name\n   * @ignore\n   */\n  this.__folders = {};\n\n  this.__controllers = [];\n\n  /**\n   * List of objects I'm remembering for save, only used in top level GUI\n   * @ignore\n   */\n  this.__rememberedObjects = [];\n\n  /**\n   * Maps the index of remembered objects to a map of controllers, only used\n   * in top level GUI.\n   *\n   * @private\n   * @ignore\n   *\n   * @example\n   * [\n   *  {\n     *    propertyName: Controller,\n     *    anotherPropertyName: Controller\n     *  },\n   *  {\n     *    propertyName: Controller\n     *  }\n   * ]\n   */\n  this.__rememberedObjectIndecesToControllers = [];\n\n  this.__listening = [];\n\n  // Default parameters\n  params = common.defaults(params, {\n    closeOnTop: false,\n    autoPlace: true,\n    width: GUI.DEFAULT_WIDTH\n  });\n\n  params = common.defaults(params, {\n    resizable: params.autoPlace,\n    hideable: params.autoPlace\n  });\n\n  if (!common.isUndefined(params.load)) {\n    // Explicit preset\n    if (params.preset) {\n      params.load.preset = params.preset;\n    }\n  } else {\n    params.load = { preset: DEFAULT_DEFAULT_PRESET_NAME };\n  }\n\n  if (common.isUndefined(params.parent) && params.hideable) {\n    hideableGuis.push(this);\n  }\n\n  // Only root level GUI's are resizable.\n  params.resizable = common.isUndefined(params.parent) && params.resizable;\n\n  if (params.autoPlace && common.isUndefined(params.scrollable)) {\n    params.scrollable = true;\n  }\n  //    params.scrollable = common.isUndefined(params.parent) && params.scrollable === true;\n\n  // Not part of params because I don't want people passing this in via\n  // constructor. Should be a 'remembered' value.\n  let useLocalStorage =\n    SUPPORTS_LOCAL_STORAGE &&\n    localStorage.getItem(getLocalStorageHash(this, 'isLocal')) === 'true';\n\n  let saveToLocalStorage;\n  let titleRow;\n\n  Object.defineProperties(this,\n    /** @lends GUI.prototype */\n    {\n      /**\n       * The parent <code>GUI</code>\n       * @type dat.gui.GUI\n       */\n      parent: {\n        get: function() {\n          return params.parent;\n        }\n      },\n\n      scrollable: {\n        get: function() {\n          return params.scrollable;\n        }\n      },\n\n      /**\n       * Handles <code>GUI</code>'s element placement for you\n       * @type Boolean\n       */\n      autoPlace: {\n        get: function() {\n          return params.autoPlace;\n        }\n      },\n\n      /**\n       * Handles <code>GUI</code>'s position of open/close button\n       * @type Boolean\n       */\n      closeOnTop: {\n        get: function() {\n          return params.closeOnTop;\n        }\n      },\n\n      /**\n       * The identifier for a set of saved values\n       * @type String\n       */\n      preset: {\n        get: function() {\n          if (_this.parent) {\n            return _this.getRoot().preset;\n          }\n\n          return params.load.preset;\n        },\n\n        set: function(v) {\n          if (_this.parent) {\n            _this.getRoot().preset = v;\n          } else {\n            params.load.preset = v;\n          }\n          setPresetSelectIndex(this);\n          _this.revert();\n        }\n      },\n\n      /**\n       * The width of <code>GUI</code> element\n       * @type Number\n       */\n      width: {\n        get: function() {\n          return params.width;\n        },\n        set: function(v) {\n          params.width = v;\n          setWidth(_this, v);\n        }\n      },\n\n      /**\n       * The name of <code>GUI</code>. Used for folders. i.e\n       * a folder's name\n       * @type String\n       */\n      name: {\n        get: function() {\n          return params.name;\n        },\n        set: function(v) {\n          // TODO Check for collisions among sibling folders\n          params.name = v;\n          if (titleRow) {\n            titleRow.innerHTML = params.name;\n          }\n        }\n      },\n\n      /**\n       * Whether the <code>GUI</code> is collapsed or not\n       * @type Boolean\n       */\n      closed: {\n        get: function() {\n          return params.closed;\n        },\n        set: function(v) {\n          params.closed = v;\n          if (params.closed) {\n            dom.addClass(_this.__ul, GUI.CLASS_CLOSED);\n          } else {\n            dom.removeClass(_this.__ul, GUI.CLASS_CLOSED);\n          }\n          // For browsers that aren't going to respect the CSS transition,\n          // Lets just check our height against the window height right off\n          // the bat.\n          this.onResize();\n\n          if (_this.__closeButton) {\n            _this.__closeButton.innerHTML = v ? GUI.TEXT_OPEN : GUI.TEXT_CLOSED;\n          }\n        }\n      },\n\n      /**\n       * Contains all presets\n       * @type Object\n       */\n      load: {\n        get: function() {\n          return params.load;\n        }\n      },\n\n      /**\n       * Determines whether or not to use <a href=\"https://developer.mozilla.org/en/DOM/Storage#localStorage\">localStorage</a> as the means for\n       * <code>remember</code>ing\n       * @type Boolean\n       */\n      useLocalStorage: {\n\n        get: function() {\n          return useLocalStorage;\n        },\n        set: function(bool) {\n          if (SUPPORTS_LOCAL_STORAGE) {\n            useLocalStorage = bool;\n            if (bool) {\n              dom.bind(window, 'unload', saveToLocalStorage);\n            } else {\n              dom.unbind(window, 'unload', saveToLocalStorage);\n            }\n            localStorage.setItem(getLocalStorageHash(_this, 'isLocal'), bool);\n          }\n        }\n      }\n    });\n\n  // Are we a root level GUI?\n  if (common.isUndefined(params.parent)) {\n    this.closed = params.closed || false;\n\n    dom.addClass(this.domElement, GUI.CLASS_MAIN);\n    dom.makeSelectable(this.domElement, false);\n\n    // Are we supposed to be loading locally?\n    if (SUPPORTS_LOCAL_STORAGE) {\n      if (useLocalStorage) {\n        _this.useLocalStorage = true;\n\n        const savedGui = localStorage.getItem(getLocalStorageHash(this, 'gui'));\n\n        if (savedGui) {\n          params.load = JSON.parse(savedGui);\n        }\n      }\n    }\n\n    this.__closeButton = document.createElement('div');\n    this.__closeButton.innerHTML = GUI.TEXT_CLOSED;\n    dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BUTTON);\n    if (params.closeOnTop) {\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_TOP);\n      this.domElement.insertBefore(this.__closeButton, this.domElement.childNodes[0]);\n    } else {\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BOTTOM);\n      this.domElement.appendChild(this.__closeButton);\n    }\n\n    dom.bind(this.__closeButton, 'click', function() {\n      _this.closed = !_this.closed;\n    });\n    // Oh, you're a nested GUI!\n  } else {\n    if (params.closed === undefined) {\n      params.closed = true;\n    }\n\n    const titleRowName = document.createTextNode(params.name);\n    dom.addClass(titleRowName, 'controller-name');\n\n    titleRow = addRow(_this, titleRowName);\n\n    const onClickTitle = function(e) {\n      e.preventDefault();\n      _this.closed = !_this.closed;\n      return false;\n    };\n\n    dom.addClass(this.__ul, GUI.CLASS_CLOSED);\n\n    dom.addClass(titleRow, 'title');\n    dom.bind(titleRow, 'click', onClickTitle);\n\n    if (!params.closed) {\n      this.closed = false;\n    }\n  }\n\n  if (params.autoPlace) {\n    if (common.isUndefined(params.parent)) {\n      if (autoPlaceVirgin) {\n        autoPlaceContainer = document.createElement('div');\n        dom.addClass(autoPlaceContainer, CSS_NAMESPACE);\n        dom.addClass(autoPlaceContainer, GUI.CLASS_AUTO_PLACE_CONTAINER);\n        document.body.appendChild(autoPlaceContainer);\n        autoPlaceVirgin = false;\n      }\n\n      // Put it in the dom for you.\n      autoPlaceContainer.appendChild(this.domElement);\n\n      // Apply the auto styles\n      dom.addClass(this.domElement, GUI.CLASS_AUTO_PLACE);\n    }\n\n\n    // Make it not elastic.\n    if (!this.parent) {\n      setWidth(_this, params.width);\n    }\n  }\n\n  this.__resizeHandler = function() {\n    _this.onResizeDebounced();\n  };\n\n  dom.bind(window, 'resize', this.__resizeHandler);\n  dom.bind(this.__ul, 'webkitTransitionEnd', this.__resizeHandler);\n  dom.bind(this.__ul, 'transitionend', this.__resizeHandler);\n  dom.bind(this.__ul, 'oTransitionEnd', this.__resizeHandler);\n  this.onResize();\n\n  if (params.resizable) {\n    addResizeHandle(this);\n  }\n\n  saveToLocalStorage = function() {\n    if (SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(_this, 'isLocal')) === 'true') {\n      localStorage.setItem(getLocalStorageHash(_this, 'gui'), JSON.stringify(_this.getSaveObject()));\n    }\n  };\n\n  // expose this method publicly\n  this.saveToLocalStorageIfPossible = saveToLocalStorage;\n\n  function resetWidth() {\n    const root = _this.getRoot();\n    root.width += 1;\n    common.defer(function() {\n      root.width -= 1;\n    });\n  }\n\n  if (!params.parent) {\n    resetWidth();\n  }\n};\n\nGUI.toggleHide = function() {\n  hide = !hide;\n  common.each(hideableGuis, function(gui) {\n    gui.domElement.style.display = hide ? 'none' : '';\n  });\n};\n\nGUI.CLASS_AUTO_PLACE = 'a';\nGUI.CLASS_AUTO_PLACE_CONTAINER = 'ac';\nGUI.CLASS_MAIN = 'main';\nGUI.CLASS_CONTROLLER_ROW = 'cr';\nGUI.CLASS_TOO_TALL = 'taller-than-window';\nGUI.CLASS_CLOSED = 'closed';\nGUI.CLASS_CLOSE_BUTTON = 'close-button';\nGUI.CLASS_CLOSE_TOP = 'close-top';\nGUI.CLASS_CLOSE_BOTTOM = 'close-bottom';\nGUI.CLASS_DRAG = 'drag';\n\nGUI.DEFAULT_WIDTH = 245;\nGUI.TEXT_CLOSED = 'Close Controls';\nGUI.TEXT_OPEN = 'Open Controls';\n\nGUI._keydownHandler = function(e) {\n  if (document.activeElement.type !== 'text' &&\n    (e.which === HIDE_KEY_CODE || e.keyCode === HIDE_KEY_CODE)) {\n    GUI.toggleHide();\n  }\n};\ndom.bind(window, 'keydown', GUI._keydownHandler, false);\n\ncommon.extend(\n  GUI.prototype,\n\n  /** @lends GUI.prototype */\n  {\n\n    /**\n     * Adds a new {@link Controller} to the GUI. The type of controller created\n     * is inferred from the initial value of <code>object[property]</code>. For\n     * color properties, see {@link addColor}.\n     *\n     * @param {Object} object The object to be manipulated\n     * @param {String} property The name of the property to be manipulated\n     * @param {Number} [min] Minimum allowed value\n     * @param {Number} [max] Maximum allowed value\n     * @param {Number} [step] Increment by which to change value\n     * @returns {Controller} The controller that was added to the GUI.\n     * @instance\n     *\n     * @example\n     * // Add a string controller.\n     * var person = {name: 'Sam'};\n     * gui.add(person, 'name');\n     *\n     * @example\n     * // Add a number controller slider.\n     * var person = {age: 45};\n     * gui.add(person, 'age', 0, 100);\n     */\n    add: function(object, property) {\n      return add(\n        this,\n        object,\n        property,\n        {\n          factoryArgs: Array.prototype.slice.call(arguments, 2)\n        }\n      );\n    },\n\n    /**\n     * Adds a new color controller to the GUI.\n     *\n     * @param object\n     * @param property\n     * @returns {Controller} The controller that was added to the GUI.\n     * @instance\n     *\n     * @example\n     * var palette = {\n     *   color1: '#FF0000', // CSS string\n     *   color2: [ 0, 128, 255 ], // RGB array\n     *   color3: [ 0, 128, 255, 0.3 ], // RGB with alpha\n     *   color4: { h: 350, s: 0.9, v: 0.3 } // Hue, saturation, value\n     * };\n     * gui.addColor(palette, 'color1');\n     * gui.addColor(palette, 'color2');\n     * gui.addColor(palette, 'color3');\n     * gui.addColor(palette, 'color4');\n     */\n    addColor: function(object, property) {\n      return add(\n        this,\n        object,\n        property,\n        {\n          color: true\n        }\n      );\n    },\n\n    /**\n     * Removes the given controller from the GUI.\n     * @param {Controller} controller\n     * @instance\n     */\n    remove: function(controller) {\n      // TODO listening?\n      this.__ul.removeChild(controller.__li);\n      this.__controllers.splice(this.__controllers.indexOf(controller), 1);\n      const _this = this;\n      common.defer(function() {\n        _this.onResize();\n      });\n    },\n\n    /**\n     * Removes the root GUI from the document and unbinds all event listeners.\n     * For subfolders, use `gui.removeFolder(folder)` instead.\n     * @instance\n     */\n    destroy: function() {\n      if (this.parent) {\n        throw new Error(\n          'Only the root GUI should be removed with .destroy(). ' +\n          'For subfolders, use gui.removeFolder(folder) instead.'\n        );\n      }\n\n      if (this.autoPlace) {\n        autoPlaceContainer.removeChild(this.domElement);\n      }\n\n      const _this = this;\n      common.each(this.__folders, function(subfolder) {\n        _this.removeFolder(subfolder);\n      });\n\n      dom.unbind(window, 'keydown', GUI._keydownHandler, false);\n\n      removeListeners(this);\n    },\n\n    /**\n     * Creates a new subfolder GUI instance.\n     * @param name\n     * @returns {dat.gui.GUI} The new folder.\n     * @throws {Error} if this GUI already has a folder by the specified\n     * name\n     * @instance\n     */\n    addFolder: function(name) {\n      // We have to prevent collisions on names in order to have a key\n      // by which to remember saved values\n      if (this.__folders[name] !== undefined) {\n        throw new Error('You already have a folder in this GUI by the' +\n          ' name \"' + name + '\"');\n      }\n\n      const newGuiParams = { name: name, parent: this };\n\n      // We need to pass down the autoPlace trait so that we can\n      // attach event listeners to open/close folder actions to\n      // ensure that a scrollbar appears if the window is too short.\n      newGuiParams.autoPlace = this.autoPlace;\n\n      // Do we have saved appearance data for this folder?\n      if (this.load && // Anything loaded?\n        this.load.folders && // Was my parent a dead-end?\n        this.load.folders[name]) { // Did daddy remember me?\n        // Start me closed if I was closed\n        newGuiParams.closed = this.load.folders[name].closed;\n\n        // Pass down the loaded data\n        newGuiParams.load = this.load.folders[name];\n      }\n\n      const gui = new GUI(newGuiParams);\n      this.__folders[name] = gui;\n\n      const li = addRow(this, gui.domElement);\n      dom.addClass(li, 'folder');\n      return gui;\n    },\n\n    /**\n     * Removes a subfolder GUI instance.\n     * @param {dat.gui.GUI} folder The folder to remove.\n     * @instance\n     */\n    removeFolder: function(folder) {\n      this.__ul.removeChild(folder.domElement.parentElement);\n\n      delete this.__folders[folder.name];\n\n      // Do we have saved appearance data for this folder?\n      if (this.load && // Anything loaded?\n        this.load.folders && // Was my parent a dead-end?\n        this.load.folders[folder.name]) {\n        delete this.load.folders[folder.name];\n      }\n\n      removeListeners(folder);\n\n      const _this = this;\n\n      common.each(folder.__folders, function(subfolder) {\n        folder.removeFolder(subfolder);\n      });\n\n      common.defer(function() {\n        _this.onResize();\n      });\n    },\n\n    /**\n     * Opens the GUI.\n     */\n    open: function() {\n      this.closed = false;\n    },\n\n    /**\n     * Closes the GUI.\n     */\n    close: function() {\n      this.closed = true;\n    },\n\n    /**\n    * Hides the GUI.\n    */\n    hide: function() {\n      this.domElement.style.display = 'none';\n    },\n\n    /**\n    * Shows the GUI.\n    */\n    show: function() {\n      this.domElement.style.display = '';\n    },\n\n\n    onResize: function() {\n      // we debounce this function to prevent performance issues when rotating on tablet/mobile\n      const root = this.getRoot();\n      if (root.scrollable) {\n        const top = dom.getOffset(root.__ul).top;\n        let h = 0;\n\n        common.each(root.__ul.childNodes, function(node) {\n          if (!(root.autoPlace && node === root.__save_row)) {\n            h += dom.getHeight(node);\n          }\n        });\n\n        if (window.innerHeight - top - CLOSE_BUTTON_HEIGHT < h) {\n          dom.addClass(root.domElement, GUI.CLASS_TOO_TALL);\n          root.__ul.style.height = window.innerHeight - top - CLOSE_BUTTON_HEIGHT + 'px';\n        } else {\n          dom.removeClass(root.domElement, GUI.CLASS_TOO_TALL);\n          root.__ul.style.height = 'auto';\n        }\n      }\n\n      if (root.__resize_handle) {\n        common.defer(function() {\n          root.__resize_handle.style.height = root.__ul.offsetHeight + 'px';\n        });\n      }\n\n      if (root.__closeButton) {\n        root.__closeButton.style.width = root.width + 'px';\n      }\n    },\n\n    onResizeDebounced: common.debounce(function() { this.onResize(); }, 50),\n\n    /**\n     * Mark objects for saving. The order of these objects cannot change as\n     * the GUI grows. When remembering new objects, append them to the end\n     * of the list.\n     *\n     * @param {...Object} objects\n     * @throws {Error} if not called on a top level GUI.\n     * @instance\n     * @ignore\n     */\n    remember: function() {\n      if (common.isUndefined(SAVE_DIALOGUE)) {\n        SAVE_DIALOGUE = new CenteredDiv();\n        SAVE_DIALOGUE.domElement.innerHTML = saveDialogueContents;\n      }\n\n      if (this.parent) {\n        throw new Error('You can only call remember on a top level GUI.');\n      }\n\n      const _this = this;\n\n      common.each(Array.prototype.slice.call(arguments), function(object) {\n        if (_this.__rememberedObjects.length === 0) {\n          addSaveMenu(_this);\n        }\n        if (_this.__rememberedObjects.indexOf(object) === -1) {\n          _this.__rememberedObjects.push(object);\n        }\n      });\n\n      if (this.autoPlace) {\n        // Set save row width\n        setWidth(this, this.width);\n      }\n    },\n\n    /**\n     * @returns {dat.gui.GUI} the topmost parent GUI of a nested GUI.\n     * @instance\n     */\n    getRoot: function() {\n      let gui = this;\n      while (gui.parent) {\n        gui = gui.parent;\n      }\n      return gui;\n    },\n\n    /**\n     * @returns {Object} a JSON object representing the current state of\n     * this GUI as well as its remembered properties.\n     * @instance\n     */\n    getSaveObject: function() {\n      const toReturn = this.load;\n      toReturn.closed = this.closed;\n\n      // Am I remembering any values?\n      if (this.__rememberedObjects.length > 0) {\n        toReturn.preset = this.preset;\n\n        if (!toReturn.remembered) {\n          toReturn.remembered = {};\n        }\n\n        toReturn.remembered[this.preset] = getCurrentPreset(this);\n      }\n\n      toReturn.folders = {};\n      common.each(this.__folders, function(element, key) {\n        toReturn.folders[key] = element.getSaveObject();\n      });\n\n      return toReturn;\n    },\n\n    save: function() {\n      if (!this.load.remembered) {\n        this.load.remembered = {};\n      }\n\n      this.load.remembered[this.preset] = getCurrentPreset(this);\n      markPresetModified(this, false);\n      this.saveToLocalStorageIfPossible();\n    },\n\n    saveAs: function(presetName) {\n      if (!this.load.remembered) {\n        // Retain default values upon first save\n        this.load.remembered = {};\n        this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(this, true);\n      }\n\n      this.load.remembered[presetName] = getCurrentPreset(this);\n      this.preset = presetName;\n      addPresetOption(this, presetName, true);\n      this.saveToLocalStorageIfPossible();\n    },\n\n    revert: function(gui) {\n      common.each(this.__controllers, function(controller) {\n        // Make revert work on Default.\n        if (!this.getRoot().load.remembered) {\n          controller.setValue(controller.initialValue);\n        } else {\n          recallSavedValue(gui || this.getRoot(), controller);\n        }\n\n        // fire onFinishChange callback\n        if (controller.__onFinishChange) {\n          controller.__onFinishChange.call(controller, controller.getValue());\n        }\n      }, this);\n\n      common.each(this.__folders, function(folder) {\n        folder.revert(folder);\n      });\n\n      if (!gui) {\n        markPresetModified(this.getRoot(), false);\n      }\n    },\n\n    listen: function(controller) {\n      const init = this.__listening.length === 0;\n      this.__listening.push(controller);\n      if (init) {\n        updateDisplays(this.__listening);\n      }\n    },\n\n    updateDisplay: function() {\n      common.each(this.__controllers, function(controller) {\n        controller.updateDisplay();\n      });\n      common.each(this.__folders, function(folder) {\n        folder.updateDisplay();\n      });\n    }\n  }\n);\n\n/**\n * Add a row to the end of the GUI or before another row.\n *\n * @param gui\n * @param [newDom] If specified, inserts the dom content in the new row\n * @param [liBefore] If specified, places the new row before another row\n *\n * @ignore\n */\nfunction addRow(gui, newDom, liBefore) {\n  const li = document.createElement('li');\n  if (newDom) {\n    li.appendChild(newDom);\n  }\n\n  if (liBefore) {\n    gui.__ul.insertBefore(li, liBefore);\n  } else {\n    gui.__ul.appendChild(li);\n  }\n  gui.onResize();\n  return li;\n}\n\nfunction removeListeners(gui) {\n  dom.unbind(window, 'resize', gui.__resizeHandler);\n\n  if (gui.saveToLocalStorageIfPossible) {\n    dom.unbind(window, 'unload', gui.saveToLocalStorageIfPossible);\n  }\n}\n\nfunction markPresetModified(gui, modified) {\n  const opt = gui.__preset_select[gui.__preset_select.selectedIndex];\n\n  if (modified) {\n    opt.innerHTML = opt.value + '*';\n  } else {\n    opt.innerHTML = opt.value;\n  }\n}\n\nfunction augmentController(gui, li, controller) {\n  controller.__li = li;\n  controller.__gui = gui;\n\n  common.extend(controller, /** @lends Controller.prototype */ {\n    /**\n     * @param  {Array|Object} options\n     * @return {Controller}\n     */\n    options: function(options) {\n      if (arguments.length > 1) {\n        const nextSibling = controller.__li.nextElementSibling;\n        controller.remove();\n\n        return add(\n          gui,\n          controller.object,\n          controller.property,\n          {\n            before: nextSibling,\n            factoryArgs: [common.toArray(arguments)]\n          }\n        );\n      }\n\n      if (common.isArray(options) || common.isObject(options)) {\n        const nextSibling = controller.__li.nextElementSibling;\n        controller.remove();\n\n        return add(\n          gui,\n          controller.object,\n          controller.property,\n          {\n            before: nextSibling,\n            factoryArgs: [options]\n          }\n        );\n      }\n    },\n\n    /**\n     * Sets the name of the controller.\n     * @param  {string} name\n     * @return {Controller}\n     */\n    name: function(name) {\n      controller.__li.firstElementChild.firstElementChild.innerHTML = name;\n      return controller;\n    },\n\n    /**\n     * Sets controller to listen for changes on its underlying object.\n     * @return {Controller}\n     */\n    listen: function() {\n      controller.__gui.listen(controller);\n      return controller;\n    },\n\n    /**\n     * Removes the controller from its parent GUI.\n     * @return {Controller}\n     */\n    remove: function() {\n      controller.__gui.remove(controller);\n      return controller;\n    }\n  });\n\n  // All sliders should be accompanied by a box.\n  if (controller instanceof NumberControllerSlider) {\n    const box = new NumberControllerBox(controller.object, controller.property,\n      { min: controller.__min, max: controller.__max, step: controller.__step });\n\n    common.each(['updateDisplay', 'onChange', 'onFinishChange', 'step', 'min', 'max'], function(method) {\n      const pc = controller[method];\n      const pb = box[method];\n      controller[method] = box[method] = function() {\n        const args = Array.prototype.slice.call(arguments);\n        pb.apply(box, args);\n        return pc.apply(controller, args);\n      };\n    });\n\n    dom.addClass(li, 'has-slider');\n    controller.domElement.insertBefore(box.domElement, controller.domElement.firstElementChild);\n  } else if (controller instanceof NumberControllerBox) {\n    const r = function(returned) {\n      // Have we defined both boundaries?\n      if (common.isNumber(controller.__min) && common.isNumber(controller.__max)) {\n        // Well, then lets just replace this with a slider.\n\n        // lets remember if the old controller had a specific name or was listening\n        const oldName = controller.__li.firstElementChild.firstElementChild.innerHTML;\n        const wasListening = controller.__gui.__listening.indexOf(controller) > -1;\n\n        controller.remove();\n        const newController = add(\n          gui,\n          controller.object,\n          controller.property,\n          {\n            before: controller.__li.nextElementSibling,\n            factoryArgs: [controller.__min, controller.__max, controller.__step]\n          }\n        );\n\n        newController.name(oldName);\n        if (wasListening) newController.listen();\n\n        return newController;\n      }\n\n      return returned;\n    };\n\n    controller.min = common.compose(r, controller.min);\n    controller.max = common.compose(r, controller.max);\n  } else if (controller instanceof BooleanController) {\n    dom.bind(li, 'click', function() {\n      dom.fakeEvent(controller.__checkbox, 'click');\n    });\n\n    dom.bind(controller.__checkbox, 'click', function(e) {\n      e.stopPropagation(); // Prevents double-toggle\n    });\n  } else if (controller instanceof FunctionController) {\n    dom.bind(li, 'click', function() {\n      dom.fakeEvent(controller.__button, 'click');\n    });\n\n    dom.bind(li, 'mouseover', function() {\n      dom.addClass(controller.__button, 'hover');\n    });\n\n    dom.bind(li, 'mouseout', function() {\n      dom.removeClass(controller.__button, 'hover');\n    });\n  } else if (controller instanceof ColorController) {\n    dom.addClass(li, 'color');\n    controller.updateDisplay = common.compose(function(val) {\n      li.style.borderLeftColor = controller.__color.toString();\n      return val;\n    }, controller.updateDisplay);\n\n    controller.updateDisplay();\n  }\n\n  controller.setValue = common.compose(function(val) {\n    if (gui.getRoot().__preset_select && controller.isModified()) {\n      markPresetModified(gui.getRoot(), true);\n    }\n\n    return val;\n  }, controller.setValue);\n}\n\nfunction recallSavedValue(gui, controller) {\n  // Find the topmost GUI, that's where remembered objects live.\n  const root = gui.getRoot();\n\n  // Does the object we're controlling match anything we've been told to\n  // remember?\n  const matchedIndex = root.__rememberedObjects.indexOf(controller.object);\n\n  // Why yes, it does!\n  if (matchedIndex !== -1) {\n    // Let me fetch a map of controllers for thcommon.isObject.\n    let controllerMap = root.__rememberedObjectIndecesToControllers[matchedIndex];\n\n    // Ohp, I believe this is the first controller we've created for this\n    // object. Lets make the map fresh.\n    if (controllerMap === undefined) {\n      controllerMap = {};\n      root.__rememberedObjectIndecesToControllers[matchedIndex] =\n        controllerMap;\n    }\n\n    // Keep track of this controller\n    controllerMap[controller.property] = controller;\n\n    // Okay, now have we saved any values for this controller?\n    if (root.load && root.load.remembered) {\n      const presetMap = root.load.remembered;\n\n      // Which preset are we trying to load?\n      let preset;\n\n      if (presetMap[gui.preset]) {\n        preset = presetMap[gui.preset];\n      } else if (presetMap[DEFAULT_DEFAULT_PRESET_NAME]) {\n        // Uhh, you can have the default instead?\n        preset = presetMap[DEFAULT_DEFAULT_PRESET_NAME];\n      } else {\n        // Nada.\n        return;\n      }\n\n      // Did the loaded object remember thcommon.isObject? &&  Did we remember this particular property?\n      if (preset[matchedIndex] && preset[matchedIndex][controller.property] !== undefined) {\n        // We did remember something for this guy ...\n        const value = preset[matchedIndex][controller.property];\n\n        // And that's what it is.\n        controller.initialValue = value;\n        controller.setValue(value);\n      }\n    }\n  }\n}\n\nfunction add(gui, object, property, params) {\n  if (object[property] === undefined) {\n    throw new Error(`Object \"${object}\" has no property \"${property}\"`);\n  }\n\n  let controller;\n\n  if (params.color) {\n    controller = new ColorController(object, property);\n  } else {\n    const factoryArgs = [object, property].concat(params.factoryArgs);\n    controller = ControllerFactory.apply(gui, factoryArgs);\n  }\n\n  if (params.before instanceof Controller) {\n    params.before = params.before.__li;\n  }\n\n  recallSavedValue(gui, controller);\n\n  dom.addClass(controller.domElement, 'c');\n\n  const name = document.createElement('span');\n  dom.addClass(name, 'property-name');\n  name.innerHTML = controller.property;\n\n  const container = document.createElement('div');\n  container.appendChild(name);\n  container.appendChild(controller.domElement);\n\n  const li = addRow(gui, container, params.before);\n\n  dom.addClass(li, GUI.CLASS_CONTROLLER_ROW);\n  if (controller instanceof ColorController) {\n    dom.addClass(li, 'color');\n  } else {\n    dom.addClass(li, typeof controller.getValue());\n  }\n\n  augmentController(gui, li, controller);\n\n  gui.__controllers.push(controller);\n\n  return controller;\n}\n\nfunction getLocalStorageHash(gui, key) {\n  // TODO how does this deal with multiple GUI's?\n  return document.location.href + '.' + key;\n}\n\nfunction addPresetOption(gui, name, setSelected) {\n  const opt = document.createElement('option');\n  opt.innerHTML = name;\n  opt.value = name;\n  gui.__preset_select.appendChild(opt);\n  if (setSelected) {\n    gui.__preset_select.selectedIndex = gui.__preset_select.length - 1;\n  }\n}\n\nfunction showHideExplain(gui, explain) {\n  explain.style.display = gui.useLocalStorage ? 'block' : 'none';\n}\n\nfunction addSaveMenu(gui) {\n  const div = gui.__save_row = document.createElement('li');\n\n  dom.addClass(gui.domElement, 'has-save');\n\n  gui.__ul.insertBefore(div, gui.__ul.firstChild);\n\n  dom.addClass(div, 'save-row');\n\n  const gears = document.createElement('span');\n  gears.innerHTML = '&nbsp;';\n  dom.addClass(gears, 'button gears');\n\n  // TODO replace with FunctionController\n  const button = document.createElement('span');\n  button.innerHTML = 'Save';\n  dom.addClass(button, 'button');\n  dom.addClass(button, 'save');\n\n  const button2 = document.createElement('span');\n  button2.innerHTML = 'New';\n  dom.addClass(button2, 'button');\n  dom.addClass(button2, 'save-as');\n\n  const button3 = document.createElement('span');\n  button3.innerHTML = 'Revert';\n  dom.addClass(button3, 'button');\n  dom.addClass(button3, 'revert');\n\n  const select = gui.__preset_select = document.createElement('select');\n\n  if (gui.load && gui.load.remembered) {\n    common.each(gui.load.remembered, function(value, key) {\n      addPresetOption(gui, key, key === gui.preset);\n    });\n  } else {\n    addPresetOption(gui, DEFAULT_DEFAULT_PRESET_NAME, false);\n  }\n\n  dom.bind(select, 'change', function() {\n    for (let index = 0; index < gui.__preset_select.length; index++) {\n      gui.__preset_select[index].innerHTML = gui.__preset_select[index].value;\n    }\n\n    gui.preset = this.value;\n  });\n\n  div.appendChild(select);\n  div.appendChild(gears);\n  div.appendChild(button);\n  div.appendChild(button2);\n  div.appendChild(button3);\n\n  if (SUPPORTS_LOCAL_STORAGE) {\n    const explain = document.getElementById('dg-local-explain');\n    const localStorageCheckBox = document.getElementById('dg-local-storage');\n    const saveLocally = document.getElementById('dg-save-locally');\n\n    saveLocally.style.display = 'block';\n\n    if (localStorage.getItem(getLocalStorageHash(gui, 'isLocal')) === 'true') {\n      localStorageCheckBox.setAttribute('checked', 'checked');\n    }\n\n    showHideExplain(gui, explain);\n\n    // TODO: Use a boolean controller, fool!\n    dom.bind(localStorageCheckBox, 'change', function() {\n      gui.useLocalStorage = !gui.useLocalStorage;\n      showHideExplain(gui, explain);\n    });\n  }\n\n  const newConstructorTextArea = document.getElementById('dg-new-constructor');\n\n  dom.bind(newConstructorTextArea, 'keydown', function(e) {\n    if (e.metaKey && (e.which === 67 || e.keyCode === 67)) {\n      SAVE_DIALOGUE.hide();\n    }\n  });\n\n  dom.bind(gears, 'click', function() {\n    newConstructorTextArea.innerHTML = JSON.stringify(gui.getSaveObject(), undefined, 2);\n    SAVE_DIALOGUE.show();\n    newConstructorTextArea.focus();\n    newConstructorTextArea.select();\n  });\n\n  dom.bind(button, 'click', function() {\n    gui.save();\n  });\n\n  dom.bind(button2, 'click', function() {\n    const presetName = prompt('Enter a new preset name.');\n    if (presetName) {\n      gui.saveAs(presetName);\n    }\n  });\n\n  dom.bind(button3, 'click', function() {\n    gui.revert();\n  });\n\n  // div.appendChild(button2);\n}\n\nfunction addResizeHandle(gui) {\n  let pmouseX;\n\n  gui.__resize_handle = document.createElement('div');\n\n  common.extend(gui.__resize_handle.style, {\n\n    width: '6px',\n    marginLeft: '-3px',\n    height: '200px',\n    cursor: 'ew-resize',\n    position: 'absolute'\n    // border: '1px solid blue'\n\n  });\n\n  function drag(e) {\n    e.preventDefault();\n\n    gui.width += pmouseX - e.clientX;\n    gui.onResize();\n    pmouseX = e.clientX;\n\n    return false;\n  }\n\n  function dragStop() {\n    dom.removeClass(gui.__closeButton, GUI.CLASS_DRAG);\n    dom.unbind(window, 'mousemove', drag);\n    dom.unbind(window, 'mouseup', dragStop);\n  }\n\n  function dragStart(e) {\n    e.preventDefault();\n\n    pmouseX = e.clientX;\n\n    dom.addClass(gui.__closeButton, GUI.CLASS_DRAG);\n    dom.bind(window, 'mousemove', drag);\n    dom.bind(window, 'mouseup', dragStop);\n\n    return false;\n  }\n\n  dom.bind(gui.__resize_handle, 'mousedown', dragStart);\n  dom.bind(gui.__closeButton, 'mousedown', dragStart);\n\n  gui.domElement.insertBefore(gui.__resize_handle, gui.domElement.firstElementChild);\n}\n\nfunction setWidth(gui, w) {\n  gui.domElement.style.width = w + 'px';\n  // Auto placed save-rows are position fixed, so we have to\n  // set the width manually if we want it to bleed to the edge\n  if (gui.__save_row && gui.autoPlace) {\n    gui.__save_row.style.width = w + 'px';\n  }\n  if (gui.__closeButton) {\n    gui.__closeButton.style.width = w + 'px';\n  }\n}\n\nfunction getCurrentPreset(gui, useInitialValues) {\n  const toReturn = {};\n\n  // For each object I'm remembering\n  common.each(gui.__rememberedObjects, function(val, index) {\n    const savedValues = {};\n\n    // The controllers I've made for thcommon.isObject by property\n    const controllerMap =\n      gui.__rememberedObjectIndecesToControllers[index];\n\n    // Remember each value for each property\n    common.each(controllerMap, function(controller, property) {\n      savedValues[property] = useInitialValues ? controller.initialValue : controller.getValue();\n    });\n\n    // Save the values for thcommon.isObject\n    toReturn[index] = savedValues;\n  });\n\n  return toReturn;\n}\n\nfunction setPresetSelectIndex(gui) {\n  for (let index = 0; index < gui.__preset_select.length; index++) {\n    if (gui.__preset_select[index].value === gui.preset) {\n      gui.__preset_select.selectedIndex = index;\n    }\n  }\n}\n\nfunction updateDisplays(controllerArray) {\n  if (controllerArray.length !== 0) {\n    requestAnimationFrame.call(window, function() {\n      updateDisplays(controllerArray);\n    });\n  }\n\n  common.each(controllerArray, function(c) {\n    c.updateDisplay();\n  });\n}\n\nexport default GUI;\n", "/**\n * dat-gui JavaScript Controller Library\n * https://github.com/dataarts/dat.gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nimport Color from './color/Color';\nimport math from './color/math';\nimport interpret from './color/interpret';\n\nimport Controller from './controllers/Controller';\nimport BooleanController from './controllers/BooleanController';\nimport OptionController from './controllers/OptionController';\nimport StringController from './controllers/StringController';\nimport NumberController from './controllers/NumberController';\nimport NumberControllerBox from './controllers/NumberControllerBox';\nimport NumberControllerSlider from './controllers/NumberControllerSlider';\nimport FunctionController from './controllers/FunctionController';\nimport ColorController from './controllers/ColorController';\n\nimport domImport from './dom/dom';\nimport GUIImport from './gui/GUI';\n\nexport const color = {\n  Color: Color,\n  math: math,\n  interpret: interpret\n};\n\nexport const controllers = {\n  Controller: Controller,\n  BooleanController: BooleanController,\n  OptionController: OptionController,\n  StringController: StringController,\n  NumberController: NumberController,\n  NumberControllerBox: NumberControllerBox,\n  NumberControllerSlider: NumberControllerSlider,\n  FunctionController: FunctionController,\n  ColorController: ColorController\n};\n\nexport const dom = { dom: domImport };\n\nexport const gui = { GUI: GUIImport };\n\nexport const GUI = GUIImport;\n\nexport default {\n  color,\n  controllers,\n  dom,\n  gui,\n  GUI\n};\n"],
  "mappings": "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A,MAAI;AAAA,MAAI;AAAA,MAAG;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAG;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAG;AAAA,MAAG;AAAA,MAAG;AAAA,MAAG;AAAA,MAAI;AAAA,MAAG;AAAA,MACxE;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAG;AAAA,MAAG;AAAA,MAAG;AAAA,MAAK;AAAA,MAAE;AAAA,MAAI;AAAA,MAAG;AAAA,MAAG;AAAA,MAAI;AAAA,MAAG;AAAA,MAAI;AAAA,MAAI;AAAA,MAAK;AAAA,MAAG;AAAA,MAAG;AAAA,MAAI;AAAA,MAAI;AAAA,MACxE;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAG;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAK;AAAA,MAAE;AAAA,MAAG;AAAA,MAAG;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MACxE;AAAA,MAAE;AAAA,MAAI;AAAA,MAAG;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAG;AAAA,MAAG;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAG;AAAA,MAAI;AAAA,MAAG;AAAA,MAAG;AAAA,MAAG;AAAA,MAAG;AAAA,MAAI;AAAA,MAAI;AAAA,MAAG;AAAA,MACzE;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAK;AAAA,MAAE;AAAA,MAAG;AAAA,MAAI;AAAA,MAAK;AAAA,MAAG;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAK;AAAA,MAAG;AAAA,MAAI;AAAA,MAC1E;AAAA,MAAI;AAAA,MAAG;AAAA,MAAG;AAAA,MAAK;AAAA,MAAG;AAAA,MAAG;AAAA,MAAI;AAAA,MAAI;AAAA,MAAG;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAAK;AAAA,MAAI;AAAA,MAAI;AAAA,MAAI;AAAA,MAA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",
  "names": ["Color", "result", "BlendModes", "Line", "Line", "reject", "Color", "reject", "texture", "Vector3", "z", "z", "Color", "z", "Color", "texture", "Color", "Color", "Vector3", "BlendModes", "texture", "Color", "sprite", "reject", "texture", "result", "reject", "reject", "Color", "BlendModes", "texture", "sprite", "topLeft", "topRight", "bottomLeft", "bottomRight", "pi", "uvi", "z", "Color", "BlendModes", "Vector3", "texture", "reject", "resolve", "sprite", "i", "require_gfx", "reject", "reject", "require_sfx", "reject", "event", "require_input", "reject", "reject", "require_assets", "Color", "result", "require_circle", "Color", "result", "require_rectangle", "Line", "reject", "require_collision", "Shaku", "reject", "color", "forceCSSHex", "colorFormat", "__state", "conversionName", "toString", "r", "Math", "round", "g", "b", "a", "h", "s", "toFixed", "v", "str", "hex", "length", "ARR_EACH", "Array", "prototype", "forEach", "ARR_SLICE", "slice", "Common", "target", "each", "call", "arguments", "obj", "keys", "isObject", "Object", "key", "isUndefined", "bind", "toCall", "args", "i", "apply", "itr", "scope", "l", "BREAK", "fnc", "func", "threshold", "callImmediately", "timeout", "delayed", "callNow", "setTimeout", "toArray", "undefined", "isNaN", "isArray", "constructor", "Function", "INTERPRETATIONS", "common", "isString", "original", "test", "match", "parseInt", "read", "parseFloat", "isNumber", "write", "result", "toReturn", "interpret", "family", "litmus", "conversions", "conversion", "tmpComponent", "ColorMath", "hi", "floor", "f", "p", "q", "t", "c", "min", "max", "delta", "NaN", "hex_with_component", "componentIndex", "value", "Color", "Error", "colorToString", "defineRGBComponent", "component", "componentHexIndex", "defineProperty", "get$$1", "space", "recalculateRGB", "set$$1", "defineHSVComponent", "recalculateHSV", "math", "component_from_hex", "extend", "hsv_to_rgb", "rgb_to_hsv", "COMPONENTS", "rgb_to_hex", "Controller", "object", "property", "initialValue", "domElement", "document", "createElement", "__onChange", "__onFinishChange", "newValue", "updateDisplay", "getValue", "EVENT_MAP", "EVENT_MAP_INV", "k", "e", "CSS_VALUE_PIXELS", "cssValueToPixels", "val", "isNull", "dom", "elem", "selectable", "style", "onselectstart", "MozUserSelect", "KhtmlUserSelect", "unselectable", "hor", "vert", "vertical", "horizontal", "position", "left", "right", "top", "bottom", "eventType", "pars", "aux", "params", "className", "evt", "createEvent", "clientX", "x", "clientY", "y", "initMouseEvent", "bubbles", "cancelable", "window", "clickCount", "init", "initKeyboardEvent", "initKeyEvent", "defaults", "ctrlKey", "altKey", "shiftKey", "metaKey", "keyCode", "charCode", "initEvent", "dispatchEvent", "event", "newBool", "bool", "addEventListener", "attachEvent", "removeEventListener", "detachEvent", "classes", "split", "indexOf", "push", "join", "replace", "removeAttribute", "index", "splice", "RegExp", "getComputedStyle", "width", "height", "el", "offset", "offsetParent", "offsetLeft", "offsetTop", "activeElement", "type", "href", "BooleanController", "_this", "__prev", "__checkbox", "setAttribute", "onChange", "setValue", "appendChild", "checked", "OptionController", "opts", "options", "__select", "map", "element", "opt", "innerHTML", "desiredValue", "selectedIndex", "isActive", "StringController", "__input", "onBlur", "blur", "numDecimals", "_x", "NumberController", "_params", "__min", "__max", "__step", "step", "__impliedStep", "pow", "log", "abs", "LN10", "__precision", "_v", "minValue", "maxValue", "stepValue", "roundToDecimal", "decimals", "tenTo", "NumberControllerBox", "__truncationSuspended", "prevY", "attempted", "onFinish", "onMouseDrag", "diff", "onMouseUp", "unbind", "onMouseDown", "i1", "i2", "o1", "o2", "NumberControllerSlider", "__background", "__foreground", "onTouchStart", "addClass", "preventDefault", "bgRect", "getBoundingClientRect", "touches", "onTouchMove", "onTouchEnd", "pct", "FunctionController", "text", "__button", "fire", "ColorController", "__color", "__temp", "makeSelectable", "__selector", "__saturation_field", "__field_knob", "__field_knob_border", "__hue_knob", "__hue_field", "__input_textShadow", "removeClass", "valueField", "fieldDown", "fieldDownH", "setSV", "fieldUpSV", "setH", "fieldUpH", "toOriginal", "fieldRect", "mismatch", "flip", "_flip", "toHexString", "marginTop", "vendors", "linearGradient", "background", "vendor", "cssText", "hueGradient", "css", "url", "indoc", "doc", "link", "rel", "getElementsByTagName", "cssContent", "injected", "head", "saveDialogContents", "ControllerFactory", "isFunction", "isBoolean", "requestAnimationFrame", "callback", "webkitRequestAnimationFrame", "mozRequestAnimationFrame", "oRequestAnimationFrame", "msRequestAnimationFrame", "CenteredDiv", "backgroundElement", "makeFullscreen", "body", "hide", "display", "opacity", "webkitTransform", "layout", "defer", "innerWidth", "getWidth", "innerHeight", "getHeight", "inject", "styleSheet", "CSS_NAMESPACE", "HIDE_KEY_CODE", "CLOSE_BUTTON_HEIGHT", "DEFAULT_DEFAULT_PRESET_NAME", "SUPPORTS_LOCAL_STORAGE", "localStorage", "SAVE_DIALOGUE", "autoPlaceVirgin", "autoPlaceContainer", "hideableGuis", "GUI", "__ul", "__folders", "__controllers", "__rememberedObjects", "__rememberedObjectIndecesToControllers", "__listening", "DEFAULT_WIDTH", "autoPlace", "load", "preset", "parent", "hideable", "resizable", "scrollable", "useLocalStorage", "getItem", "getLocalStorageHash", "saveToLocalStorage", "titleRow", "defineProperties", "closeOnTop", "getRoot", "revert", "name", "closed", "CLASS_CLOSED", "onResize", "__closeButton", "TEXT_OPEN", "TEXT_CLOSED", "setItem", "CLASS_MAIN", "savedGui", "JSON", "parse", "CLASS_CLOSE_BUTTON", "CLASS_CLOSE_TOP", "insertBefore", "childNodes", "CLASS_CLOSE_BOTTOM", "titleRowName", "createTextNode", "addRow", "onClickTitle", "CLASS_AUTO_PLACE_CONTAINER", "CLASS_AUTO_PLACE", "__resizeHandler", "onResizeDebounced", "stringify", "getSaveObject", "saveToLocalStorageIfPossible", "resetWidth", "root", "toggleHide", "gui", "CLASS_CONTROLLER_ROW", "CLASS_TOO_TALL", "CLASS_DRAG", "_keydownHandler", "which", "add", "controller", "removeChild", "__li", "subfolder", "removeFolder", "newGuiParams", "folders", "li", "folder", "parentElement", "getOffset", "node", "__save_row", "__resize_handle", "offsetHeight", "debounce", "saveDialogueContents", "remembered", "getCurrentPreset", "presetName", "newDom", "liBefore", "removeListeners", "markPresetModified", "modified", "__preset_select", "augmentController", "__gui", "nextSibling", "nextElementSibling", "remove", "firstElementChild", "listen", "box", "method", "pc", "pb", "returned", "oldName", "wasListening", "newController", "compose", "fakeEvent", "stopPropagation", "borderLeftColor", "isModified", "recallSavedValue", "matchedIndex", "controllerMap", "presetMap", "factoryArgs", "concat", "before", "container", "location", "addPresetOption", "setSelected", "showHideExplain", "explain", "addSaveMenu", "div", "firstChild", "gears", "button", "button2", "button3", "select", "getElementById", "localStorageCheckBox", "saveLocally", "newConstructorTextArea", "show", "focus", "save", "prompt", "saveAs", "addResizeHandle", "pmouseX", "drag", "dragStop", "dragStart", "setWidth", "w", "useInitialValues", "savedValues", "setPresetSelectIndex", "updateDisplays", "controllerArray", "GUI", "GUIImport", "Shaku"]
}
